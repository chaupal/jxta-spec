<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html>
<head>
  <meta name="generator" content="HTML Tidy for Linux (vers 1 September 2005), see www.w3.org">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii">

  <title>JXTA v2.0 Protocols Specification</title>
  <link rel="stylesheet" href="docbook.css" type="text/css">
  <meta name="generator" content="DocBook XSL Stylesheets V1.72.0">
  <meta name="description" content=
  "The JXTA protocols defines a suite of six XML-based protocols that standardize the manner in which peers self-organize into peergroups, publish and discover peer resources, communicate, and monitor each other. The Endpoint Routing Protocol (ERP) is the protocol by which a peer can discover a route (sequence of hops) to send a message to another peer potentially traversing firewalls and NATs. The Rendezvous Protocol (RVP) is used for propagating a message within a peergroup. The Peer Resolver Protocol (PRP) is the protocol used to send a generic query to one or more peers, and receive a response (or multiple responses) to the query. The Peer Discovery Protocol (PDP) is used to publish and discover resource advertisements. The Peer Information Protocol (PIP) is the protocol by a which a peer may obtain status information about another peers. The Pipe Binding Protocol (PBP) is the protocol by which a peer can establish a virtual communication channel or pipe between one or more peers. The JXTA protocols permit the establishment a virtual network overlay on top of physical networks allowing peers to directly interact and organize independently of their network location and connectivity. The JXTA protocols have been designed to be easily implemented on unidirectional links and asymmetric transports.">
  <meta name="keywords" content=
  "JXTA, www.jxta.org, http://www.jxta.org, P2P, Communications Protocol, peer-to-peer, peer-2-peer">
  </head>

<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
  <div class="book" lang="en">
    <div class="titlepage">
      <div>
        <div>
          <h1 class="title"><a name="id265974" id="id265974"></a>JXTA v2.0 Protocols
          Specification</h1>
        </div>

        <div>
          <h3 class="corpauthor">Project JXTA <a href="http://www.jxta.org" target=
          "_top">http://www.jxta.org</a></h3>
        </div>

        <div>
          <p class="copyright">Copyright &copy; 2001, 2002, 2005, 2006, 2007 Sun Microsystems
          Inc.</p>
        </div>

        <div>
          <p class="copyright">Copyright &copy; 2002, 2003, 2004 The Internet Society. All Rights
          Reserved.</p>
        </div>

        <div>
          <div class="legalnotice">
            <a name="id266659" id="id266659"></a>

            <p>This document and translations of it may be copied and furnished to others, and
            derivative works that comment on or otherwise explain it or assist in its
            implementation may be prepared, copied, published and distributed, in whole or in part,
            without restriction of any kind, provided that the above copyright notice and this
            paragraph are included on all such copies and derivative works. However, this document
            itself may not be modified in any way, such as by removing the copyright notice or
            references to the Internet Society or other Internet organizations, except as needed
            for the purpose of developing Internet standards in which case the procedures for
            copyrights defined in the Internet Standards process must be followed, or as required
            to translate it into languages other than English.</p>

            <p>The limited permissions granted above are perpetual and will not be revoked by the
            Internet Society or its successors or assigns.</p>

            <p>This document and the information contained herein is provided on an "<span class=
            "emphasis"><em>AS IS</em></span>" basis and <span class="emphasis"><em>THE INTERNET
            SOCIETY AND THE INTERNET ENGINEERING TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR
            IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
            HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF MERCHANTABILITY OR
            FITNESS FOR A PARTICULAR PURPOSE.</em></span></p>
          </div>
        </div>

        <div>
          <p class="pubdate">2006</p>
        </div>

        <div>
          <div class="revhistory">
            <table border="1" width="100%" summary="Revision history">
              <tr>
                <th align="left" valign="top" colspan="3"><b>Revision History</b></th>
              </tr>

              <tr>
                <td align="left">Revision 1.2</td>

                <td align="left">June 22, 2001</td>

                <td align="left">goober@jxta.org,</td>
              </tr>

              <tr>
                <td align="left" colspan="3">preliminary DocBook format</td>
              </tr>

              <tr>
                <td align="left">Revision 1.2.2</td>

                <td align="left">September 22, 2001</td>

                <td align="left">goober@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">first release based on DocBook format (no intended
                changes from 1.2 revision)</td>
              </tr>

              <tr>
                <td align="left">Revision 1.2.3</td>

                <td align="left">November 20, 2001</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Updates to the IDs chapter to document new IDs design.
                Information on components provided as part of reference implementations is also
                being moved to the reference implementation section (this may eventually be a
                separate document).</td>
              </tr>

              <tr>
                <td align="left">Revision 1.2.4</td>

                <td align="left">November 20, 2001</td>

                <td>&nbsp;</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Updates to Protocol chapter, discovery behavior and
                minor changes to the Resolver section.</td>
              </tr>

              <tr>
                <td align="left">Revision 1.2.5</td>

                <td align="left">November 21, 2001</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Updates to Advertisements chapter, added sections for
                ModuleClassAdvertisement, ModuleSpecAdvertisement, ModuleImplAdvertisement. Updated
                sections for PeerAdvertisement and PeerGroupAdvertisement.</td>
              </tr>

              <tr>
                <td align="left">Revision 1.2.6</td>

                <td align="left">November 28, 2001</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Updates to Advertisements chapter, added sections for
                PeerInfoAdvertisement. also includes typo corrections in various sections</td>
              </tr>

              <tr>
                <td align="left">Revision 1.2.7</td>

                <td align="left">November 29, 2001</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Updates to the Protocol Section, and more description
                on PeerInfoAdvertisement traffic field</td>
              </tr>

              <tr>
                <td align="left">Revision 1.2.8</td>

                <td align="left">December, 2001</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Integrated docbookized version of Eric's sections
                about enpoint service and router. Made some cosmetic fixes per last review.</td>
              </tr>

              <tr>
                <td align="left">Revision 1.2.9</td>

                <td align="left">December 4, 2001</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Updates to protocols chapter to use schemas to
                describe message structure more formally. Remove Peer Membership Protocol. Remove
                Content Advertisement (may be readded in documentation of CMS, but not part of or
                used by core protocols) Minor cosmetic improvements to copyright and ids
                chapter.</td>
              </tr>

              <tr>
                <td align="left">Revision 1.2.10</td>

                <td align="left">December 7, 2001</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Updates to protocols chapter to use mores schemas to
                describe message structure more formally. Examples for each as well.</td>
              </tr>

              <tr>
                <td align="left">Revision 1.2.11</td>

                <td align="left">December 7, 2001</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">More updates to the protocols chapter. Converting raw
                program listings to figures and examples, addition of live cross references.
                Preparing for glossary and bibliography.</td>
              </tr>

              <tr>
                <td align="left">Revision 1.2.12</td>

                <td align="left">December 9, 2001</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">More updates to the protocols chapter.
                PeerInfoProtocol and Pipe Binding Protocol now have schemas. Converting raw program
                listings to figures and examples, addition of live cross references. Preparing for
                glossary and bibliography. Cosmetic changes to Messages chapter</td>
              </tr>

              <tr>
                <td align="left">Revision 1.2.13</td>

                <td align="left">December 17, 2001</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Peer Info Protocol was redone because the previous
                schema though XML-like, was not representable with XML. (Endpoint Addresses as tag
                names were the culprit). PIP now looks more like the Peer Discovery Protocol with
                separate schemas for query and response. Document has been restructured into three
                major sections; Core Specification, Standard Services, and Reference
                Implementations. This restructuring makes understanding the JXTA Protocols more
                straight-forward because requirements and behaviours are now divided between
                functionality required by all JXTA peers, functionality needed to interoperate with
                the optional JXTA Protocols, and functionality required to interoperate with
                specific JXTA implementations.</td>
              </tr>

              <tr>
                <td align="left">Revision 1.3</td>

                <td align="left">January 3, 2002</td>

                <td>&nbsp;</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Wrote introductions for each of the new document
                sections. Introduced a glossary and bibliography. More restructuring of the source
                docbook files. Changes to prepare for a printable form document.</td>
              </tr>

              <tr>
                <td align="left">Revision 1.3.1</td>

                <td align="left">January 9, 2002</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Spelling and grammar corrections. More reorganization
                of material into core, standard services and reference implementation parts.
                Updating stylesheets and docbook usage based on techniques seen in other docbook
                projects.</td>
              </tr>

              <tr>
                <td align="left">Revision 1.3.2</td>

                <td align="left">January 9, 2002</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">More moving content around into core and standard
                services. More chapters reorganized. New text in advertisments chapter. More
                bibliographic information.</td>
              </tr>

              <tr>
                <td align="left">Revision 1.3.3</td>

                <td align="left">January 14, 2002</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Redid the schemas for the advertisement chapter. Moved
                all of the protocol advertisements and schemas to the appropriate protocols
                chapters. Use of &lt;literal&gt; has now been replaced with &lt;phrase&gt; and a
                role attribute of <span class="emphasis"><em>rfc2119</em></span>. Improved field
                descriptions for some of the core advertisements.</td>
              </tr>

              <tr>
                <td align="left">Revision 1.3.4</td>

                <td align="left">February 13, 2002</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Lots of minor revisions based on review cycle. Thanks
                to all of the reviewers who took time to review and respond!</td>
              </tr>

              <tr>
                <td align="left">Revision 1.3.5</td>

                <td align="left">April 19, 2002</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Redid some of the schema descriptions in a new and
                clearer style, more will be converted of over time. Redid schemas and examples for
                Pipe Binding Protocol section. A few changes to FO generation which generates
                <span class="emphasis"><em>much</em></span>better PDF output. Corrected a few
                specific issues pointed out by Brendon Wilson.</td>
              </tr>

              <tr>
                <td align="left">Revision 1.3.6</td>

                <td align="left">June 10, 2002</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">More complete documentation of the Pipe Binding
                Protocol based upon review of the J2SE and C implementations. Partial re-write of
                the Messages chapter to flesh out some of the details. Remove text not specific to
                the protocol (mostly dealing with namespace ":" name).</td>
              </tr>

              <tr>
                <td align="left">Revision 1.3.7</td>

                <td align="left">June 11, 2002</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Minor corrections following review. Now has an
                "Abstract" section.</td>
              </tr>

              <tr>
                <td align="left">Revision 1.3.8</td>

                <td align="left">June 18, 2002</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Lots of corrections following a detailed review by
                Jeff Altman, with many more corrections to come! A bit of reorganisation of the
                messages chapter into two pieces. Some cleanups for TOC generation in the HTML
                version. Still working on SVG figures. Next release will be 1.4 upon completion of
                all the feedback cleanups.</td>
              </tr>

              <tr>
                <td align="left">Revision 1.4</td>

                <td align="left">June 19, 2002</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">The Docbook source now validates against the Docbook
                4.2 DTD. This seemingly minor issue fixed a number of problems with the HTML, PDF
                and rfc 2629 renderings and cross-referencing. Implemented all of the feedback from
                the most recent review cycle. Fixed a number of the figures.</td>
              </tr>

              <tr>
                <td align="left">Revision 1.4.1</td>

                <td align="left">June 21, 2002</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">More revisions following careful review. This version
                is being released to coincide with the submission of the JXTA Specification as an
                Internet-Draft to IETF.</td>
              </tr>

              <tr>
                <td align="left">Revision 1.4.2</td>

                <td align="left">October 10, 2002</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Updates to Standard Transports sections. Updates to
                the Endpoint Routing Protocol and Endpoint Router Transport. Adds new optional SRDI
                message for Endpoint Resolver Protocol. Minor textual improvements and
                clarifications elsewhere. New examples and figures.</td>
              </tr>

              <tr>
                <td align="left">Revision 2.0</td>

                <td align="left">February 27, 2003</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Updates to Standard Transports sections.
                Clarifications in the IDs section. Updates to the Pipe Resolver protocol. Minor
                textual improvements and clarifications elsewhere. Added a section on "Users and
                Peers". Added a number of glossary terms. More contributions to the glossary are
                welcome. Updated version to "2.0". Rewrote or revised much of the Overview
                chapter.</td>
              </tr>

              <tr>
                <td align="left">Revision 2.1.1</td>

                <td align="left">October 15, 2003</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Additional updates to the Introduction and Overview
                chapters. Many additions to the glossary section. Minor schema corrections.</td>
              </tr>

              <tr>
                <td align="left">Revision 2.2.1</td>

                <td align="left">April 10th, 2004</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Additional updates to glossary and bibliography. Added
                updates to pipes regarding propagate pipes.</td>
              </tr>

              <tr>
                <td align="left">Revision 2.3</td>

                <td align="left">June 30th, 2004</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Additional information about the Rendezvous, Resolver
                and Pipe Services.</td>
              </tr>

              <tr>
                <td align="left">Revision 2.3.5</td>

                <td align="left">September 20th, 2005</td>

                <td align="left">mathieu@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Homogeneous spec for Resolver queries and
                responses.</td>
              </tr>

              <tr>
                <td align="left">Revision 2.5</td>

                <td align="left">June 23rd, 2006</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Clarifications to the HTTP Message Transport.</td>
              </tr>

              <tr>
                <td align="left">Revision 2.5.1</td>

                <td align="left">August 23rd, 2006</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Corrections and clarifications to Route Advertisement
                and Pipe Resolver Message.</td>
              </tr>

              <tr>
                <td align="left">Revision 2.5.2</td>

                <td align="left">January 9th, 2007</td>

                <td align="left">bondolo@jxta.org</td>
              </tr>

              <tr>
                <td align="left" colspan="3">Corrections and clarifications from several sharp eyed
                readers. Now includes complete specification of Binary Message Format version 2 and
                specification of the endpoint SrcAddess and DstAddress message elements.</td>
              </tr>
            </table>
          </div>
        </div>

        <div>
          <div class="abstract">
            <p class="title"><b>Abstract</b></p>

            <p>The JXTA protocols defines a suite of six XML-based protocols that standardize the
            manner in which peers self-organize into peergroups, publish and discover peer
            resources, communicate, and monitor each other. The Endpoint Routing Protocol (ERP) is
            the protocol by which a peer can discover a route (sequence of hops) to send a message
            to another peer potentially traversing firewalls and NATs. The Rendezvous Protocol
            (RVP) is used for propagating a message within a peergroup. The Peer Resolver Protocol
            (PRP) is the protocol used to send a generic query to one or more peers, and receive a
            response (or multiple responses) to the query. The Peer Discovery Protocol (PDP) is
            used to publish and discover resource advertisements. The Peer Information Protocol
            (PIP) is the protocol by a which a peer may obtain status information about another
            peers. The Pipe Binding Protocol (PBP) is the protocol by which a peer can establish a
            virtual communication channel or pipe between one or more peers. The JXTA protocols
            permit the establishment a virtual network overlay on top of physical networks allowing
            peers to directly interact and organize independently of their network location and
            connectivity. The JXTA protocols have been designed to be easily implemented on
            unidirectional links and asymmetric transports.</p>
          </div>
        </div>
      </div>
      <hr>
    </div>

    <div class="toc">
      <dl>
        <dt><span class="preface"><a href="#id267901">1. Conventions</a></span></dt>

        <dd>
          <dl>
            <dt><span class="section"><a href="#id267877">1.1. Significant Keywords</a></span></dt>

            <dt><span class="section"><a href="#id268295">1.2. Text Representations</a></span></dt>
          </dl>
        </dd>

        <dt><span class="preface"><a href="#introduction">2. Introduction</a></span></dt>

        <dd>
          <dl>
            <dt><span class="section"><a href="#id268042">2.1. Why JXTA?</a></span></dt>

            <dt><span class="section"><a href="#id268620">2.2. The JXTA Protocols</a></span></dt>

            <dt><span class="section"><a href="#id268965">2.3. The JXTA Three Layer
            Cake</a></span></dt>

            <dt><span class="section"><a href="#id269015">2.4. JXTA Assumptions</a></span></dt>
          </dl>
        </dd>

        <dt><span class="preface"><a href="#id270075">3. Conceptual Overview</a></span></dt>

        <dd>
          <dl>
            <dt><span class="section"><a href="#id270052">3.1. Peers</a></span></dt>

            <dt><span class="section"><a href="#overview-peergroups">3.2. Peer
            Groups</a></span></dt>

            <dt><span class="section"><a href="#overview-services">3.3. Network
            Services</a></span></dt>

            <dt><span class="section"><a href="#overview-ids">3.4. IDs</a></span></dt>

            <dt><span class="section"><a href="#overview-advertisements">3.5.
            Advertisements</a></span></dt>

            <dt><span class="section"><a href="#id271015">3.6. Credentials</a></span></dt>

            <dt><span class="section"><a href="#overview-pipes">3.7. Pipes</a></span></dt>

            <dt><span class="section"><a href="#id271367">3.8. Messages</a></span></dt>

            <dt><span class="section"><a href="#overview-codats">3.9. Codats</a></span></dt>
          </dl>
        </dd>

        <dt><span class="part"><a href="#core">1. JXTA Core Specification</a></span></dt>

        <dd>
          <dl>
            <dt><span class="chapter"><a href="#ids">1. IDs</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#ids-i">1.1. Introduction</a></span></dt>

                <dt><span class="section"><a href="#ids-jip">1.2. JXTA ID
                Properties</a></span></dt>

                <dt><span class="section"><a href="#ids-ujip">1.3. Using JXTA IDs in
                Protocols</a></span></dt>

                <dt><span class="section"><a href="#ids-fjiu">1.4. Format of a JXTA ID
                URN</a></span></dt>

                <dt><span class="section"><a href="#ids-ejiu">1.5. Example JXTA ID
                URNs</a></span></dt>

                <dt><span class="section"><a href="#id273152">1.6. JXTA ID
                Representation</a></span></dt>

                <dt><span class="section"><a href="#ids-jif">1.7. JXTA ID Formats</a></span></dt>

                <dt><span class="section"><a href="#ids-jit">1.8. JXTA ID Types</a></span></dt>

                <dt><span class="section"><a href="#ids-jinf">1.9. JXTA ID Formats :
                &ldquo;<span class="quote">jxta</span>&rdquo; ID Format</a></span></dt>
              </dl>
            </dd>

            <dt><span class="chapter"><a href="#core-advert">2. Advertisements</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#advert-i">2.1. Introduction</a></span></dt>

                <dt><span class="section"><a href="#advert-x">2.2. XML and JXTA
                Advertisements</a></span></dt>

                <dt><span class="section"><a href="#advert-pa">2.3. Peer
                Advertisement</a></span></dt>

                <dt><span class="section"><a href="#advert-pga">2.4. Peer Group
                Advertisement</a></span></dt>

                <dt><span class="section"><a href="#advert-mca">2.5. Module Class
                Advertisement</a></span></dt>

                <dt><span class="section"><a href="#advert-msa">2.6. Module Specification
                Advertisement</a></span></dt>

                <dt><span class="section"><a href="#advert-mia">2.7. Module Implementation
                Advertisement</a></span></dt>
              </dl>
            </dd>

            <dt><span class="chapter"><a href="#core-proto">3. JXTA Core Protocols</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#proto-prp">3.1. Peer Resolver
                Protocol</a></span></dt>

                <dt><span class="section"><a href="#proto-erp">3.2. Endpoint Routing
                Protocol</a></span></dt>
              </dl>
            </dd>

            <dt><span class="chapter"><a href="#core-trans">4. Core JXTA Message Transport
            Bindings</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#trans-endpt">4.1. Endpoint
                Service</a></span></dt>

                <dt><span class="section"><a href="#trans-router">4.2. Endpoint Router Transport
                Protocol</a></span></dt>
              </dl>
            </dd>

            <dt><span class="chapter"><a href="#msgs">5. Messages</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#id280185">5.1. Introduction</a></span></dt>

                <dt><span class="section"><a href="#id280538">5.2. Message</a></span></dt>

                <dt><span class="section"><a href="#id280567">5.3. Element</a></span></dt>
              </dl>
            </dd>
          </dl>
        </dd>

        <dt><span class="part"><a href="#stdsvc">2. JXTA Standard Services</a></span></dt>

        <dd>
          <dl>
            <dt><span class="chapter"><a href="#stdsvc-proto">1. Standard Protocols</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#proto-pdp">1.1. Peer Discovery
                Protocol</a></span></dt>

                <dt><span class="section"><a href="#proto-rvp">1.2. Rendezvous
                Protocol</a></span></dt>

                <dt><span class="section"><a href="#proto-pip">1.3. Peer Information
                Protocol</a></span></dt>

                <dt><span class="section"><a href="#proto-pbp">1.4. Pipe Binding
                Protocol</a></span></dt>
              </dl>
            </dd>

            <dt><span class="chapter"><a href="#stdsvc-trans">2. Standard JXTA Message
            Transports</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#trans-tcpipt">2.1. TCP/IP Message
                Transport</a></span></dt>

                <dt><span class="section"><a href="#trans-httpt">2.2. HTTP Message
                Transport</a></span></dt>

                <dt><span class="section"><a href="#trans-tlst">2.3. TLS Transport
                Binding</a></span></dt>
              </dl>
            </dd>

            <dt><span class="chapter"><a href="#msgs-fmts">3. JXTA Message Wire
            Representations</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#id295118">3.1. General
                Requirements</a></span></dt>

                <dt><span class="section"><a href="#msgs-fmts-jbm">3.2. Binary Message
                Format</a></span></dt>

                <dt><span class="section"><a href="#id295545">3.3. XML Message
                Format</a></span></dt>
              </dl>
            </dd>
          </dl>
        </dd>

        <dt><span class="part"><a href="#refimpls">3. JXTA Reference Implementations
        Information</a></span></dt>

        <dd>
          <dl>
            <dt><span class="chapter"><a href="#refimpl-j2se">1. Java 2 SE Reference
            Implementation</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#refimpl-j2se-ids">1.1. JXTA ID
                Formats</a></span></dt>

                <dt><span class="section"><a href="#trans-router-refimpl">1.2. J2SE JXTA Endpoint
                Router Implementation</a></span></dt>
              </dl>
            </dd>
          </dl>
        </dd>

        <dt><span class="glossary"><a href="#id305291">Glossary</a></span></dt>

        <dt><span class="bibliography"><a href="#id306259">Bibliography</a></span></dt>
      </dl>
    </div>

    <div class="list-of-figures">
      <p><b>List of Figures</b></p>

      <dl>
        <dt>1. <a href="#intro-fjp">JXTA Protocols</a></dt>

        <dt>2. <a href="#id271316">JXTA Pipe Types</a></dt>

        <dt>1.1. <a href="#ids-fjia">JXTA ID ABNF</a></dt>

        <dt>1.2. <a href="#ids-fjifa">JXTA ID : "jxta" ID Format ABNF</a></dt>

        <dt>2.1. <a href="#fpcafs">Common Advertisement Fragments Schemas</a></dt>

        <dt>2.2. <a href="#fpas">Peer Advertisement Schema</a></dt>

        <dt>2.3. <a href="#fpgas">Peer Group Advertisement Schema</a></dt>

        <dt>2.4. <a href="#fmcas">Module Class Advertisement Schema</a></dt>

        <dt>2.5. <a href="#fmsas">Module Specification Advertisement Schema</a></dt>

        <dt>2.6. <a href="#fmias">Module Implementation Advertisement Schema</a></dt>

        <dt>3.1. <a href="#frqs">Resolver Query Schema</a></dt>

        <dt>3.2. <a href="#frrs">Resolver Response Schema</a></dt>

        <dt>3.3. <a href="#frsrdis">Resolver SRDI Schema</a></dt>

        <dt>3.4. <a href="#flnsa">Listener Naming Syntax ABNF</a></dt>

        <dt>3.5. <a href="#id277644">Endpoint Address URI ABNF</a></dt>

        <dt>3.6. <a href="#feprra">Route Advertisement</a></dt>

        <dt>3.7. <a href="#feprq">Endpoint Router Query</a></dt>

        <dt>3.8. <a href="#feprrm">Endpoint Router Response Message</a></dt>

        <dt>4.1. <a href="#feprme">Endpoint Router Message Element</a></dt>

        <dt>4.2. <a href="#fjera">JXTA Endpoint Router Address Format</a></dt>

        <dt>1.1. <a href="#fdqs">Discovery Query Schema</a></dt>

        <dt>1.2. <a href="#fdrs">Discovery Response Schema</a></dt>

        <dt>1.3. <a href="#fras">Rendezvous Advertisement Schema</a></dt>

        <dt>1.4. <a href="#fpvm">PeerView Message</a></dt>

        <dt>1.5. <a href="#fpvms">PeerView Message Scenarios</a></dt>

        <dt>1.6. <a href="#frpms">RendezVous Propagate Message Schema</a></dt>

        <dt>1.7. <a href="#fpipqs">PIP Query Message</a></dt>

        <dt>1.8. <a href="#fpiprs">PIP Response Message</a></dt>

        <dt>1.9. <a href="#fpipeas">Pipe Advertisement Schema</a></dt>

        <dt>1.10. <a href="#fprms">Pipe Resolver Message Schema</a></dt>

        <dt>1.11. <a href="#fwhms">Propagate Pipe Message Header Schema</a></dt>

        <dt>2.1. <a href="#id292218">Welcome Message ABNF</a></dt>

        <dt>2.2. <a href="#id292350">JXTA Message Package ABNF</a></dt>

        <dt>3.1. <a href="#fjbmabnf">JXTA Binary Message Version 1 ABNF</a></dt>

        <dt>3.2. <a href="#fjbmabnf2">JXTA Binary Message Version 2 ABNF</a></dt>

        <dt>1.1. <a href="#ids-fuifa">JXTA "uuid" ID Format ABNF</a></dt>

        <dt>1.2. <a href="#id302325">JXTA UUID Codat ID Fields</a></dt>

        <dt>1.3. <a href="#id302488">JXTA UUID PeerGroup ID Fields</a></dt>

        <dt>1.4. <a href="#id302623">JXTA UUID Peer ID Fields</a></dt>

        <dt>1.5. <a href="#id302758">JXTA UUID Pipe ID Fields</a></dt>

        <dt>1.6. <a href="#id302991">JXTA UUID Module Class ID Fields</a></dt>

        <dt>1.7. <a href="#id303119">JXTA UUID Module Spec ID Fields</a></dt>
      </dl>
    </div>

    <div class="list-of-examples">
      <p><b>List of Examples</b></p>

      <dl>
        <dt>1.1. <a href="#ids-e">Sample JXTA IDs</a></dt>

        <dt>3.1. <a href="#frqe">Resolver Query</a></dt>

        <dt>3.2. <a href="#frre">Resolver Response</a></dt>

        <dt>3.3. <a href="#frsrdie">Resolver SRDI</a></dt>

        <dt>3.4. <a href="#id277672">Endpoint Address URI Examples</a></dt>

        <dt>1.1. <a href="#fdqe">Discovery Query</a></dt>

        <dt>1.2. <a href="#fdre">Discovery Response</a></dt>

        <dt>1.3. <a href="#fpipeae">Pipe Advertisement</a></dt>

        <dt>2.1. <a href="#id292318">Welcome Message</a></dt>

        <dt>2.2. <a href="#id292618">HTTP Ping Example</a></dt>

        <dt>2.3. <a href="#id292903">HTTP Poll Example</a></dt>

        <dt>2.4. <a href="#id293081">HTTP Send Example</a></dt>

        <dt>3.1. <a href="#msgs-exm">XML Message</a></dt>

        <dt>1.1. <a href="#id302279">Sample "uuid" Format ID</a></dt>
      </dl>
    </div>

    <div class="preface" lang="en">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="id267901" id="id267901"></a>Conventions</h2>
          </div>
        </div>
      </div>

      <p>The following conventions are used throughout this document.</p>

      <div class="section" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a name="id267877" id=
              "id267877"></a>1.1.&nbsp;Significant Keywords</h2>
            </div>
          </div>
        </div>

        <p>The key words <span class="rfc2119">must</span>, <span class="rfc2119">must not</span>,
        <span class="rfc2119">required</span>, <span class="rfc2119">shall</span>, <span class=
        "rfc2119">shall not</span>, <span class="rfc2119">should</span>, <span class=
        "rfc2119">should not</span>, <span class="rfc2119">recommended</span>, <span class=
        "rfc2119">not recommended</span>, <span class="rfc2119">may</span>, and <span class=
        "rfc2119">optional</span> in this document are to be interpreted as described in
        &ldquo;<span class="citetitle">IETF RFC 2119</span>&rdquo; <a href="#bib-RFC2119" title=
        "Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a>.</p>
      </div>

      <div class="section" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a name="id268295" id=
              "id268295"></a>1.2.&nbsp;Text Representations</h2>
            </div>
          </div>
        </div>

        <p>All strings and text found in the JXTA Protocols should be assumed to be encoded using
        Unicode <a href="#bib-USA28" title="Unicode Standard Annex #28: Unicode 3.2">USA28</a>
        Canonical UTF8 (NFC) (see <em class="citetitle">Unicode Standard Annex #15 : Unicode
        Normalization Forms</em> <a href="#bib-USA15" title=
        "Unicode Standard Annex #15: Unicode Normalization Forms">USA15</a>) unless otherwise
        specified.</p>
      </div>
    </div>

    <div class="preface" lang="en">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="introduction" id="introduction"></a>Introduction</h2>
          </div>
        </div>
      </div>

      <div class="section" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a name="id268042" id=
              "id268042"></a>2.1.&nbsp;Why JXTA?</h2>
            </div>
          </div>
        </div>

        <p>The <a href="#gloss-jxta"><em class="firstterm">JXTA</em></a> Protocols comprise an open
        network computing platform designed for peer-to-peer (P2P) computing. The set of
        generalized JXTA protocols enable all connected devices on the network -- including cell
        phones, <acronym class="acronym">PDA</acronym>s, PCs and servers -- to communicate and
        collaborate as peers. The JXTA protocols enable developers to build and deploy
        interoperable services and applications, further spring-boarding the peer-to-peer
        revolution on the Internet.</p>

        <p>The JXTA protocols standardize the manner in which peers:</p>

        <div class="itemizedlist">
          <ul type="disc">
            <li>
              <p>Discover each other</p>
            </li>

            <li>
              <p>Self-organize into peer groups</p>
            </li>

            <li>
              <p>Advertise and discover network resources</p>
            </li>

            <li>
              <p>Communicate with each other</p>
            </li>

            <li>
              <p>Monitor each other</p>
            </li>
          </ul>
        </div>

        <p>The JXTA protocols are designed to be independent of the underlying implementation. In
        particular, the JXTA protocols <span class="emphasis"><em>do not</em></span>:</p>

        <div class="itemizedlist">
          <ul type="disc">
            <li>
              <p>Require the use of any particular computer language or operating system.</p>
            </li>

            <li>
              <p>Require the use of any particular network transport or topology.</p>
            </li>

            <li>
              <p>Require the use of any particular authentication, security or encryption
              model.</p>
            </li>
          </ul>
        </div>

        <p>JXTA provides a simple and generic P2P platform with all the basic functions necessary
        to host all types of network services:</p>

        <div class="itemizedlist">
          <ul type="disc">
            <li>
              <p>JXTA is defined by a small number of protocols. Each protocol is easy to implement
              and integrate into P2P services and applications. Thus, service offerings from one
              vendor can be used transparently by the user community of another vendor's
              system.</p>
            </li>

            <li>
              <p>The JXTA protocols are defined to be independent of programming languages, so that
              they can be implemented in C/C++, Java, Perl, and numerous other languages.
              Heterogeneous devices with completely different software stacks can interoperate
              using the JXTA protocols.</p>
            </li>

            <li>
              <p>The JXTA protocols are designed to be independent of transport protocols. They can
              be implemented on top of TCP/IP, HTTP, Bluetooth, HomePNA, and many other
              protocols.</p>
            </li>
          </ul>
        </div>
      </div>

      <div class="section" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a name="id268620" id=
              "id268620"></a>2.2.&nbsp;The JXTA Protocols</h2>
            </div>
          </div>
        </div>

        <p>The JXTA protocols are a set of six protocols that have been specifically designed for
        ad hoc, pervasive, and multi-hop peer-to-peer (P2P) network computing. Using the JXTA
        protocols, peers can cooperate to form self-organized and self-configured peer groups
        independent of their positions in the network (edges, firewalls, network address
        translators, public vs. private address spaces), and without the need of a centralized
        management infrastructure.</p>

        <p>The JXTA protocols are designed to have very low overhead, make few assumptions about
        the underlying network transport and impose few requirements on the peer environment, and
        yet are able to be used to deploy a wide variety of P2P applications and services in a
        highly unreliable and changing network environment.</p>

        <p>Peers use the JXTA protocols to advertise their resources and to discover network
        resources (services, pipes, etc.) available from other peers. Peers form and join peer
        groups to create special relationships. Peers cooperate to route messages allowing for full
        peer connectivity. The JXTA protocols allow peers to communicate without the need to
        understand or manage the potentially complex and dynamic network topologies which are
        increasingly common.</p>

        <p>The JXTA protocols allow peers to dynamically route messages across multiple network
        hops to any destination in the network (potentially traversing firewalls). Each message
        carries with it either a complete or partially ordered list of gateway peers through which
        the message might be routed. Intermediate peers in the route may assist the routing by
        using routes they know of to shorten or optimize the route a message is set to follow.</p>

        <p>The JXTA protocols are composed of six protocols that work together to allow the
        discovery, organization, monitoring and communication between peers:</p>

        <div class="itemizedlist">
          <ul type="disc">
            <li><a href="#proto-prp" title="3.1.&nbsp;Peer Resolver Protocol">Peer Resolver
            Protocol</a> (<acronym class="acronym">PRP</acronym>) is the mechanism by which a peer
            can send a query to one or more peers, and receive a response (or multiple responses)
            to the query. The <acronym class="acronym">PRP</acronym> implements a query/response
            protocol. The response message is matched to the query via a unique id included in the
            message body. Queries can be directed to the whole group or to specific peers within
            the group.</li>

            <li><a href="#proto-pdp" title="1.1.&nbsp;Peer Discovery Protocol">Peer Discovery
            Protocol</a> (<acronym class="acronym">PDP</acronym>) is the mechanism by which a peer
            can advertise its own resources, and discover the resources from other peers (peer
            groups, services, pipes and additional peers). Every peer resource is described and
            published using an advertisement. Advertisements are programming language-neutral
            metadata structures that describe network resources. Advertisements are represented as
            XML documents.</li>

            <li><a href="#proto-pip" title="1.3.&nbsp;Peer Information Protocol">Peer Information
            Protocol</a> (<acronym class="acronym">PIP</acronym>) is the mechanism by a which a
            peer may obtain status information about other peers. This can include state, uptime,
            traffic load, capabilities, and other information.</li>

            <li><a href="#proto-pbp" title="1.4.&nbsp;Pipe Binding Protocol">Pipe Binding
            Protocol</a> (<acronym class="acronym">PBP</acronym>) is the mechanism by which a peer
            can establish a virtual communication channel or pipe between one or more peers. The
            PBP is used by a peer to bind two or more ends of the connection (pipe endpoints).
            Pipes provide the foundation communication mechanism between peers.</li>

            <li><a href="#proto-erp" title="3.2.&nbsp;Endpoint Routing Protocol">Endpoint Routing
            Protocol</a> (<acronym class="acronym">ERP</acronym>) is the mechanism by which a peer
            can discover a route (sequence of hops) used to send a message to another peer. If a
            peer &ldquo;<span class="quote">A</span>&rdquo;wants to send a message to peer
            &ldquo;<span class="quote">C</span>&rdquo;, and there is no known direct route between
            &ldquo;<span class="quote">A</span>&rdquo;and &ldquo;<span class=
            "quote">C</span>&rdquo;, then peer &ldquo;<span class="quote">A</span>&rdquo;needs to
            find intermediary peer(s) who will route the message to &ldquo;<span class=
            "quote">C</span>&rdquo;. ERP is used to determine the route information. If the network
            topology changes and makes a previously used route unavailable, peers can use ERP to
            find an alternate route.</li>

            <li><a href="#proto-rvp" title="1.2.&nbsp;Rendezvous Protocol">Rendezvous Protocol</a>
            (<acronym class="acronym">RVP</acronym>) is the mechanism by which peers can subscribe
            or be a subscriber to a propagation service. Within a peer group, peers can be either
            rendezvous peers or peers that are listening to rendezvous peers. The Rendezvous
            Protocol allows a peer to send messages to all the listening instances of the service.
            The RVP is used by the Peer Resolver Protocol and by the Pipe Binding Protocol in order
            to propagate messages.</li>
          </ul>
        </div>

        <p>All of these protocols are implemented using a common messaging layer. This messaging
        layer is what binds the JXTA protocols to various network transports. (see <a href="#msgs"
        title="Chapter&nbsp;5.&nbsp;Messages">Messages</a>)</p>

        <p>Each of the JXTA protocols is independent of the others. A peer is not required to
        implement all of the JXTA protocols to be a JXTA peer. A peer only implements the protocols
        that it needs to use. For example:</p>

        <div class="itemizedlist">
          <ul type="disc">
            <li>
              <p>A device may have all the necessary advertisements it uses pre-stored in memory,
              and therefore not need to implement the Peer Discovery Protocol.</p>
            </li>

            <li>
              <p>A peer may use a pre-configured set of router peers to route all its messages.
              Because the peer just sends messages to the known routers to be forwarded, it does
              not need to fully implement the Endpoint Routing Protocol.</p>
            </li>

            <li>
              <p>A peer may not need to obtain or wish to provide status information to other
              peers, hence the peer might not implement the Peer Information Protocol.</p>
            </li>
          </ul>
        </div>

        <p>Each peer must implement two protocols in order to be addressable as a peer: the Peer
        Resolver Protocol and the Endpoint Routing Protocol. These two protocols and the
        advertisements, services and definitions they depend upon are known as the <a href=
        "#gloss-jcs"><em class="firstterm">JXTA Core Specification</em></a>. The <a href="#core"
        title="Part&nbsp;1.&nbsp;JXTA Core Specification">JXTA Core Specification</a> establishes
        the base infrastructure used by other services and applications.</p>

        <p>The remaining JXTA protocols, services and advertisements are optional. JXTA
        implementations are not required to provide these services, but are strongly recommended to
        do so. Implementing these services provides greater interoperability with other
        implementations and broader functionality. These common JXTA services are known as the
        <a href="#gloss-jss"><em class="firstterm">JXTA Standard Services</em></a>.</p>

        <div class="figure">
          <a name="intro-fjp" id="intro-fjp"></a>

          <p class="title"><b>Figure&nbsp;1.&nbsp;JXTA Protocols</b></p>

          <div class="figure-contents">
            <div class="mediaobject">
              <pre class="programlisting">
  +------------------------+     +------------------------+
  |  +------------------+  |     |  +------------------+  |
  |  | Peer Information | &lt;-------&gt; | Peer Information |  |
  |  +------------------+  |     |  +------------------+  |
  |                        |     |                        |
  |  +------------------+  |     |  +------------------+  |
  |  | Peer Rendezvous  | &lt;-------&gt; | Peer Rendezvous  |  |
  |  +------------------+  |     |  +------------------+  |
  |                        |     |                        |
  |  +------------------+  |     |  +------------------+  |
  |  | Pipe Binding     | &lt;-------&gt; | Pipe Binding     |  |
  |  +------------------+  |     |  +------------------+  |
  |                        |     |                        |
  |  +------------------+  |     |  +------------------+  |
  |  | Peer Discovery   | &lt;-------&gt; | Peer Discovery   |  |
  |  +------------------+  |     |  +------------------+  |
  |Peer                    |     |Peer                    |
  +------------------------+     +------------------------+

  +------------------------+     +------------------------+
  |  +------------------+  |     |  +------------------+  |
  |  | Peer Resolver    | &lt;-------&gt; | Peer Resolver    |  |
  |  +------------------+  |     |  +------------------+  |
  |                        |     |                        |
  |  +------------------+  |     |  +------------------+  |
  |  | Endpoint Routing | &lt;-------&gt; | Endpoint Routing |  |
  |  +------------------+  |     |  +------------------+  |
  |Endpoint                |     |Endpoint                |
  +------------------------+     +------------------------+

  +------------------------+     +------------------------+
  |       Transport        |     |      Transport         |
  +------------------------+     +------------------------+
</pre>
            </div>
          </div>
        </div><br class="figure-break">

        <p>A peer may decide to cache advertisements discovered via the Peer Discovery Protocol for
        later usage. It is important to point out that caching is not required by the JXTA
        architecture, but caching can be an important optimization. By caching advertisements, a
        peer avoids the need to perform a new discovery each time it accesses a network resource.
        In highly-transient environment, performing the discovery is the only viable solution. In
        static environments, caching is more efficient.</p>

        <p>A unique characteristic of P2P networks, like JXTA, is their ability to spontaneously
        replicate information toward end-users. Popular advertisements are likely to be replicated
        more often, making them easier to find as more copies become available. Peers do not have
        to return to the same peer to obtain the advertisements they seek. Instead of querying the
        original source of an advertisement, peers may query neighboring peers that have already
        cached the information. Each peer may potentially become an advertisement provider to any
        other peer.</p>

        <p>The JXTA protocols have been designed to allow JXTA to be easily implemented on
        uni-directional links and asymmetric transports. In particular, many forms of wireless
        networking do not provide equal capability for devices to send and receive. JXTA permits
        any uni-directional link to be used when necessary, improving overall performance and
        network connectivity in the system. The intent is for the JXTA protocols to be as pervasive
        as possible, and easy to implement on any transport. Implementations on reliable and
        bi-directional transports such as TCP/IP or HTTP should lead to efficient bi-directional
        communications.</p>

        <p>The JXTA uni-directional and asymmetric transport also plays well in multi-hop network
        environments where the message latency may be difficult to predict. Furthermore, peers in a
        P2P network tend to have nondeterministic behaviours. They may join or leave the network on
        a very frequent basis.</p>
      </div>

      <div class="section" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a name="id268965" id=
              "id268965"></a>2.3.&nbsp;The JXTA Three Layer Cake</h2>
            </div>
          </div>
        </div>

        <p>The JXTA Project is logically divided in three layers.</p>

        <div class="itemizedlist">
          <ul type="disc">
            <li>
              <p><span class="emphasis"><em>Platform.</em></span> This layer encapsulates minimal
              and essential primitives that are common to P2P networking, including peers, peer
              groups, discovery, communication, monitoring, and associated security primitives.
              This layer is ideally shared by all P2P devices so that interoperability becomes
              possible.</p>
            </li>

            <li>
              <p><span class="emphasis"><em>Services.</em></span> This layer includes network
              services that may not be absolutely necessary for a P2P network to operate but are
              common or desirable for P2P environments. Examples of network services include search
              and indexing, directory, storage systems, file sharing, distributed file systems,
              resource aggregation and renting, protocol translation, authentication and PKI
              services.</p>
            </li>

            <li>
              <p><span class="emphasis"><em>Applications.</em></span> This layer includes P2P
              instant messaging, entertainment content management and delivery, P2P E-mail systems,
              distributed auction systems, and many others. Obviously, the boundary between
              services and applications is not rigid. An application to one customer can be viewed
              as a service to another customer.</p>
            </li>
          </ul>
        </div>
      </div>

      <div class="section" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a name="id269015" id=
              "id269015"></a>2.4.&nbsp;JXTA Assumptions</h2>
            </div>
          </div>
        </div>

        <p>This section is a guide to the assumptions that shape the JXTA design. There are two
        types of assumptions stated here: those which describe the requirements of JXTA
        implementations and those which describe the expected behaviour of the JXTA network.</p>

        <p>A peer <span class="rfc2119">shall not</span> make assumptions about the runtime
        environments or programming languages in use by another peer. The network of peers
        reachable by any peer is likely to contain many peers with heterogeneous implementations
        and capabilities.</p>

        <p>A peer <span class="rfc2119">should</span> assume that the capabilities and complexity
        of the network peers supporting these protocols can range from a single light switch to a
        highly-available supercomputer cluster.</p>

        <p>A peer <span class="rfc2119">must</span> implement the JXTA protocols such that all
        interaction with other peers is correct and conformant.</p>

        <p>A peer <span class="rfc2119">may</span> implement only the JXTA protocols it requires
        for correct and conformant interaction with other peers.</p>

        <p>A peer <span class="rfc2119">may</span> choose to partially implement protocols if
        unimplemented portions will never be used. (e.g. it may implement client-side or
        server-side portions only.)</p>

        <p>Peers wishing to interact with other peers within the JXTA network <span class=
        "rfc2119">should</span> be willing to participate fully in the protocols. In particular,
        peers <span class="rfc2119">should</span> cache advertisements and forward messages for
        other peers in the JXTA network. However, this participation is <span class=
        "rfc2119">optional</span>.</p>

        <p>The JXTA protocols <span class="rfc2119">may</span> be deployed over a wide variety of
        network configurations including the Internet, corporate intranets, a dynamic proximity
        network, or in a home networking environment. Applications should avoid assumptions about
        the underlying network environment.</p>

        <p>Peers receiving a corrupted or detectably compromised message <span class=
        "rfc2119">must</span> discard the message. Messages may be corrupted or intentionally
        altered during network transmission.</p>

        <p>Peers <span class="rfc2119">may</span> appear, disappear and migrate at any time without
        notice. In particular, the JXTA protocols support very arbitrary environment changes
        allowing a peer to dynamically discover and reconnect to its changing environment.</p>

        <p>The communication path between any pair of peers <span class="rfc2119">may</span> at
        times not work equally well in both directions. That is, communications between two peers
        will in many cases be able to operate bi-directionally, but at times the connection between
        two peers may be only uni-directional, allowing one peer to successfully send messages to
        the other while no communication is possible in the reverse direction.</p>

        <p>The JXTA protocols are defined as idempotent protocol exchanges. The same messages
        <span class="rfc2119">may</span> be sent/received more than once during the course of a
        protocol exchange. No protocol states are required to be maintained at both ends.</p>

        <p>Due to unpredictability of P2P networks, assumptions <span class="rfc2119">must
        not</span> be made about the time required for a message to reach a destination peer. The
        <a href="#core-proto" title="Chapter&nbsp;3.&nbsp;JXTA Core Protocols">JXTA Core
        Protocols</a> <span class="rfc2119">must not</span> impose any timing requirements for
        message receipt.</p>

        <p>The JXTA Transport Protocols (see <a href="#core-trans" title=
        "Chapter&nbsp;4.&nbsp;Core JXTA Message Transport Bindings">Core JXTA Message Transport
        Bindings</a> and <a href="#stdsvc-trans" title=
        "Chapter&nbsp;2.&nbsp;Standard JXTA Message Transports">Standard JXTA Message
        Transports</a>) <span class="rfc2119">must not</span> impose any timing requirements on the
        <a href="#core-proto" title="Chapter&nbsp;3.&nbsp;JXTA Core Protocols">JXTA Core
        Protocols</a>, but <span class="rfc2119">may</span> have timing requirements internal to
        themselves.</p>

        <p>The <a href="#stdsvc-proto" title="Chapter&nbsp;1.&nbsp;Standard Protocols">Standard
        Protocols</a> (e.g. <a href="#proto-pdp" title="1.1.&nbsp;Peer Discovery Protocol">Peer
        Discovery Protocol</a>, <a href="#proto-pip" title=
        "1.3.&nbsp;Peer Information Protocol">Peer Information Protocol</a>, <a href="#proto-pbp"
        title="1.4.&nbsp;Pipe Binding Protocol">Peer Discovery Protocol</a>, etc.) and application
        defined protocols <span class="rfc2119">may</span> impose timing requirements on message
        delivery and receipt.</p>

        <p>A JXTA protocol message which is routed through multiple hops <span class=
        "rfc2119">should not</span> be assumed to reliably delivered, even if only reliable
        transports such as TCP/IP are used through all hops. A congested peer <span class=
        "rfc2119">may</span> drop messages at any time rather than routing them.</p>

        <p>JXTA protocol messages and advertisements are defined using XML and are <span class=
        "rfc2119">required</span> to be well-formed XML documents. The use of a full XML parser is
        <span class="rfc2119">optional</span> as long as the requirements of the being well-formed
        and the JXTA protocol are met. Small JXTA implementations <span class="rfc2119">may</span>
        choose to use pre-built XML or XML templates for message and advertisement
        construction.</p>

        <p>The JXTA protocols <span class="rfc2119">must not</span> require a broadcast or
        multicast capability of the underlying network transport. Messages intended for receipt by
        multiple peers (propagation) <span class="rfc2119">may</span> be implemented using
        point-to-point communications.</p>

        <p>A peer <span class="rfc2119">should</span> make the assumption that if a destination
        address is not available at any time during the message transmission, the message will not
        be delivered.</p>

        <p>A peer <span class="rfc2119">must not</span> assume that there is a guaranteed return
        route to a peer from which it has received communication. The lack of a return route may
        either be temporary or permanent.</p>

        <p>Each peer <span class="rfc2119">must</span> be a member of the World Peergroup and Net
        Peergroups. Membership in these groups is automatic.</p>

        <p>Peers <span class="rfc2119">must</span> be members of the same peer group in order to
        exchange messages.</p>

        <p>Names are not unique unless a coordinated naming service is used to guarantee name
        uniqueness. A naming service is typically a service that guarantees, within a given scope,
        the uniqueness of name and can be used to register name mapping. Examples of name services
        are DNS and LDAP. A naming service is <span class="rfc2119">optional</span>. JXTA does not
        define its own naming service.</p>

        <p>Once content has been published to the JXTA network, it <span class="rfc2119">should
        not</span> be assumed that that the content can be later retrieved from the JXTA network.
        The content may be available only from peers that are not currently reachable.</p>

        <p>Once a content has been published to the JXTA network, it <span class="rfc2119">must
        not</span> be assumed that the content can be deleted. Republication of content by peers is
        unrestricted and the content may propagate to peers which are not reachable from the
        publishing peer.</p>
      </div>
    </div>

    <div class="preface" lang="en">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="id270075" id="id270075"></a>Conceptual Overview</h2>
          </div>
        </div>
      </div>

      <p>JXTA is intended to be a small system with a limited number of concepts at its core. This
      chapter introduces the concepts which are central to JXTA.</p>

      <div class="section" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a name="id270052" id=
              "id270052"></a>3.1.&nbsp;Peers</h2>
            </div>
          </div>
        </div>

        <p>A JXTA peer is any networked device (sensor, phone, <acronym class=
        "acronym">PDA</acronym>, <acronym class="acronym">PC</acronym>, server, supercomputer,
        etc.) that implements the core JXTA protocols. Each peer is identified by a unique ID.
        Peers are autonomous and operate independently and asynchronously of all other peers. Some
        peers <span class="rfc2119">may</span> have dependencies upon other peers due to special
        requirements such as the need for gateways, proxies, or routers.</p>

        <p>Peers <span class="rfc2119">may</span> publish network services and resources (
        <acronym class="acronym">CPU</acronym>, storage, databases, documents, etc.) for use by
        other peers. A peer <span class="rfc2119">may</span> cache advertisements for JXTA
        resources, but doing so is <span class="rfc2119">optional</span>. Peers <span class=
        "rfc2119">may</span> have persistent storage.</p>

        <p>Peers are typically configured to spontaneously discover each other on the network to
        form transient or persistent relationships with other peers. Peers that provide the same
        set of services tend to be interchangeable. As a result, peers typically need to interact
        with only a small number of other peers (network neighbors or buddy peers). Peers
        <span class="rfc2119">should not</span> make assumptions about the reliability of other
        peers. Peers <span class="rfc2119">may</span> join or leave the network at any time. A peer
        <span class="rfc2119">should</span> always anticipate that connectivity may be lost to any
        peer that it is currently communicating with.</p>

        <p>Peers <span class="rfc2119">may</span> advertise multiple network interfaces. Each
        published interface is advertised as a peer endpoint. A peer endpoint is a URI that
        uniquely identify a peer network interface (for example, a URI might specify a TCP port and
        associated IP address). Peer endpoints are used by peers to establish direct point-to-point
        connections between two peers.</p>

        <p>Communicating peers are not required to have direct point-to-point network connection
        between themselves. A peer <span class="rfc2119">may</span> need to use one or more
        intermediary peers to route a message to another peer that is separated due to physical
        network connections or network configurations (e.g., NATs, firewalls, or proxies).</p>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a name="id270489" id="id270489"></a>3.1.1.&nbsp;Peers and
                Users</h3>
              </div>
            </div>
          </div>

          <p>There is no explicit relationship between users and peers within JXTA, but for many
          applications the two concepts are closely related.</p>

          <p>Frequently a peer will be under the control of a human operator, the
          &ldquo;<span class="quote">user</span>&rdquo;, and will interact with the network on the
          basis of the user's direction. However, not every peer has an associated user. Many peers
          exist to provide services and resources to the network, but are not associated with any
          user. Examples include devices such as sensors and printers, and services such as
          databases.</p>

          <p>The concept of &ldquo;<span class="quote">user</span>&rdquo; exists primarily for
          identification: some applications may need to allow users to tell each other apart and to
          manage their interactions. Identity is also frequently tied to security and
          permissions.</p>
        </div>
      </div>

      <div class="section" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a name="overview-peergroups" id=
              "overview-peergroups"></a>3.2.&nbsp;Peer Groups</h2>
            </div>
          </div>
        </div>

        <p>Peers self-organize into Peer Groups. A peer group is a collection of peers that have a
        common set of interests. Each peer group is uniquely identified by a PeerGroup Id. The JXTA
        protocols do not dictate when, where, or why peer groups are created. The JXTA protocols
        only describe how peers may publish, discover, join, and monitor peer groups.</p>

        <p>JXTA recognizes three common motivations for creating peer groups:</p>

        <div class="itemizedlist">
          <ul type="disc">
            <li>
              <p><span class="emphasis"><em>To create a secure environment.</em></span> Peer group
              boundaries permit member peers to access and publish protected contents. Peer groups
              form logical regions whose boundaries limit access to the peer group resources. A
              peer group does not necessarily reflect the underlying physical network boundaries
              such as those imposed by routers and firewalls. Peer groups virtualize the notion of
              routers and firewalls, subdividing the network into secure regions without respect to
              actual physical network boundaries.</p>
            </li>

            <li>
              <p><span class="emphasis"><em>To create a scoping environment.</em></span> Peer
              groups are typically formed and self-organized based upon the mutual interest of
              peers. No particular rules are imposed on the way peer groups are formed, but peers
              with the same interests will tend to join the same peer groups. Peer groups serve to
              subdivide the network into abstract regions providing an implicit scoping mechanism.
              Peer group boundaries define the search scope when searching for a group's
              content.</p>
            </li>

            <li>
              <p><span class="emphasis"><em>To create a monitoring environment.</em></span> Peer
              groups permit peers to monitor a set of peers for any special purpose, including
              heartbeat, traffic introspection, and accountability.</p>
            </li>
          </ul>
        </div>

        <p>A peer group provides a set of services called peer group services. JXTA defines a core
        set of peer group services, and the JXTA protocols specify the wire format for these
        services. Additional peer group services can be developed for delivering specific services.
        For example, a lookup service could be implemented to find active (running on some peer)
        and inactive (not yet running) service instances. The core peer group services are:</p>

        <div class="variablelist">
          <dl>
            <dt><span class="term">Discovery Service</span></dt>

            <dd>The Discovery service is used by member peers to search for peer group resources
            such as peers, peer groups, pipes, and services.</dd>

            <dt><span class="term">Membership Service</span></dt>

            <dd>
              <p>The membership service is used by the current peer group members to reject or
              accept a new group membership application (i.e., to allow a new peer to join a peer
              group). We expect that most peer groups will have a membership service, though it may
              be a &ldquo;<span class="quote">null</span>&rdquo;authenticator service which imposes
              no real membership policy.</p>

              <p>Peers wanting to join a peer group <span class="rfc2119">may</span> need to
              discover at least one member of the peer group and then request to join. The request
              to join is either rejected or accepted by the collective set of current members. The
              membership service <span class="rfc2119">may</span> enforce a vote of peers or elect
              a designated group representative to accept or reject new membership requests.</p>

              <p>A peer <span class="rfc2119">may</span> belong to more than one peer group
              simultaneously.</p>
            </dd>

            <dt><span class="term">Access Service</span></dt>

            <dd>
              <p>The Access service is used to validate requests made by one peer to another. The
              peer receiving the request provides the requesting peer credentials and information
              about the request being made to the Access Service to determine if the access is
              permitted.</p>

              <p>Not all actions within the peer group need to be checked with the Access Service.
              Only those actions that are restricted to a subset of member peers must be
              checked.</p>
            </dd>

            <dt><span class="term">Pipe Service</span></dt>

            <dd>The pipe service is used to manage and create pipe connections between the
            different peer group members.</dd>

            <dt><span class="term">Resolver Service</span></dt>

            <dd>The resolver service is used to address queries to services running on peers in the
            group and collect responses.</dd>

            <dt><span class="term">Monitoring Service</span></dt>

            <dd>The monitoring service is used to allow one peer to monitor other members of the
            same peer group.</dd>
          </dl>
        </div>

        <p>Not all the above services <span class="rfc2119">must</span> be implemented by a peer
        group. A peer group can implement only the services it finds useful and rely on the default
        Net Peergroup to provide generic implementations of other services.</p>

        <p>Each service <span class="rfc2119">may</span> implement one or more of the JXTA
        protocols, the specifications for which are the main content of this document. A service
        will typically implement one protocol for simplicity and modularity reasons, but some
        services may not implement any protocols.</p>
      </div>

      <div class="section" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a name="overview-services" id=
              "overview-services"></a>3.3.&nbsp;Network Services</h2>
            </div>
          </div>
        </div>

        <p>Peers cooperate and communicate to publish, discover and invoke network services. A peer
        can publish as many services as it can provide. Peers discover network services via the
        Peer Discovery Protocol.</p>

        <p>Network Service specifications are beyond the scope of this document. Upcoming standards
        such as WSDL, ebXML, SOAP, UPnP might be used within a JXTA Network.</p>

        <p>The JXTA protocols recognize two levels of network services:</p>

        <div class="itemizedlist">
          <ul type="disc">
            <li>Peer Services</li>

            <li>Peer Group Services</li>
          </ul>
        </div>

        <p>A peer service is accessible only on the peer that is publishing the service. If that
        peer happens to fail, then the service also fails. Multiple instances of the service can be
        run on different peers, but each instance publishes its own advertisement.</p>

        <p>A peer group service is composed of a collection of instances (potentially cooperating
        with each other) of the service running on multiple members of the peer group. If any one
        peer fails, the collective peer group service is not affected: in most cases, the service
        is still available from another peer member. Peer group services are published as part of
        the peer group advertisement.</p>

        <p>Services can either be pre-installed into a peer or loaded from the network. The process
        of finding, downloading and installing a service from the network is similar to performing
        a search on the internet for a web page, retrieving the page, and then installing the
        required plug-in. In order to actually run a service, a peer may need to locate an
        implementation suitable for the peer's runtime environment. Multiple implementations of the
        same service may allow Java peers to use Java code implementations, and native peers to use
        native code implementations.</p>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a name="id270870" id="id270870"></a>3.3.1.&nbsp;Service
                Invocation</h3>
              </div>
            </div>
          </div>

          <p>Service invocation is outside the scope of JXTA. JXTA is designed to interoperate and
          be compatible with any Web service standards: WSDL, uPnP, RMI, etc. The JXTA protocols
          define a generic framework to publish and discover advertisements that may describe
          services. Peers publish and discover advertisements via the Peer Discovery Protocol. An
          advertisement for a service typically contains all necessary information to either invoke
          or instantiate the service being described. The JXTA protocols define Module
          Advertisements, but any other form of service description may be introduced.</p>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h3 class="title"><a name="id270885" id="id270885"></a>3.3.2.&nbsp;JXTA-Enabled
                Services</h3>
              </div>
            </div>
          </div>

          <p>JXTA-Enabled services are services that are published using a ModuleSpecAdvertisement.
          A ModuleSpecAdvertisement may specify a pipe advertisement that can be used by a peer to
          create output pipes to invoke the service. ModuleSpecAdvertisements may be extended in
          the future to contain a list of pre-determined messages that can be sent by a peer to
          interact with the service. A ModuleSpecAdvertisement may also contain references to two
          other services that can be used as an authenticator for the service and as a local proxy
          for the service.</p>

          <p>Each JXTA-enabled service is uniquely identified by its ModuleSpecID.</p>
        </div>
      </div>

      <div class="section" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a name="overview-ids" id=
              "overview-ids"></a>3.4.&nbsp;IDs</h2>
            </div>
          </div>
        </div>

        <p>Peers, peer groups, pipes, contents, and other resources need to be uniquely
        identifiable within the JXTA protocols. A JXTA ID uniquely identifies an entity and serves
        as a canonical means of referring to that entity.</p>

        <p>URNs are used for the expression of JXTA IDs.</p>
      </div>

      <div class="section" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a name="overview-advertisements" id=
              "overview-advertisements"></a>3.5.&nbsp;Advertisements</h2>
            </div>
          </div>
        </div>

        <p>All network resources, such as peers, peer groups, pipes and services, are represented
        by advertisements. Advertisements are JXTA's language neutral metadata structures for
        describing resources. The JXTA Core Specification and Standard Services define, among
        others, the following advertisement types:</p>

        <div class="itemizedlist">
          <ul type="disc">
            <li>Peer Advertisement</li>

            <li>PeerGroup Advertisement</li>

            <li>ModuleClass Advertisement</li>

            <li>ModuleSpec Advertisement</li>

            <li>ModuleImpl Advertisement</li>

            <li>Pipe Advertisement</li>

            <li>Rendezvous Advertisement</li>
          </ul>
        </div>

        <p>The complete specification of advertisements is given in the <a href="#core-advert"
        title="Chapter&nbsp;2.&nbsp;Advertisements">Advertisements</a> chapter. Because the JXTA
        protocols make heavy reference to these advertisements, the reader should be familiar with
        advertisements before moving on to the protocol specification chapters. Advertisements are,
        by far, the most common document exchanged in the protocol messages.</p>

        <p>Advertisments are published with a lifetime that specifies the availability of the
        resource. An advertisement can be republished to extend the lifetime of a resource.</p>

        <p>Services and peer implementations can create their own advertisement types, either from
        scratch or by subtyping the existing types.</p>
      </div>

      <div class="section" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a name="id271015" id=
              "id271015"></a>3.6.&nbsp;Credentials</h2>
            </div>
          </div>
        </div>

        <p>The need to support different levels of resource access in a dynamic and ad hoc P2P
        network leads to a role-based trust model in which an individual peer acts under the
        authority granted to it by another trusted peer to perform a particular task. Peer
        relationships <span class="rfc2119">may</span> change quickly and the policies governing
        access control need to be flexible in allowing or denying access.</p>

        <p>Four basic security requirements <span class="rfc2119">must</span> be provided:</p>

        <div class="variablelist">
          <dl>
            <dt><span class="term">Confidentiality</span></dt>

            <dd>Guarantees that the contents of the message are not disclosed to unauthorized
            individuals.</dd>

            <dt><span class="term">Authorization</span></dt>

            <dd>Guarantees that the sender is authorized to send a message.</dd>

            <dt><span class="term">Data integrity</span></dt>

            <dd>Guarantees that the message was not accidentally or deliberately modified in
            transit.</dd>

            <dt><span class="term">Refutability</span></dt>

            <dd>Guarantees the message was transmitted by a properly identified sender and is not a
            replay of a previously transmitted message.</dd>
          </dl>
        </div>

        <p>The structure of JXTA messages enables JXTA applications to add arbitrary metadata
        information, such as credentials, digests, certificates, and public keys, to messages.
        Message digests guarantee the data integrity of messages. Messages may also be encrypted
        and signed for confidentiality and refutability. Credentials can be used to provide message
        authentication and authorization.</p>

        <p>A credential is a token that, when presented in a message body, is used to identify a
        sender and can be used to verify that sender's right to send the message to the specified
        endpoint. The credential is an opaque token that must be presented each time a message is
        sent. The sending address placed in the message envelope is cross-checked with the sender's
        identity in the credential. Each credential's implementation is specified as a plug-in
        configuration, which allows multiple authentication configurations to co-exist on the same
        network.</p>

        <p>It is the intent of the JXTA protocols to be compatible with widely accepted
        transport-layer security mechanisms. Some JXTA implementations contain a virtualized TLS
        implementation that allows it to secure endpoint-to-endpoint communications regardless of
        the number of hops required to deliver each message.</p>

        <p>TLS and IPSec could also be used as JXTA transports. However, when used as transports
        they provide integrity and confidentiality of message transfer only between the two
        communicating peers.</p>
      </div>

      <div class="section" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a name="overview-pipes" id=
              "overview-pipes"></a>3.7.&nbsp;Pipes</h2>
            </div>
          </div>
        </div>

        <p>Pipes are virtual communication channels used to send and receive messages between
        services or applications. Pipes provide the illusion of a virtual in and out mailbox that
        is independent of any single peer location, and independent of network topology (multi-hops
        route).</p>

        <p>Different quality of services can be implemented by a pipe. For example:</p>

        <div class="variablelist">
          <dl>
            <dt><span class="term">Uni-directional asynchronous</span></dt>

            <dd>The endpoint sends a message, no guarantee of delivery is made.</dd>

            <dt><span class="term">Synchronous request-response</span></dt>

            <dd>The endpoint sends a message, and receives a correlated answer.</dd>

            <dt><span class="term">Bulk transfer</span></dt>

            <dd>Bulk reliable data transfer of binary data.</dd>

            <dt><span class="term">Streaming</span></dt>

            <dd>Efficient control-flow data transfer.</dd>

            <dt><span class="term">Secure</span></dt>

            <dd>Secure reliable data streams.</dd>
          </dl>
        </div>

        <p>The uni-directional asynchronous pipe is <span class="rfc2119">required</span> by the
        JXTA protocols. Other pipe variations may be implemented for use by services and their
        associated protocols.</p>

        <p>Pipes provide a network abstraction over the peer endpoint transport. Peer endpoints
        correspond to the available peer network interfaces that can be used to send and receive
        data from another peer. Pipes connect one or more peer endpoints. At each endpoint software
        to send or receive, as well as to manage associated pipe message queues or streams, is
        assumed, but message queues are <span class="rfc2119">optional</span>.</p>

        <p>The pipe endpoints are referred to as input pipes (receiver) and output pipes
        (transmitter). Pipe endpoints are dynamically bound to a peer endpoint at runtime, via the
        <a href="#proto-pbp" title="1.4.&nbsp;Pipe Binding Protocol">Pipe Binding Protocol</a>. The
        pipe binding process consists of searching for and connecting the two or more endpoints of
        a pipe.</p>

        <p>When a message is sent into an output pipe, the message is sent by the local peer
        endpoint to the peer endpoint(s) where the associated input pipe is located. The set of
        peer endpoints currently associated with the input pipes is discovered using the <a href=
        "#proto-pbp" title="1.4.&nbsp;Pipe Binding Protocol">Pipe Binding Protocol</a>.</p>

        <p>A pipe offers two modes of communication:</p>

        <div class="variablelist">
          <dl>
            <dt><span class="term">Point to Point</span></dt>

            <dd>A point to point pipe connects exactly two pipe endpoints together: an input pipe
            that receives messages sent from an output pipe. No reply or acknowledgment operation
            is supported. Additional information in the message payload (like a unique id) may be
            required to thread message sequences. The message payload may also contain a pipe
            advertisement that can be used to open a pipe to reply to the sender
            (send/response).</dd>

            <dt><span class="term">Propagate Pipe</span></dt>

            <dd>A propagate pipe connects one output pipe and multiple input pipes together.
            Messages flow from the output pipe (propagation source) into the input pipes. A
            propagate message is sent to all listening input pipes. This process may create
            multiple copies of the message to be sent. On TCP/IP, when the propagate scope maps an
            underlying physical subnet in a 1-to-1 fashion, IP multicast may be used as an
            implementation for propagate pipes. For transports (such as HTTP) that do not provide
            multicast, propagate pipes can be implemented using point-to-point communication.</dd>
          </dl>
        </div>

        <div class="figure">
          <a name="id271316" id="id271316"></a>

          <p class="title"><b>Figure&nbsp;2.&nbsp;JXTA Pipe Types</b></p>

          <div class="figure-contents">
            <div class="mediaobject">
              <img src="images/pipetype.gif" alt=
              "Diagram showing both point-to-point pipes and propagate pipes.">
            </div>
          </div>
        </div><br class="figure-break">

        <p>Pipes may connect two peers that do not have a direct physical link. In this case, one
        or more intermediary peer endpoints are used to route messages between the two pipe
        endpoints.</p>
      </div>

      <div class="section" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a name="id271367" id=
              "id271367"></a>3.8.&nbsp;Messages</h2>
            </div>
          </div>
        </div>

        <p>The information transmitted using pipes and between endpoints is packaged as messages.
        Messages define an envelope to transfer any kind of data. A message <span class=
        "rfc2119">may</span> contain an arbitrary number of named sub-sections which can hold any
        form of data.</p>

        <p>It is the intent that the JXTA protocols be compliant with W3C XML Protocol standards,
        so that the JXTA protocols can be implemented on XML transports such as SOAP, XML-RPC,
        etc.</p>

        <p>The JXTA protocols are specified as a set of XML messages exchanged between peers. Each
        software platform binding describes how a message is converted to and from a native data
        structures such as Java objects or &ldquo;<span class="quote">C</span>&rdquo;
        structures.</p>

        <p>The use of XML messages to define protocols allows many different kinds of peers to
        participate in a protocol. Each peer is free to implement the protocol in a manner best
        suited to its abilities and role.</p>
      </div>

      <div class="section" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title" style="clear: both"><a name="overview-codats" id=
              "overview-codats"></a>3.9.&nbsp;Codats</h2>
            </div>
          </div>
        </div>

        <p>The JXTA protocols assume that many types of contents may be shared, exchanged, and
        replicated between peers. A content can be a text file, a structured document (like a PDF
        or an XML file), a Java <code class="filename">.jar</code> or loadable library, code or
        even an executable process. No size limitation is assumed.</p>

        <p>Content are published and shared amongst peer members of a peer group. When a content is
        shared within the JXTA network it is associated with a JXTA ID. The combination of a
        content and a JXTA ID is known as a <a href="#gloss-codat"><em class=
        "firstterm">Codat</em></a>. A codat may belong to only one peer group. If the same content
        must be published in two different peer groups, two different codats are created. The two
        codats <span class="rfc2119">may</span>, of course, represent the same content.</p>

        <p>Each codat is uniquely identified by a JXTA ID. All codats make their existence known to
        peer members by publishing a content advertisement.</p>

        <p>A codat instance is a copy of a codat. Each codat copy may be replicated on different
        peers in the peer group. Each copy has the same codat id and an identical content.</p>

        <p>Replicating codats within a peer group helps to ensure that each item of content is more
        readily available. For example, if an item has two instances residing on two different
        peers, only one of the peers needs to be alive to respond to the content request.</p>

        <p>The JXTA protocols do not specify how codats are replicated. This decision is left to
        higher-level content service managers.</p>
      </div>
    </div>

    <div class="part" lang="en">
      <div class="titlepage">
        <div>
          <div>
            <h1 class="title"><a name="core" id="core"></a>Part&nbsp;1.&nbsp;JXTA Core
            Specification</h1>
          </div>
        </div>
      </div>

      <div class="partintro" lang="en">
        <div>
          <div>
            <div>
              <h1 class="title"><a name="core-i" id="core-i"></a>Introduction</h1>
            </div>
          </div>
        </div>

        <p>JXTA is designed to be a small system with only a few required components and
        behaviours. The functionality that is required of all implementations is defined by the
        <a href="#gloss-jcs"><em class="firstterm">JXTA Core Specification</em></a> and is
        documented in this section. Implementations that wish to be JXTA compliant <span class=
        "rfc2119">must</span> implement all of the <a href="#core" title=
        "Part&nbsp;1.&nbsp;JXTA Core Specification">JXTA Core Specification</a>.</p>

        <p>Implementation of the <a href="#core" title=
        "Part&nbsp;1.&nbsp;JXTA Core Specification">JXTA Core Specification</a> does not guarantee
        or even necessarily provide interoperability with other JXTA implementations. There are a
        number of types of components and behaviours which need to be provided by JXTA
        implementation which are not part of the <a href="#core" title=
        "Part&nbsp;1.&nbsp;JXTA Core Specification">JXTA Core Specification</a>. Existing
        implementations of these components are described separately in <a href="#stdsvc" title=
        "Part&nbsp;2.&nbsp;JXTA Standard Services">JXTA Standard Services</a> and <a href=
        "#refimpls" title="Part&nbsp;3.&nbsp;JXTA Reference Implementations Information">JXTA
        Reference Implementations Information</a>. In order for a JXTA implementation to be
        interoperable with other implementations it may be necessary to implement some of the
        components described there.</p>

        <div class="toc">
          <p><b>Table of Contents</b></p>

          <dl>
            <dt><span class="chapter"><a href="#ids">1. IDs</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#ids-i">1.1. Introduction</a></span></dt>

                <dt><span class="section"><a href="#ids-jip">1.2. JXTA ID
                Properties</a></span></dt>

                <dt><span class="section"><a href="#ids-ujip">1.3. Using JXTA IDs in
                Protocols</a></span></dt>

                <dt><span class="section"><a href="#ids-fjiu">1.4. Format of a JXTA ID
                URN</a></span></dt>

                <dt><span class="section"><a href="#ids-ejiu">1.5. Example JXTA ID
                URNs</a></span></dt>

                <dt><span class="section"><a href="#id273152">1.6. JXTA ID
                Representation</a></span></dt>

                <dt><span class="section"><a href="#ids-jif">1.7. JXTA ID Formats</a></span></dt>

                <dt><span class="section"><a href="#ids-jit">1.8. JXTA ID Types</a></span></dt>

                <dt><span class="section"><a href="#ids-jinf">1.9. JXTA ID Formats :
                &ldquo;<span class="quote">jxta</span>&rdquo; ID Format</a></span></dt>
              </dl>
            </dd>

            <dt><span class="chapter"><a href="#core-advert">2. Advertisements</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#advert-i">2.1. Introduction</a></span></dt>

                <dt><span class="section"><a href="#advert-x">2.2. XML and JXTA
                Advertisements</a></span></dt>

                <dt><span class="section"><a href="#advert-pa">2.3. Peer
                Advertisement</a></span></dt>

                <dt><span class="section"><a href="#advert-pga">2.4. Peer Group
                Advertisement</a></span></dt>

                <dt><span class="section"><a href="#advert-mca">2.5. Module Class
                Advertisement</a></span></dt>

                <dt><span class="section"><a href="#advert-msa">2.6. Module Specification
                Advertisement</a></span></dt>

                <dt><span class="section"><a href="#advert-mia">2.7. Module Implementation
                Advertisement</a></span></dt>
              </dl>
            </dd>

            <dt><span class="chapter"><a href="#core-proto">3. JXTA Core Protocols</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#proto-prp">3.1. Peer Resolver
                Protocol</a></span></dt>

                <dt><span class="section"><a href="#proto-erp">3.2. Endpoint Routing
                Protocol</a></span></dt>
              </dl>
            </dd>

            <dt><span class="chapter"><a href="#core-trans">4. Core JXTA Message Transport
            Bindings</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#trans-endpt">4.1. Endpoint
                Service</a></span></dt>

                <dt><span class="section"><a href="#trans-router">4.2. Endpoint Router Transport
                Protocol</a></span></dt>
              </dl>
            </dd>

            <dt><span class="chapter"><a href="#msgs">5. Messages</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#id280185">5.1. Introduction</a></span></dt>

                <dt><span class="section"><a href="#id280538">5.2. Message</a></span></dt>

                <dt><span class="section"><a href="#id280567">5.3. Element</a></span></dt>
              </dl>
            </dd>
          </dl>
        </div>
      </div>

      <div class="chapter" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a name="ids" id="ids"></a>Chapter&nbsp;1.&nbsp;IDs</h2>
            </div>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="ids-i" id=
                "ids-i"></a>1.1.&nbsp;Introduction</h2>
              </div>
            </div>
          </div>

          <p>The JXTA protocols often need to refer to peers, peer groups, pipes and other JXTA
          resources. These references are presented in the protocols as JXTA IDs. JXTA IDs are a
          means for uniquely identifying specific peer groups, peers, pipes, codat and service
          instances. JXTA IDs provide unambiguous references to the various JXTA entities. There
          are six types of JXTA entities which have JXTA ID types defined: peergroups, peers,
          pipes, codats, module classes and module specifications. Additional JXTA ID types may be
          defined in the future.</p>

          <p>JXTA IDs are normally presented as URNs. URNs are a form of URI that
          &ldquo;<span class="quote">... are intended to serve as persistent, location-independent,
          resource identifiers</span>&rdquo;. Like other forms of URI, JXTA IDs are presented as
          text. See &ldquo;<span class="citetitle">IETF RFC 2141</span>&rdquo; <a href=
          "#bib-RFC2141" title="URN Syntax">RFC2141</a> for more information on URNs.</p>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="ids-jip" id=
                "ids-jip"></a>1.2.&nbsp;JXTA ID Properties</h2>
              </div>
            </div>
          </div>

          <p>Every JXTA ID, regardless of format or type has the following properties:</p>

          <div class="itemizedlist">
            <ul type="disc">
              <li>Unambiguous. It <span class="rfc2119">must</span> be a complete reference to the
              resource.</li>

              <li>Relatively Unique. A JXTA ID <span class="rfc2119">must</span> refer to a single
              resource.</li>

              <li>Canonical. References to the same resource <span class="rfc2119">should</span>
              encode to the same JXTA ID. This enables JXTA IDs to be compared to determine if they
              refer to the same resource, but understandably may not be achievable by all ID
              Formats.</li>

              <li>Opaque. In their URN presentation JXTA IDs <span class="rfc2119">should</span> be
              assumed to be opaque. The context of an ID within a protocol message generally is
              sufficient to establish its type. A JXTA binding may be able to interpret an ID if it
              supports the ID Format. Generally, only the immediate participants in a JXTA protocol
              need to understand the contents of a JXTA ID, if at all.</li>
            </ul>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="ids-ujip" id=
                "ids-ujip"></a>1.3.&nbsp;Using JXTA IDs in Protocols</h2>
              </div>
            </div>
          </div>

          <p>When JXTA IDs are used within protocols they are manipulated as text string URIs.
          There are three operations available for URIs; compare, resolve, decompose. JXTA ID URIs
          are comparable for equality as strings. JXTA ID URIs can also be resolved to the resource
          they reference. Finally, JXTA ID URIs can optionally be decomposed and interpreted by
          JXTA bindings. In order to interpret a JXTA ID, a JXTA binding must support the <a href=
          "#gloss-idformat"><em class="firstterm">JXTA ID Format</em></a> used by that JXTA ID. For
          many JXTA protocols and operations it is not necessary to decompose the JXTA IDs.</p>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="ids-fjiu" id=
                "ids-fjiu"></a>1.4.&nbsp;Format of a JXTA ID URN</h2>
              </div>
            </div>
          </div>

          <p>A JXTA ID is a standard URN in the JXTA ID namespace. JXTA ID URNs are identified by
          the URN namespace identifier <code class="constant">jxta</code>. Each JXTA ID URN also
          contains a JXTA ID Format keyword. The ID Format keyword indicates how the ID was created
          and may also allow JXTA bindings to extract additional information from the ID.</p>

          <p>Two ID formats have been defined which are identified by the <code class=
          "constant">jxta</code> and <code class="constant">uuid</code> keywords. It is possible to
          define additional JXTA ID Formats in order to refer to resources both within JXTA and to
          bridge to other technologies.</p>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="ids-ejiu" id=
                "ids-ejiu"></a>1.5.&nbsp;Example JXTA ID URNs</h2>
              </div>
            </div>
          </div>

          <p>The following examples demonstrate valid JXTA ID presentation forms. These examples
          are not necessarily valid JXTA IDs.</p>

          <div class="example">
            <a name="ids-e" id="ids-e"></a>

            <p class="title"><b>Example&nbsp;1.1.&nbsp;Sample JXTA IDs</b></p>

            <div class="example-contents">
              <pre class="programlisting">
A.  urn:jxta:idform-1234567890
B.  URN:jxta:idform-1234567890
C.  urn:JXTA:idform-1234567890
D.  urn:JXTA:IDForm-1234567890
E.  urn:jxta:idform2-ABCDEFG
F.  urn:jxta:idform3-31:08:66:42:67:::91:24::73
</pre>
            </div>
          </div><br class="example-break">

          <p>In the preceding examples, A., B. and C. represent the same JXTA ID. Both the
          <code class="constant">URN</code> portion and the <code class="constant">JXTA</code> are
          case insensitive. Example D. is not equivalent to any of A., B. or C. because the data
          portion of the URN is case sensitive. In the six examples, four different JXTA ID Formats
          are used: &ldquo;<span class="quote">idform</span>&rdquo;, &ldquo;<span class=
          "quote">IDForm</span>&rdquo;, &ldquo;<span class="quote">idform2</span>&rdquo; and
          &ldquo;<span class="quote">idform3</span>&rdquo;. Definition of ID Format names that
          differ only in character case is <span class="rfc2119">not recommended</span>. The
          interpretation of the characters following the &ldquo;<span class="quote">-</span>&rdquo;
          is specific to each ID Format.</p>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="id273152" id=
                "id273152"></a>1.6.&nbsp;JXTA ID Representation</h2>
              </div>
            </div>
          </div>

          <p>JXTA IDs are presented as URNs of the <code class="constant">jxta</code> namespace.
          The JXTA ID Namespace specifies additional restrictions upon the format of the URN. These
          requriements are detailed in <a href="#ids-fjia" title=
          "Figure&nbsp;1.1.&nbsp;JXTA ID ABNF">JXTA ID ABNF</a>. The following figure uses the ABNF
          syntax as defined in &ldquo;<span class="citetitle">IETF RFC 2234</span>&rdquo; <a href=
          "#bib-RFC2234" title="Augmented BNF for Syntax Specifications: ABNF">RFC2234</a>.</p>

          <div class="figure">
            <a name="ids-fjia" id="ids-fjia"></a>

            <p class="title"><b>Figure&nbsp;1.1.&nbsp;JXTA ID ABNF</b></p>

            <div class="figure-contents">
              <pre class="programlisting">
&lt;JXTAURN&gt;    ::= "urn:" &lt;JXTANS&gt; ":" &lt;JXTAIDVAL&gt;

&lt;JXTANS&gt;     ::= "jxta"

&lt;JXTAIDVAL&gt;  ::= &lt;JXTAFMT&gt; "-" &lt;JXTAIDUNIQ&gt;

&lt;JXTAFMT&gt;    ::= 1 * &lt;URN chars&gt;

&lt;JXTAIDUNIQ&gt; ::= 1 * &lt;URN chars&gt;

&lt;URN chars&gt;  ::= &lt;trans&gt; | "%" &lt;hex&gt; &lt;hex&gt;

&lt;trans&gt;      ::= &lt;upper&gt; | &lt;lower&gt; | &lt;number&gt; | &lt;other&gt; |
                 &lt;reserved&gt;

&lt;upper&gt;      ::= "A" | "B" | "C" | "D" | "E" | "F" | "G" | "H" |
                 "I" | "J" | "K" | "L" | "M" | "N" | "O" | "P" |
                 "Q" | "R" | "S" | "T" | "U" | "V" | "W" | "X" |
                 "Y" | "Z"

&lt;lower&gt;      ::= "a" | "b" | "c" | "d" | "e" | "f" | "g" | "h" |
                 "i" | "j" | "k" | "l" | "m" | "n" | "o" | "p" |
                 "q" | "r" | "s" | "t" | "u" | "v" | "w" | "x" |
                 "y" | "z"

&lt;hex&gt;        ::= &lt;number&gt; | "A" | "B" | "C" | "D" | "E" | "F" |
                 "a" | "b" | "c" | "d" | "e" | "f"

&lt;number&gt;     ::= "0" | "1" | "2" | "3" | "4" | "5" | "6" | "7" |
                 "8" | "9"

&lt;other&gt;      ::= "(" | ")" | "+" | "," | "-" | "." |
                 ":" | "=" | "@" | ";" | "$" |
                 "_" | "!" | "*" | "'"

&lt;reserved&gt;   ::= "%" | "/" | "?" | "#"
</pre>
            </div>
          </div><br class="figure-break">

          <p>The jxta URN namespace does not currently define any special symbols from the
          <code class="constant">reserved</code> set.</p>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="ids-jif" id=
                "ids-jif"></a>1.7.&nbsp;JXTA ID Formats</h2>
              </div>
            </div>
          </div>

          <p>JXTA IDs are designed to support multiple ID Formats. ID Formats allow JXTA developers
          to utilize existing naming and ID schemes within JXTA. In the JXTA ID presentation, the
          ID's &ldquo;<span class="quote">Format</span>&rdquo; follows the JXTA URN namespace. Any
          JXTA ID Format which follows the general requirements for URNs and the <a href="#ids-jip"
          title="1.2.&nbsp;JXTA ID Properties">JXTA ID Properties</a> will be usable by conformant
          JXTA implementations.</p>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="ids-jit" id=
                "ids-jit"></a>1.8.&nbsp;JXTA ID Types</h2>
              </div>
            </div>
          </div>

          <p>JXTA IDs may refer to many types of resources; pipes, peers, etc. Each JXTA ID format
          type may support references to one or more of these resource types. Currently, five
          standard resource types have been identified; peer groups, peers, pipes, content and
          service instances. Other types may be defined.</p>

          <p>Each of the individual ID Types <span class="rfc2119">may</span> provide additional
          requirements specific to its type.</p>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="ids-jit-pgi" id="ids-jit-pgi"></a>1.8.1.&nbsp;Peer
                  Group IDs</h3>
                </div>
              </div>
            </div>

            <p>Peer Group IDs refer to peer groups. A peer group ID should canonically, uniquely
            and unambiguously refer to a peer group. Every ID Format <span class=
            "rfc2119">must</span> support this ID Type because all of the other ID Types refer to
            the peer group to which they belong. Every ID Format <span class="rfc2119">must</span>
            support encoding of the World Peer Group. Support for other peer groups is <span class=
            "rfc2119">optional</span>. Example: You are defining an ID Format for Peer IDs based
            upon driver's license number. Driver's licenses are not organized into groups. This can
            be considered equivalent to all driver's licenses belonging to the same group, the
            global &ldquo;<span class="quote">world peer group</span>&rdquo;.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="ids-jit-pei" id="ids-jit-pei"></a>1.8.2.&nbsp;Peer
                  IDs</h3>
                </div>
              </div>
            </div>

            <p>Peer IDs refer to peers. A Peer ID <span class="rfc2119">should</span> canonically,
            uniquely and anambiguously refer to a peer. Support for this ID Type is <span class=
            "rfc2119">optional</span>. If a JXTA binding recognizes the ID Format, it <span class=
            "rfc2119">should</span> be able to determine the assocaiated Peer Group ID from a Peer
            ID. This Peer Group ID identifies the peer group of which the peer is a member.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="ids-jit-ci" id="ids-jit-ci"></a>1.8.3.&nbsp;Codat
                  IDs</h3>
                </div>
              </div>
            </div>

            <p>Codat IDs refer to codats. A Codat ID <span class="rfc2119">should</span>
            canonically, uniquely and anambiguously refer to a codat. Support for this ID Type is
            <span class="rfc2119">optional</span>. If a JXTA binding recognizes the ID Format, it
            <span class="rfc2119">should</span> be able to determine the assocaiated Peer Group ID
            from a Codat ID. This Peer Group ID identifies the peer group of which the codat is a
            member.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="ids-jit-pii" id="ids-jit-pii"></a>1.8.4.&nbsp;Pipe
                  IDs</h3>
                </div>
              </div>
            </div>

            <p>Pipe IDs refer to pipes. A Pipe ID <span class="rfc2119">should</span> canonically,
            uniquely and anambiguously refer to a pipe. Support for this ID Type is <span class=
            "rfc2119">optional</span>. If a JXTA binding recognizes the ID Format, it <span class=
            "rfc2119">should</span> be able to determine the assocaiated Peer Group ID from a Pipe
            ID. This Peer Group ID identifies the peer group of which the pipe is a member.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="ids-jit-mci" id="ids-jit-mci"></a>1.8.5.&nbsp;Module
                  Class IDs</h3>
                </div>
              </div>
            </div>

            <p>A Module Class ID identifies a particular local behavior, that is, a specific API
            for each execution environment for which an implementation exists. A Module Class ID
            <span class="rfc2119">should</span> canonically, uniquely and unambiguously refer to a
            module class as defined by an advertisement. Support for this ID Type is <span class=
            "rfc2119">optional</span>. If a JXTA binding recognizes the ID Type, it should be able
            to extract a Base Class ID from a Module Class ID. The Base Class ID allows
            applications to determine if two Module Class IDs differ only in the
            &ldquo;<span class="quote">role</span>&rdquo; they perform. Module Spec ID's
            &ldquo;<span class="quote">roles</span>&rdquo; allow for the same module to be reused
            within a group and have instances distinguished. This is necessary when, for example, a
            common database service is used, with each &ldquo;<span class=
            "quote">role</span>&rdquo; accessing a different data set.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="ids-jit-msi" id="ids-jit-msi"></a>1.8.6.&nbsp;Module
                  Spec IDs</h3>
                </div>
              </div>
            </div>

            <p>A ModuleSpecID uniquely identifies a particular network behavior (wire protocol and
            choreography) that may be embodied by a Jxta Module. There may be any number of
            implementations of a given Module Spec ID. A ModuleSpecID uniquely identifies an
            abstract module for which there may be multiple platform specific implementations. A
            ModuleSpecID is used to locate a compatible implementation such that it can be
            instantiated. All such implementations are assumed to be network compatible. A Module
            Spec ID <span class="rfc2119">should</span> canonically, uniquely and unambiguously
            refer to a module specification. Support for this ID Type is <span class=
            "rfc2119">optional</span>. If a JXTA binding recognizes the ID Type, it should be able
            to extract a Module Class ID from a Module Spec ID.</p>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="ids-jinf" id=
                "ids-jinf"></a>1.9.&nbsp;JXTA ID Formats : &ldquo;<span class=
                "quote">jxta</span>&rdquo; ID Format</h2>
              </div>
            </div>
          </div>

          <p>The &ldquo;<span class="quote">jxta</span>&rdquo; ID Format is a <span class=
          "rfc2119">required</span> ID Format that is used for encoding &ldquo;<span class=
          "quote">well known</span>&rdquo; JXTA identifiers. All JXTA binding implementations
          <span class="rfc2119">must</span> support this ID Format. There are three special
          reserved JXTA IDs; the Null ID, the World Peer Group ID and the Net Peer Group ID. The
          &ldquo;<span class="quote">jxta</span>&rdquo; ID Format exists so that for these few
          &ldquo;<span class="quote">well known</span>&rdquo; IDs only a single representation
          exists.</p>

          <div class="figure">
            <a name="ids-fjifa" id="ids-fjifa"></a>

            <p class="title"><b>Figure&nbsp;1.2.&nbsp;JXTA ID : "jxta" ID Format ABNF</b></p>

            <div class="figure-contents">
              <pre class="programlisting">
&lt;JXTAJXTAURN&gt;    ::= "urn:" &lt;JXTANS&gt; ":" &lt;JXTAJXTAFMT&gt; "-"
                     &lt;JXTAJXTAFMTID&gt;

&lt;JXTAJXTAFMT&gt;    ::= "jxta"

&lt;JXTAJXTAFMTID&gt;  ::= &lt;JXTANULL&gt; | &lt;JXTAWORLDGROUP&gt; | &lt;JXTANETGROUP&gt;

&lt;JXTANULL&gt;       ::= "Null"

&lt;JXTAWORLDGROUP&gt; ::= "WorldGroup"

&lt;JXTANETGROUP&gt;   ::= "NetGroup"
</pre>
            </div>
          </div><br class="figure-break">
        </div>
      </div>

      <div class="chapter" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a name="core-advert" id=
              "core-advert"></a>Chapter&nbsp;2.&nbsp;Advertisements</h2>
            </div>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="advert-i" id=
                "advert-i"></a>2.1.&nbsp;Introduction</h2>
              </div>
            </div>
          </div>

          <p>Advertisements are meta-data documents used by JXTA protocols to describe resources.
          Advertisements are used to describe peers, peer groups, pipes, content, services and many
          other types of resources. JXTA Advertisements are presented in XML. Many of the JXTA
          protocols depend on Advertisements to provide necessary information. JXTA protocols are
          used to pass Advertisements between peers.</p>

          <p>Services can define new Advertisement types by sub-typing existing Advertisement types
          or by defining completely new Advertisements. Advertisement sub-types allow for
          additional information to be provided as well as richer meta-data.</p>

          <p>Advertisements are composed of a series of hierarchically arranged elements. The
          elements may appear in any order within the advertisement. Each element can contain its
          data or additional elements. An element can also have attributes. Attributes are
          name-value string pairs. An attribute is used to store meta-data, which helps to describe
          the data within the element.</p>

          <p>The Core JXTA Protocols rely on the following advertisements:</p>

          <div class="itemizedlist">
            <ul type="disc">
              <li><a href="#advert-pa" title="2.3.&nbsp;Peer Advertisement">Peer
              Advertisement</a></li>

              <li><a href="#advert-pga" title="2.4.&nbsp;Peer Group Advertisement">Peer Group
              Advertisement</a></li>

              <li><a href="#advert-mca" title="2.5.&nbsp;Module Class Advertisement">Module Class
              Advertisement</a></li>

              <li><a href="#advert-msa" title="2.6.&nbsp;Module Specification Advertisement">Module
              Specification Advertisement</a></li>

              <li><a href="#advert-mia" title=
              "2.7.&nbsp;Module Implementation Advertisement">Module Implementation
              Advertisement</a></li>
            </ul>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="advert-x" id=
                "advert-x"></a>2.2.&nbsp;XML and JXTA Advertisements</h2>
              </div>
            </div>
          </div>

          <p>All JXTA advertisements are represented in XML. XML provides a powerful means of
          representing data and metadata throughout a distributed system. XML provides a universal
          (software-platform neutral) representation:</p>

          <div class="itemizedlist">
            <ul type="disc">
              <li>XML is programming language agnostic</li>

              <li>XML is self-describing</li>

              <li>XML content can be strongly-typed</li>

              <li>XML ensures correct syntax</li>
            </ul>
          </div>

          <p>These advantages allow peers to manage and use Advertisements safely and to be able to
          ensure correct interactions with other peers. The Advertisements defined by the
          <em class="glossterm">JXTA Core Specification</em>and the <em class="glossterm">JXTA
          Standard Services</em>are specified using the <em class="citetitle">XML Schema Definition
          Language</em> <a href="#bib-XSD2001-1" title=
          "XML Schema Part 1: Structures">XSD2001-1</a> <a href="#bib-XSD2001-2" title=
          "XML Schema Part 2: Datatypes">XSD2001-2</a>. Use of XML Schemas allows the advertisement
          contents to be strongly type-checked and semanticly validated beyond the syntactical
          validation provided by XML with DTDs. Service and protocol authors are <span class=
          "rfc2119">recommended</span>to specify their Advertisements or Advertisement sub-types
          using XML Schema Language. DTDs are normally prepared from the schema descriptions for
          use in environments which do not support XML schema.</p>

          <p>The other powerful feature of XML is its ability to be translated into other encodings
          such as HTML and WML. This feature allows peers that do not support XML to access
          advertised resources.</p>

          <div class="figure">
            <a name="fpcafs" id="fpcafs"></a>

            <p class="title"><b>Figure&nbsp;2.1.&nbsp;Common Advertisement Fragments
            Schemas</b></p>

            <div class="figure-contents">
              <pre class="programlisting">
&lt;xs:simpleType name="<span class="type">JXTAID</span>"&gt;
 &lt;xs:restriction base="xs:anyURI"&gt;
  &lt;xs:pattern value="([uU][rR][nN]:[jJ][xX][tT][aA]:).+\-.+"/&gt;
 &lt;/xs:restriction&gt;
&lt;/xs:simpleType&gt;

&lt;xs:complexType name="<span class="type">serviceParam</span>"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element name="MCID" type="jxta:JXTAID"/&gt;
    &lt;xs:element name="Parm" type="xs:anyType"/&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;

&lt;xs:complexType name="<span class="type">Cred</span>"&gt;
  &lt;xs:all&gt;
  &lt;/xs:all&gt;
&lt;/xs:complexType&gt;
      
</pre>
            </div>
          </div><br class="figure-break">
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="advert-pa" id=
                "advert-pa"></a>2.3.&nbsp;Peer Advertisement</h2>
              </div>
            </div>
          </div>

          <p>A Peer Advertisement describes a peer and the resources it provides to the group. The
          Peer Advertisement holds specific information about the peer such as its its unique id,
          its group id and optionally its name and descriptive information. It may also contain
          endpoint addresses and any run-time attributes that individual peer services want to
          publish (such as being a rendezvous peer for a group).</p>

          <div class="figure">
            <a name="fpas" id="fpas"></a>

            <p class="title"><b>Figure&nbsp;2.2.&nbsp;Peer Advertisement Schema</b></p>

            <div class="figure-contents">
              <pre class="programlisting">
&lt;xs:element name="<code class="classname">PA</code>" type="<span class=
"type">jxta:PA</span>"/&gt;
 &lt;xs:complexType name="<span class="type">PA</span>"&gt;
  &lt;xs:sequence&gt;
   &lt;xs:element name="PID" type="JXTAID"/&gt;
   &lt;xs:element name="GID" type="JXTAID"/&gt;
   &lt;xs:element name="Name" type="xs:string" minOccurs="0"/&gt;
   &lt;xs:element name="Desc" type="xs:anyType" minOccurs="0"/&gt;
   &lt;xs:element name="Svc" type="jxta:serviceParams" minOccurs="0" maxOccurs="unbounded"/&gt;
  &lt;xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
            </div>
          </div><br class="figure-break">

          <div class="variablelist">
            <dl>
              <dt><span class="term"><code class="sgmltag-starttag">&lt;PID&gt;</code></span></dt>

              <dd>This is a required element that uniquely identifies this peer. Each peer has a
              unique id.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;GID&gt;</code></span></dt>

              <dd>This is a required element that identifies the Peer Group to which this peer
              belongs.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Name&gt;</code></span></dt>

              <dd>This is an optional string that can be associated with a peer. The name is not
              required to be unique unless the name is obtained from a centralized naming service
              that guarantees name uniqueness.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Desc&gt;</code></span></dt>

              <dd>This is an optional string that can be used to index and search for a peer. The
              string is not guaranteed to be unique. Two peers may have the same keywords. The
              keywords string may contain spaces.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Svc&gt;</code></span></dt>

              <dd>Any number of such elements may exist. Each of them describes the association
              between a group service denoted by its Class ID (the value of an MCID element), and
              arbitrary parameters encapsulated in a Parm element. For example, all accessible
              endpoint addresses are published in association with the Endpoint Service Class ID.
              The TLS Root certificate is published under the PeerGroup Class ID (There is a class
              ID for Peer Group as well). The flag that denotes that this peer is a rendezvous for
              this group is published under the Rendezvous Service Class ID. Ultimately, each
              service is responsible for what is published under its Class ID. The Service section
              may also optionally contain an element "isOff" meaning that this service is disabled.
              This element is used to convey a configuration choice made by the owner of the
              peer.</dd>
            </dl>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="advert-pga" id=
                "advert-pga"></a>2.4.&nbsp;Peer Group Advertisement</h2>
              </div>
            </div>
          </div>

          <p>A Peer Group Advertisement describes peergroup specific resources: name, group id,
          description, specification, and service parameters.</p>

          <div class="figure">
            <a name="fpgas" id="fpgas"></a>

            <p class="title"><b>Figure&nbsp;2.3.&nbsp;Peer Group Advertisement Schema</b></p>

            <div class="figure-contents">
              <pre class="programlisting">
&lt;xs:element name="<code class="classname">PGA</code>" type="<span class=
"type">jxta:PGA</span>"/&gt;

&lt;xs:complexType name="<span class="type">PGA</span>"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element name="GID" type="jxta:JXTAID"/&gt;
    &lt;xs:element name="MSID" type="jxta:JXTAID"/&gt;
    &lt;xs:element name="Name" type="xs:string" minOccurs="0"/&gt;
    &lt;xs:element name="Desc" type="xs:anyType" minOccurs="0"/&gt;
    &lt;xs:element name="Svc" type="jxta:serviceParam" minOccurs="0" maxOccurs="unbounded"/&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
            </div>
          </div><br class="figure-break">

          <div class="variablelist">
            <dl>
              <dt><span class="term"><code class="sgmltag-starttag">&lt;GID&gt;</code></span></dt>

              <dd>This element provides the Peer Group ID. The Peer Group ID is the canonical way
              of refering to a group and uniquely identifies the peer group. See <a href=
              "#ids-jit-pgi" title="1.8.1.&nbsp;Peer Group IDs">Peer Group IDs</a>for more
              information on peer group ids.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;MSID&gt;</code></span></dt>

              <dd>Peer group Specification ID. This designates the module that provides the peer
              group mechanism itself for that group. The spec ID designates an abstraction of that
              mechanism. This abstraction is optionally described by a ModuleSpecAdvertisement, and
              any number of implementations may exist, each described by a ModuleImplAdvertisement.
              These advertisements may all be searched by this SpecID.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Name&gt;</code></span></dt>

              <dd>This is an optional name that can be associated with a peergroup. The name is not
              required to be unique unless the name is obtained from a centralized naming service
              that guarantee name uniqueness.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Desc&gt;</code></span></dt>

              <dd>This is an optional element provides descriptive information that may be used to
              index and search for a peergroup. The content of this element may not be unique. For
              example, two peergroups may have the same keywords.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Svc&gt;</code></span></dt>

              <dd>Any number of such elements may exist. Each of them describes the association
              between a group service denoted by its Class ID (the value of an MCID element), and
              arbitrary parameters encapsulated in a Parm element. This optional parameter may only
              be meaningful to some services. It is used to configure a service specifically in
              relation with its use by this group. For example, a simple membership service may
              find an encrypted password list there.</dd>
            </dl>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="advert-mca" id=
                "advert-mca"></a>2.5.&nbsp;Module Class Advertisement</h2>
              </div>
            </div>
          </div>

          <p>A Module Class Advertisement describes a class of modules. That is, an expected local
          behavior and the expected API for each JXTA binding (that supports such modules). The
          purpose of this advertisement is to provide a description of what a particular Module
          Class ID stands for. A Module Class ID is what other modules or other code running on
          JXTA uses to designate modules which it depends upon. The ModuleClassAdvertisement is not
          required to provide a completely formal description of the module's behavior and API. It
          is intended for humans who want to create modules with a similar functionality. It is not
          required to publish a Module Class Advertisement for a Module Class ID to be valid,
          although it is a good practice.</p>

          <div class="figure">
            <a name="fmcas" id="fmcas"></a>

            <p class="title"><b>Figure&nbsp;2.4.&nbsp;Module Class Advertisement Schema</b></p>

            <div class="figure-contents">
              <pre class="programlisting">
&lt;xs:element name="<code class="classname">MCA</code>" type="<span class=
"type">jxta:MCA</span>"/&gt;

&lt;xs:complexType name="<span class="type">MCA</span>"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element name="MCID" type="jxta:JXTAID"/&gt;
    &lt;xs:element name="Name" type="xs:string" minOccurs="0"/?
    &lt;xs:element name="Desc" type="xs:anyType" minOccurs="0"/&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
            </div>
          </div><br class="figure-break">

          <div class="variablelist">
            <dl>
              <dt><span class="term"><code class="sgmltag-starttag">&lt;MCID&gt;</code></span></dt>

              <dd>Module Class ID. This is a required element that uniquely identifies the class.
              Each module class has a unique id. The class id representation is given in the Id
              Chapter.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Name&gt;</code></span></dt>

              <dd>This is an optional name that can be associated with a class. The name is not
              required to be unique unless the name is obtained from a centralized naming service
              that guarantee name uniqueness.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Desc&gt;</code></span></dt>

              <dd>Description. This is an optional string that can be used to describe and search
              for a class.</dd>
            </dl>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="advert-msa" id=
                "advert-msa"></a>2.6.&nbsp;Module Specification Advertisement</h2>
              </div>
            </div>
          </div>

          <p>A Module Specification Advertisement describes the specification of a module. That is,
          an expected on-wire behavior and protocol. The purpose of this advertisement is to
          provide a description of what a particular Module Specification ID stands for. A Module
          Specification ID is what other modules or other code running on JXTA uses to designate a
          particular network-compatible family of implementations of a given class. It is more
          importantly how a group implementation may designate the components which provide the
          various services that this group supports. All the built-in core peergroup services
          (discovery, membership, resolver,...) are modules.</p>

          <p>It is not required to publish a Module Spec Advertisement for a Module Spec ID to be
          valid, although it is a good practice.</p>

          <p>A Module Spec Advertisement may also describe how to invoke and use a module. A Module
          may be used through its API, by locating an implementation, loading it and starting it,
          or a module may be usable through a pipe or through a proxy module. Modules which permit
          this include one or both of a Pipe Advertisement or the Module Spec ID of a proxy module,
          in their ModuleSpecID. Publication of the Module Spec Advertisement is of course required
          in that case.</p>

          <p>A Module Specification Advertisement is not required to provide a completely formal
          description of the module's network behavior or protocol, it is intended for humans who
          want to create compatible implementation of that specification.</p>

          <div class="figure">
            <a name="fmsas" id="fmsas"></a>

            <p class="title"><b>Figure&nbsp;2.5.&nbsp;Module Specification Advertisement
            Schema</b></p>

            <div class="figure-contents">
              <pre class="programlisting">
&lt;xs:element name="<code class="classname">MSA</code>" type="<span class=
"type">jxta:MSA</span>"/&gt;

&lt;xs:complexType name="<span class="type">MSA</span>"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element name="MSID" type="jxta:JXTAID"/&gt;
    &lt;xs:element name="Vers" type="xs:string"/&gt;
    &lt;xs:element name="Name" type="xs:string" minOccurs="0"/&gt;
    &lt;xs:element name="Desc" type="xs:anyType" minOccurs="0"/&gt;
    &lt;xs:element name="Crtr" type="xs:string" minOccurs="0"/&gt;
    &lt;xs:element name="SURI" type="xs:anyURI" minOccurs="0"/&gt;
    &lt;xs:element name="Parm" type="xs:anyType" minOccurs="0"/&gt;
    &lt;xs:element ref="jxta:PipeAdvertisement" minOccurs="0"/&gt;
    &lt;xs:element name="Proxy" type="xs:anyURI" minOccurs="0"/&gt;
    &lt;xs:element name="Auth" type="jxta:JXTAID" minOccurs="0"/&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
            </div>
          </div><br class="figure-break">

          <div class="variablelist">
            <dl>
              <dt><span class="term"><code class="sgmltag-starttag">&lt;MSID&gt;</code></span></dt>

              <dd>ModuleSpecID. This is a required element that uniquely identifies the
              specification. Each module specification has a unique id. The spec id representation
              is given in the Id Chapter.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Vers&gt;</code></span></dt>

              <dd>The mandatory version of the specification that this advertises.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Name&gt;</code></span></dt>

              <dd>This is an optional name that can be associated with a spec. The name is not
              required to be unique unless the name is obtained from a centralized naming service
              that guarantee name uniqueness.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Desc&gt;</code></span></dt>

              <dd>Description. This is an optional string that can be used to describe and search
              for a spec.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;CRTR&gt;</code></span></dt>

              <dd>Creator. This optional element designates the creator of this specification.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;SURI&gt;</code></span></dt>

              <dd>Spec URI. This optional element is a URI that permits to retrieve a document
              containing the specification that this advertises.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Parm&gt;</code></span></dt>

              <dd>Arbitrary parameters to be interpreted by each implementation.</dd>

              <dt><span class="term"><code class=
              "sgmltag-starttag">&lt;jxta:PipeAdvertisement&gt;</code></span></dt>

              <dd>Pipe advertisement. A pipe advertisement which this module binds to an input pipe
              and which thus may be used to establish a pipe to a nearby running implementation of
              this specification. Note that the element name is identical to the Pipe Advertisement
              document type since the entire element is an embedded pipe advertisement
              document.</dd>

              <dt><span class="term"><code class=
              "sgmltag-starttag">&lt;Proxy&gt;</code></span></dt>

              <dd>Proxy Spec ID. Optional ModuleSpecID of a proxy module that may be used in order
              to communicate with modules of this specification. Note that the process may be
              recursive. The proxy module may be usable via pipes, or through a subsequent proxy
              module, and itself require a subsequent authenticator. However publishers of modules
              should probably avoid such designs.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Auth&gt;</code></span></dt>

              <dd>Authenticator Spec ID. Optional ModuleSpecID of an authenticator module that may
              be required in order to communicate with modules of this specification. Note that the
              process may be recursive. The authenticator module may be usable via pipes, or
              through a subsequent proxy module, and itself require a subsequent authenticator.
              However publishers of modules should probably avoid such designs.</dd>
            </dl>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="advert-mia" id=
                "advert-mia"></a>2.7.&nbsp;Module Implementation Advertisement</h2>
              </div>
            </div>
          </div>

          <p>A Module Implementation Advertisement describes one of the implementations of a module
          specification. Implementations of a given specification may be searched by the SpecID. An
          implementation may be selected by the type of environment in which it can be used (its
          compatibility statement) as well as by its name, description or the content of its
          parameters section.</p>

          <p>A Module Implementation Advertisement also provides a means to retrieve all the
          necessary data required in order to execute the implementation being described. This
          information is encapsulated in the Code and PURI elements. The interpretation of these
          elements are subject to the the module's compatibility. For example, the standard peer
          group implementation of the Java reference implementation expects the <code class=
          "sgmltag-starttag">&lt;Code&gt;</code>element to specify a fully qualified Java class
          name that designates a subclass of <code class=
          "constant">net.jxta.platform.Module</code>and PURI to be the URI of a downloadable
          package (a <code class="filename">.jar</code>file). Other execution environments could
          expect the code to be inline within the <code class=
          "sgmltag-starttag">&lt;Code&gt;</code>element or even offer several options.</p>

          <div class="figure">
            <a name="fmias" id="fmias"></a>

            <p class="title"><b>Figure&nbsp;2.6.&nbsp;Module Implementation Advertisement
            Schema</b></p>

            <div class="figure-contents">
              <pre class="programlisting">
&lt;xs:element name="<code class="classname">MIA</code>" type="<span class=
"type">jxta:MIA</span>"/&gt;

&lt;xs:complexType name="<span class="type">MIA</span>"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element name="MSID" type="jxta:JXTAID"/&gt;
    &lt;xs:element name="Comp" type="xs:anyType"/&gt;
    &lt;xs:element name="Code" type="xs:anyType"/&gt;
    &lt;xs:element name="PURI" type="xs:anyURI" minOccurs="0"/&gt;
    &lt;xs:element name="Prov" type="xs:string" minOccurs="0"/&gt;
    &lt;xs:element name="Desc" type="xs:anyType" minOccurs="0"/&gt;
    &lt;xs:element name="Parm" type="xs:anyType" minOccurs="0"/&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
            </div>
          </div><br class="figure-break">

          <div class="variablelist">
            <dl>
              <dt><span class="term"><code class="sgmltag-starttag">&lt;MSID&gt;</code></span></dt>

              <dd>ModuleSpecID. This is a required element that uniquely identifies the
              specification being implemented. The SpecID representation is given in the Id
              Chapter.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Comp&gt;</code></span></dt>

              <dd>Compatibility. A mandatory arbitrary element that describes the environment in
              with this implementation may be executed. Each framework capable of loading and
              executing module has its own requirement on the contents of this element.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Code&gt;</code></span></dt>

              <dd>This arbitrary element contains anything that is needed in addition to the
              package in order to load and execute the code of this implementation. In the case of
              a java implementation it contains the fully qualified class name containing the
              module's entry points. In other cases it may contain the entire code.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;PURI&gt;</code></span></dt>

              <dd>Package URI. This optional element is a URI that permits to retrieve a package
              containing the code of this implementation.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Prov&gt;</code></span></dt>

              <dd>Provider. The provider of that implementation.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Desc&gt;</code></span></dt>

              <dd>Description. This is an optional string that can be used to describe and search
              for a spec.</dd>

              <dt><span class="term"><code class="sgmltag-starttag">&lt;Parm&gt;</code></span></dt>

              <dd>Parameter. Arbitrary parameters to be interpreted by the implementation's
              code.</dd>
            </dl>
          </div>
        </div>
      </div>

      <div class="chapter" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a name="core-proto" id="core-proto"></a>Chapter&nbsp;3.&nbsp;JXTA
              Core Protocols</h2>
            </div>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="proto-prp" id=
                "proto-prp"></a>3.1.&nbsp;Peer Resolver Protocol</h2>
              </div>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-prp-intro" id=
                  "proto-prp-intro"></a>3.1.1.&nbsp;Introduction</h3>
                </div>
              </div>
            </div>

            <p>The <em class="glossterm"><a href="#gloss-prp" title="Peer Resolver Protocol">Peer
            Resolver Protocol</a></em> (<acronym class="acronym">PRP</acronym>) provides a generic
            query/response interface applications and services can use for building resolution
            services. The <acronym class="acronym">PRP</acronym> provides the ability to issue
            queries within a peer group and later identifying matching responses. Each query or
            response is addressed to a specific named handler. The Resolver Service of each peer
            group cooperates with the named handlers to provide the query routing strategies and
            policies. The named handlers provide the specific semantics for how the query is
            distributed and resolved within the peer group and how responses to the query are
            handled. In most situations the service or application has the best knowledge of the
            group topology and how the query should be routed. A query <span class=
            "rfc2119">may</span> be received and processed by any number of peers withinin the peer
            group, possibly all, and it is processed accordingly by a handler if such a named
            handler is registered on that peer.</p>

            <p>Peers <span class="rfc2119">may</span> also participate in the Shared Resource
            Distributed Index (<acronym class="acronym">SRDI</acronym>). <acronym class=
            "acronym">SRDI</acronym> provides a generic mechanism JXTA services and applications
            can utilize a distributed index of shared resources with other peers that are grouped
            as a set of more capable peers such as rendezvous peers. These indices can be used to
            direct queries in the direction where the query is most likely to be answered, and
            repropagate messages to peers interested in these propagated messages.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-prp-rqm" id=
                  "proto-prp-rqm"></a>3.1.2.&nbsp;Resolver Query Message</h3>
                </div>
              </div>
            </div>

            <p>The resolver query message is used to send a resolver query to the named handler on
            one or more peers that are members of the peer group. The resolver query is sent as a
            query string to a specific handler. Each query has a unique Id. The query string can be
            any string that will be interpreted by the targeted handler.</p>

            <div class="figure">
              <a name="frqs" id="frqs"></a>

              <p class="title"><b>Figure&nbsp;3.1.&nbsp;Resolver Query Schema</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;xs:element name="<code class="classname">ResolverQuery</code>" type="jxta:ResolverQuery"/&gt;

&lt;xs:complexType name="ResolverQuery"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element ref="jxta:Cred" minOccurs="0" /&gt;
    &lt;xs:element name="SrcPeerID" type="jxta:JXTAID" /&gt;
    &lt;!-- This could be extended with a pattern restriction --&gt;
    &lt;xs:element name="HandlerName" type="xs:string" /&gt;
    &lt;xs:element name="QueryID" type="xs:string" /&gt;
    &lt;xs:element name="HC" type="xs:unsignedInt" /&gt;
    &lt;!-- For historical reasons the query is a whole flattened document --&gt;
    &lt;xs:element name="Query" type="xs:anyType" /&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
              </div>
            </div><br class="figure-break">

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;jxta:Cred&gt;</code></span></dt>

                <dd>The credential of the sender.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;HandlerName&gt;</code></span></dt>

                <dd>A string that specifies the destination of this query.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;SrcPeerID&gt;</code></span></dt>

                <dd>The id of the peer originating the query (as a URN).</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;QueryID&gt;</code></span></dt>

                <dd>An opaque indentifier to be used by the querier to match replies. The
                <code class="sgmltag-starttag">&lt;QueryID&gt;</code> <span class=
                "rfc2119">should</span> be included in the responses to this query.</dd>

                <dt><span class="term"><code class="sgmltag-starttag">&lt;HC&gt;</code></span></dt>

                <dd>specifies the number of hops the query has been through The <code class=
                "sgmltag-starttag">&lt;HC&gt;</code> <span class="rfc2119">should</span> be
                incremented by each peer that fowards the query.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Query&gt;</code></span></dt>

                <dd>Contains the query.</dd>
              </dl>
            </div>

            <div class="example">
              <a name="frqe" id="frqe"></a>

              <p class="title"><b>Example&nbsp;3.1.&nbsp;Resolver Query</b></p>

              <div class="example-contents">
                <pre class="programlisting">
&lt;?xml version="1.0"?&gt;

&lt;!DOCTYPE jxta:ResolverQuery&gt;

&lt;jxta:ResolverQuery xmlns:jxta="http://jxta.org"&gt;
    &lt;HandlerName&gt;
        urn:jxta:uuid-DEADBEEFDEAFBABAFEEDBABE0000000305
    &lt;/HandlerName&gt;
    &lt;jxta:Cred&gt;
        JXTACRED
    &lt;/jxta:Cred&gt;
    &lt;QueryID&gt;
        0
    &lt;/QueryID&gt;
    &lt;HC&gt;
        0
    &lt;/HC&gt;
    &lt;SrcPeerID&gt;
        urn:jxta:uuid-59616261646162614A7874615032503304BD268FA4764960AB93A53D7F15044503
    &lt;/SrcPeerID&gt;
    &lt;Query&gt;
        &amp;lt;?xml version="1.0"?&gt;

        &amp;lt;!DOCTYPE jxta:DiscoveryQuery&gt;

        &amp;lt;jxta:DiscoveryQuery xmlns:jxta="http://jxta.org"&gt;
            &amp;lt;Type&gt;
                0
            &amp;lt;/Type&gt;
            &amp;lt;Threshold&gt;
                50
            &amp;lt;/Threshold&gt;
            &amp;lt;PeerAdv&gt;
                &amp;lt;?xml version="1.0"?&gt;

                &amp;lt;!DOCTYPE jxta:PA&gt;
                    <span class="emphasis"><em>... remainder omitted for brevity ...</em></span>
                &amp;lt;/jxta:PA&gt;
            &amp;lt;/PeerAdv&gt;
            &amp;lt;Attr&gt;
            &amp;lt;/Attr&gt;
            &amp;lt;Value&gt;
            &amp;lt;/Value&gt;
        &amp;lt;/jxta:DiscoveryQuery&gt;
    &lt;/Query&gt;
&lt;/jxta:ResolverQuery&gt;
</pre>
              </div>
            </div><br class="example-break">
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-prp-rrm" id=
                  "proto-prp-rrm"></a>3.1.3.&nbsp;Resolver Response Message</h3>
                </div>
              </div>
            </div>

            <p>A resolver response message is used to send a response to a resolver query
            message.</p>

            <div class="figure">
              <a name="frrs" id="frrs"></a>

              <p class="title"><b>Figure&nbsp;3.2.&nbsp;Resolver Response Schema</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;xs:element name="<code class="classname">ResolverResponse</code>" type="ResolverResponse"/&gt;

&lt;xs:complexType name="ResolverResponse"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element ref="jxta:Cred" minOccurs="0"/&gt;
    &lt;xs:element name="ResPeerID" type="jxta:JXTAID" minOccurs="0" /&gt;
    &lt;xs:element name="HandlerName" type="xs:string"/&gt;
    &lt;xs:element name="QueryID" type="xs:string"/&gt;
    &lt;!-- For historical reasons the response is a whole flattened document --&gt;
    &lt;xs:element name="Response" type="xs:anyType"/&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
              </div>
            </div><br class="figure-break">

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;jxta:Cred&gt;</code></span></dt>

                <dd>The credential of the respondent.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;HandlerName&gt;</code></span></dt>

                <dd>Specifies how to handle the response.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;ResPeerID&gt;</code></span></dt>

                <dd>The id of the peer originating the response (as a URN).</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;QueryID&gt;</code></span></dt>

                <dd>The query identifier of the query to which this is a response.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Response&gt;</code></span></dt>

                <dd>The responses.</dd>
              </dl>
            </div>

            <div class="example">
              <a name="frre" id="frre"></a>

              <p class="title"><b>Example&nbsp;3.2.&nbsp;Resolver Response</b></p>

              <div class="example-contents">
                <pre class="programlisting">
&lt;?xml version="1.0"?&gt;

&lt;!DOCTYPE jxta:ResolverResponse&gt;

&lt;jxta:ResolverResponse xmlns:jxta="http://jxta.org"&gt;
    &lt;HandlerName&gt;
        urn:jxta:uuid-DEADBEEFDEAFBABAFEEDBABE0000000305
    &lt;/HandlerName&gt;
    &lt;jxta:Cred&gt;
        JXTACRED
    &lt;/jxta:Cred&gt;
    &lt;QueryID&gt;
        0
    &lt;/QueryID&gt;
    &lt;ResPeerID&gt;
        urn:jxta:uuid-59616261646162614A7874615032503304BD268FA4764960AB93A53D7F15044503
    &lt;/ResPeerID&gt;
    &lt;Response&gt;
        &amp;lt;?xml version="1.0"?&gt;

        &amp;lt;!DOCTYPE jxta:DiscoveryResponse&gt;

        &amp;lt;jxta:DiscoveryResponse xmlns:jxta="http://jxta.org"&gt;
            &amp;lt;Count&gt;
                1
            &amp;lt;/Count&gt;
            &amp;lt;Type&gt;
                2
            &amp;lt;/Type&gt;
            &amp;lt;PeerAdv&gt;
                &amp;amp;lt;?xml version="1.0"?&gt;

                &amp;amp;lt;!DOCTYPE jxta:PA&gt;

                &amp;amp;lt;jxta:PA xmlns:jxta="http://jxta.org"&gt;
                    <span class="emphasis"><em>... remainder omitted for brevity ...</em></span>
                &amp;amp;lt;/jxta:PA&gt;
            &amp;lt;/PeerAdv&gt;
            &amp;lt;Response Expiration="7200000"&gt;
                &amp;amp;lt;?xml version="1.0"?&gt;

                &amp;amp;lt;!DOCTYPE jxta:PipeAdvertisement&gt;

                &amp;amp;lt;jxta:PipeAdvertisement xmlns:jxta="http://jxta.org"&gt;
                    &amp;amp;lt;Id&gt;
                        urn:jxta:uuid-59616261646162614E50472050325033D1D1D1D1D1D1D1D1D1D1D1D1D1D1D1D104
                    &amp;amp;lt;/Id&gt;
                    &amp;amp;lt;Type&gt;
                        JxtaPropagate
                    &amp;amp;lt;/Type&gt;
                    &amp;amp;lt;Name&gt;
                        JxtaTalkUserName.IP2PGRP
                    &amp;amp;lt;/Name&gt;
                &amp;amp;lt;/jxta:PipeAdvertisement&gt;
            &amp;lt;/Response&gt;
        &amp;lt;/jxta:DiscoveryResponse&gt;
    &lt;/Response&gt;
&lt;/jxta:ResolverResponse&gt;
</pre>
              </div>
            </div><br class="example-break">
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-prp-rsm" id=
                  "proto-prp-rsm"></a>3.1.4.&nbsp;Resolver SRDI Message</h3>
                </div>
              </div>
            </div>

            <p>The resolver SRDI message is used to send a resolver <acronym class=
            "acronym">SRDI</acronym> message to the named handler on one or more peers that are
            members of the peer group. The resolver <acronym class="acronym">SRDI</acronym> message
            is sent to a specific handler. The payload string may be any string that will be
            interpreted by the targeted handler.</p>

            <div class="figure">
              <a name="frsrdis" id="frsrdis"></a>

              <p class="title"><b>Figure&nbsp;3.3.&nbsp;Resolver SRDI Schema</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;xs:element name="<code class="classname">ResolverSRDI</code>" type="jxta:ResolverSRDI"/&gt;

&lt;xs:complexType name="ResolverSRDI"&gt;
  &lt;xs:all&gt;
    &lt;xs:element name="HandlerName" type="xs:string"/&gt;
    &lt;xs:element ref="jxta:Cred" minOccurs="0"/&gt;
    &lt;xs:element name="Payload" type="xs:anyType"/&gt;
  &lt;/xs:all&gt;
&lt;/xs:complexType&gt;
</pre>
              </div>
            </div><br class="figure-break">

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;HandlerName&gt;</code></span></dt>

                <dd>A string that specifies the destination of this message.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;jxta:Cred&gt;</code></span></dt>

                <dd>The credential of the sender.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Payload&gt;</code></span></dt>

                <dd>Contains the payload.</dd>
              </dl>
            </div>

            <div class="example">
              <a name="frsrdie" id="frsrdie"></a>

              <p class="title"><b>Example&nbsp;3.3.&nbsp;Resolver SRDI</b></p>

              <div class="example-contents">
                <pre class="programlisting">
&lt;?xml version="1.0"?&gt;

&lt;!DOCTYPE jxta:ResolverSRDI&gt;

&lt;jxta:ResolverSRDI xmlns:jxta="http://jxta.org"&gt;
    &lt;HandlerName&gt;
        urn:jxta:uuid-DEADBEEFDEAFBABAFEEDBABE0000000305
    &lt;/HandlerName&gt;
    &lt;jxta:Cred&gt;
        JXTACRED
    &lt;/jxta:Cred&gt;
    &lt;Payload&gt;
        &amp;lt;?xml version="1.0"?&gt;

        &amp;lt;!DOCTYPE jxta:GenSRDI&gt;
                    <span class="emphasis"><em>... remainder omitted for brevity ...</em></span>
        &amp;lt;/jxta:GenSRDI&gt;
    &lt;/Payload&gt;
&lt;/jxta:ResolverSRDI&gt;
</pre>
              </div>
            </div><br class="example-break">
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="id277191" id="id277191"></a>3.1.5.&nbsp;Listener and
                  Element Naming</h3>
                </div>
              </div>
            </div>

            <p>The <acronym class="acronym">PRP</acronym> communicates by exchanging Messages using
            the Endpoint Service. Endpoint Addresses specify a handler name. The <acronym class=
            "acronym">PRP</acronym> attaches a listener by that name to the <a href="#trans-endpt"
            title="4.1.&nbsp;Endpoint Service">Endpoint Service</a>.</p>

            <p>All <acronym class="acronym">PRP</acronym> implementations <span class=
            "rfc2119">must</span> use the same scheme for building their handler names. The
            convention used by all services of the world peer group is to use the concatenation of
            the service name, the peer group ID, and a value unique within the service.</p>

            <div class="figure">
              <a name="flnsa" id="flnsa"></a>

              <p class="title"><b>Figure&nbsp;3.4.&nbsp;Listener Naming Syntax ABNF</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;JXTARSLVRRSQRY&gt;   ::= &lt;JXTARSLVRNAM&gt; &lt;JXTAIDVAL&gt; &lt;JXTARSLVRQRYTAG&gt;

&lt;JXTARSLVRRSRSP&gt;   ::= &lt;JXTARSLVRNAM&gt; &lt;JXTAIDVAL&gt; &lt;JXTARSLVRRSPTAG&gt;

&lt;JXTARSLVRRSSRDI&gt;  ::= &lt;JXTARSLVRNAM&gt; &lt;JXTAIDVAL&gt; &lt;JXTARSLVRSRDITAG&gt;

&lt;JXTARSLVRQRYTAG&gt;  ::= "ORes"

&lt;JXTARSLVRRSPTAG&gt;  ::= "IRes"

&lt;JXTARSLVRSRDITAG&gt; ::= "Isrdi"

&lt;JXTARSLVRNAM&gt;     ::= "jxta.service.resolver"

&lt;JXTAIDVAL&gt;        ::= <span class="emphasis"><em>See <a href="#ids-fjia" title=
"Figure&nbsp;1.1.&nbsp;JXTA ID ABNF">JXTA ID ABNF</a></em></span>
</pre>
              </div>
            </div><br class="figure-break">

            <p>The listeners used by the <acronym class="acronym">PRP</acronym> are named as
            follows:</p>

            <div class="variablelist">
              <dl>
                <dt><span class="term">Queries</span></dt>

                <dd>jxta.service.resolver[group unique Id string]ORes (<span class=
                "emphasis"><em>ORes</em></span> is a literal string)</dd>

                <dt><span class="term">Responses</span></dt>

                <dd>jxta.service.resolver[group unique Id string]IRes (<span class=
                "emphasis"><em>IRes</em></span>is a literal string)</dd>

                <dt><span class="term">Srdi</span></dt>

                <dd>jxta.service.resolver[group unique Id string]Isrdi (<span class=
                "emphasis"><em>Isrdi</em></span> is a literal string)</dd>
              </dl>
            </div>

            <p>Query and response messages are included in messages as elements named as
            follows:</p>

            <div class="itemizedlist">
              <ul type="disc">
                <li><span class="emphasis"><em>Queries</em></span>: [group unique Id string]ORes
                (<span class="emphasis"><em>ORes</em></span> is a literal string)</li>

                <li><span class="emphasis"><em>Responses</em></span>: [group unique Id string]IRes
                (<span class="emphasis"><em>IRes</em></span> is a literal string)</li>

                <li><span class="emphasis"><em>Srdi</em></span>: [group unique Id string]Isrdi
                (<span class="emphasis"><em>Isrdi</em></span> is a literal string)</li>
              </ul>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="id277355" id="id277355"></a>3.1.6.&nbsp;Behaviour</h3>
                </div>
              </div>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id277360" id="id277360"></a>3.1.6.1.&nbsp;Handler
                    Name</h4>
                  </div>
                </div>
              </div>

              <p>The Handler Name in <acronym class="acronym">PRP</acronym> messages plays a role
              similar to that of the handler name in the Endpoint Message addresses: it is a
              demultiplexing key that specifies how, by which higher-level protocol, or by which
              module, the message is to be processed.</p>

              <p>In the Java and &ldquo;<span class="quote">C</span>&rdquo; reference
              implementations, the users of the <acronym class="acronym">PRP</acronym> are
              typically services. Each instance of a given service (one per peer per group that
              uses this service) generates a handler name that is unique on its peer, but will be
              identical for the instances of this service on other peers. This is by convention
              achieved by concatenating the service name (which is unique in the group), the group
              id, which is unique in the peer, and a additional parameter which serves to
              discriminate between several handlers used by the same service, if needed.</p>

              <p>The handler name is used both to register the appropriate handler for incoming
              queries or responses, and as a destination for outgoing queries or responses. For
              convenience, most clients of the resolver do define two names: one for propagated
              messages (mostly queries), and one for unicast messages (mostly responses).</p>

              <p>The <acronym class="acronym">PRP</acronym> typically uses the Rendezvous Service
              to disseminate a query to multiple peers or unicast messages to send queries to
              specified peers.</p>

              <p>The <acronym class="acronym">PRP</acronym> <span class="rfc2119">should</span>
              refuse, and the existing reference implementations <span class="rfc2119">shall</span>
              refuse the registration of more than one handler with the same name. A service
              <span class="rfc2119">should</span> register for any handler name that it uses as a
              destination, thereby preventing other services from registering themselves to receive
              these messages. This means that in principle a service or application that receives
              queries or responses from a service instance on another peer is de-facto the local
              instance of that service and <span class="rfc2119">should</span> handle these
              messages as specified. <acronym class="acronym">PRP</acronym> is designed for
              same-to-same communication, not client-server.</p>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id277442" id="id277442"></a>3.1.6.2.&nbsp;Policies
                    and Quality of Service</h4>
                  </div>
                </div>
              </div>

              <p>The <acronym class="acronym">PRP</acronym> does not guarantee peers that define a
              query handler name will receive that query, nor does it mandate that all peers that
              define this handler name will receive it. Only a best effort is made at disseminating
              the query in a way that maximizes the chance of obtaining a response, if one can be
              obtained.</p>

              <p>There is no guarantee that a response to a resolver query request will be made. It
              is important to point that response to a ResolverQuery request is <span class=
              "rfc2119">optional</span>. A peer is not required to respond.</p>

              <p>There is no guarantee that a Resolver SRDI Message will be honored. It is
              important to point out that accepting a Resolver SRDI Message is <span class=
              "rfc2119">optional</span>. A peer is not required to accept the message.</p>

              <p>The <acronym class="acronym">PRP</acronym> does not assume the presence of
              reliable message delivery. Multiple Resolver query messages may be sent--none, one,
              multiple or redundant responses may be received.</p>

              <p>The <acronym class="acronym">PRP</acronym> provides a generic mechanism for
              services to send queries, and receive responses and SRDI messages. As a service, the
              reference implementation helps other services by taking care of all messaging
              aspects, caching queries responses, and SRDI messages and in forwarding queries,
              based on the invoker's decision. The <acronym class="acronym">PRP</acronym> performs
              authentication, and verification of credentials and drops incorrect messages.</p>

              <p>The actual task of propagating a query to the next set of peers is delegated to
              the <a href="#proto-rvp" title="1.2.&nbsp;Rendezvous Protocol">Rendezvous
              Protocol</a>. The Rendezvous service is responsible for determining the set of peers
              that should receive a message being propagated, but never automatically re-propagates
              an incoming propagated message. It is left to the service (query handler) handling
              the message to determine if further propogation should be performed. The
              <acronym class="acronym">PRP</acronym>'s policy is the following: if the query
              handler does not instruct the <acronym class="acronym">PRP</acronym> to discard the
              query, and if the local peer is a rendezvous, then the query is re-propagated (within
              the limits of loop and <acronym class="acronym">TTL</acronym> rules enforced by the
              Rendezvous service). In addition, if instructed by the query handler, an identical
              query may be issued with the local peer as the originator.</p>
            </div>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="proto-erp" id=
                "proto-erp"></a>3.2.&nbsp;Endpoint Routing Protocol</h2>
              </div>
            </div>
          </div>

          <p>The JXTA network is ad hoc, multi-hop, and adaptive by nature. Connections in the
          network may be transient, and message routing is nondeterministic. Routes <span class=
          "rfc2119">may</span> be unidirectional and change rapidly. Peers <span class=
          "rfc2119">may</span> join and leave frequently. A peer inside a firewall can send a
          message directly to a peer outside a firewall. But a peer outside the firewall cannot
          establish a connection directly with a peer inside the firewall.</p>

          <p>The Endpoint Routing Protocol (<acronym class="acronym">ERP</acronym>) defines a set
          of request/query messages that are processed by a routing service to help a peer route
          messages to their destination.</p>

          <p>When a peer is asked to send a message to a given peer endpoint address, it looks in
          its local cache to see if it has a route to this peer. If it does not find a route, it
          sends a route resolver query message to its available peer routers asking for routing
          information. A peer can have as many peer routers as it can find or they can be
          pre-configured. Pre-configured routers are <span class="rfc2119">optional</span>.</p>

          <p>The peer routers provide the low-level infrastructure to route messages between two
          peers in the network. Any number of peers in a peergroup can elect themselves to become
          peer routers for other peers. Peers routers offer the ability to cache route information,
          as well as bridging different physical or logical networks. A peer can dynamically find
          its router peer via a qualified discovery search. A peer can find out if a peer it has
          discovered is a peer router via the peer advertisement <code class=
          "sgmltag-starttag">&lt;Parms&gt;</code> element.</p>

          <p>When a peer router receives a route query, if it knows a route to the destination, it
          answers the query by returning the route information as an enumeration of hops. Once a
          route has been discovered, a message can be sent to the first router and that router will
          use the route information to route the message to the destination peer. The route is
          ordered from the next hop to the final destination peer. At any point the routing
          information <span class="rfc2119">may</span> become obsolete requiring the current router
          to discover a new route in order to complete the message delivery.</p>

          <p>The peer endpoint adds extra routing information to the messages sent by a peer. When
          a message goes through a peer, the endpoint of that peers leaves its trace on the
          message. The trace can be used for loop detection, and to discard recurrent messages. The
          trace is also used to record new route information by peer routers.</p>

          <p>ERP provides last resort routing for a peer. More intelligent routing can be
          implemented by more sophisticated routing services in place of the core routing service.
          High-level routing services can manage and optimize routes more efficiently than the core
          service. JXTA intends is to provide the hooks necessary for user defined routing services
          to manipulate and update the route table information (route advertisements) used by the
          peer router. The intent is to have complex route analysis and discovery be performed
          above the core by high-level routing services, and have those routing services provide
          intelligent hints to the peer router to route messages.</p>

          <p>The Endpoint Routing Protocol is used to find the available routes to send a message
          to a destination peer. This is accomplished through message exchanges between peer
          routers. Peer routing may be necessary to enable two peers to communicate depending on
          their location in the network. For instance, the two peers may be on different
          transports; the peers may be separated by a firewall; or may be using incompatible
          private IP address spaces. When necessary one or more peer routers can be used to deliver
          a message from the originating peer endpoint to the destination peer endpoint.</p>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-erp-epa" id=
                  "proto-erp-epa"></a>3.2.1.&nbsp;Endpoint Addresses</h3>
                </div>
              </div>
            </div>

            <p>JXTA Endpoints are identified using URIs known as Endpoint Addresses. Endpoint
            Addresses can describe both physical network locations and virtual addresses for peers
            and groups.</p>

            <div class="figure">
              <a name="id277644" id="id277644"></a>

              <p class="title"><b>Figure&nbsp;3.5.&nbsp;Endpoint Address URI ABNF</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;ENDPOINTADDRESS&gt;  ::= (&lt;URISCHEME&gt; &lt;PROTOCOLADDR&gt; 0*1("/" &lt;RECIPIENT&gt; "/" 0*1(&lt;RECIPIENTPARAM&gt;))) |
                       (&lt;URNSCHEME&gt; &lt;PROTOCOLADDR&gt; 0*1("#" &lt;RECIPIENT&gt; "/" 0*1(&lt;RECIPIENTPARAM&gt;)))

&lt;PROTOCOL&gt;         ::= &lt;URISCHEME&gt; | &lt;URNSCHEME&gt;

&lt;URISCHEME         ::= 1 (&lt;upper&gt; | &lt;lower&gt;) 0* &lt;URICHARS&gt; &lt;SCHEMESEP&gt;

&lt;SCHEMESEP&gt;        ::= ":" | "://"

&lt;URNSCHEME         ::= "urn:" 1 (&lt;upper&gt; | &lt;lower&gt;) 0* &lt;URICHARS&gt; ":"

&lt;URICHARS&gt;         ::= &lt;upper&gt; | &lt;lower&gt; | &lt;number&gt; | "%" &lt;hex&gt; &lt;hex&gt;

&lt;PROTOCOLADDR&gt;     ::= 0* (&lt;URICHARS&gt; |  &lt;other&gt;)

&lt;RECIPIENT&gt;        ::= 0* (&lt;URICHARS&gt; |  &lt;other&gt;)

&lt;RECIPIENTPARAM&gt;   ::= 0* &lt;URN chars&gt;

<span class="emphasis"><em>see <a href="#ids-fjia" title=
"Figure&nbsp;1.1.&nbsp;JXTA ID ABNF">JXTA ID ABNF</a> for definition of some terms.</em></span>
</pre>
              </div>
            </div><br class="figure-break">

            <div class="example">
              <a name="id277672" id="id277672"></a>

              <p class="title"><b>Example&nbsp;3.4.&nbsp;Endpoint Address URI Examples</b></p>

              <div class="example-contents">
                <pre class="programlisting">
http://192.168.0.11:9700/endpoint/resolver

urn:jxta:uuid-59616261646162614E50472050325033D1D1D1D1D1D1D1D1D1D1D1D1D1D1D1D104?pipeService

urn:jxta:jxta-NetGroup?relay/uuid-59616261646162614A7874615032503369D1041721754AD18D7D9137C06F77DD03
</pre>
              </div>
            </div><br class="example-break">

            <p>The Endpoint Service delegates the sending of outgoing messages to the endpoint
            protocol designated by the &lt;PROTOCOL&gt; part of the message's destination
            address.</p>

            <p>The Endpoint Service delivers incoming messages to the listener registered under the
            name that matches in order of preference :</p>

            <div class="itemizedlist">
              <ul type="disc">
                <li>
                  <p>The <code class="varname">&lt;RECIPIENT&gt;</code> and <code class=
                  "varname">&lt;RECIPIENTPARAM&gt;</code> seperated by a <code class=
                  "constant">/</code>.</p>
                </li>

                <li>
                  <p>The <code class="varname">&lt;RECIPIENT&gt;</code>.</p>
                </li>
              </ul>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-erp-ri" id="proto-erp-ri"></a>3.2.2.&nbsp;Route
                  information</h3>
                </div>
              </div>
            </div>

            <p>Route information is represented as follow:</p>

            <div class="figure">
              <a name="feprra" id="feprra"></a>

              <p class="title"><b>Figure&nbsp;3.6.&nbsp;Route Advertisement</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;xs:element name="<code class="classname">APA</code>" type="jxta:APA"/&gt;

&lt;xs:complexType name ="jxta:APA"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element name="PID" minOccurs="0" type="jxta:JXTAID"/&gt;
    &lt;xs:element name="EA" type="xs:anyURI" minOccurs="0" maxOccurs="unbounded"/&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;

&lt;xs:element name="<code class="classname">RA</code>" type="jxta:RA"/&gt;

&lt;xs:complexType name ="jxta:RA"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element name="DstPID" minOccurs="0" type="jxta:JXTAID"/&gt;
    &lt;xs:element name="Dst"&gt;
      &lt;xs:sequence&gt;
        &lt;xs:element ref="jxta:APA" maxOccurs="1"/&gt;
      &lt;/xs:sequence&gt;
    &lt;/xs:element&gt;
    &lt;xs:element name="Hops" minOccurs="0"&gt;
      &lt;xs:sequence&gt;
        &lt;xs:element ref="jxta:APA" maxOccurs="unbounded"/&gt;
      &lt;/xs:sequence&gt;
    &lt;/xs:element&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
              </div>
            </div><br class="figure-break">

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;PID&gt;</code></span></dt>

                <dd>The Peer ID of the peer described by this advertisement. When not included the
                advertisement is used in a context where the Peer ID is already known, such as in
                the <code class="sgmltag-starttag">&lt;Dst&gt;</code> element of a Route
                Advertisement.</dd>

                <dt><span class="term"><code class="sgmltag-starttag">&lt;EA&gt;</code></span></dt>

                <dd>An Endpoint Address for the peer.</dd>
              </dl>
            </div>

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;DstPID&gt;</code></span></dt>

                <dd>The Peer ID of the peer described by this advertisement. When not included the
                advertisement is used in a context where the Peer ID is already known, such as in a
                Peer Advertisement.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Dst&gt;</code></span></dt>

                <dd>Contains an Access Point Advertisement containing a list of endpoint addresses
                associated with the specified peer id.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Hops&gt;</code></span></dt>

                <dd>A semi-ordered collection of Access Point Advertisements describing a route to
                the peer indicated by <code class="sgmltag-starttag">&lt;DstPID&gt;</code>. The
                individual steps of the route are co-mingled with routing alternatives. As the
                route is traversed peers route messages by forwarding to the earliest peer in the
                list that they can reach.</dd>
              </dl>
            </div>

            <p>The time-to-live parameter is measured in hops and specifies how long this route is
            valid. The creator of the route can decide how long this route will be valid. The
            gateways are defined as an ordered sequence of peer IDs which define the route from the
            source peer to the destination peer. The sequence may not be complete, but at least the
            first gateway <span class="rfc2119">should</span> be present. The first gateway is
            sufficient to initially route the messages. The remaining gateway sequence is
            <span class="rfc2119">optional</span>.</p>

            <p>Peer routers will typically cache route information. Any peer can query a peer
            router for route information. Any peer in a peer group <span class="rfc2119">may</span>
            become a peer router.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-erp-rqm" id=
                  "proto-erp-rqm"></a>3.2.3.&nbsp;Route Query Message</h3>
                </div>
              </div>
            </div>

            <p>This message is sent by peers to request route information for another peer. Route
            Query Messages are transmitted as queries within <a href="#proto-prp-rqm" title=
            "3.1.2.&nbsp;Resolver Query Message">Resolver Query Message</a>.</p>

            <div class="figure">
              <a name="feprq" id="feprq"></a>

              <p class="title"><b>Figure&nbsp;3.7.&nbsp;Endpoint Router Query</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;xs:element name="<code class="classname">ERQ</code>" type="jxta:ERQ"/&gt;

&lt;xs:complexType name ="jxta:ERQ"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element name="Dst" type="jxta:JXTAID"/&gt;
    &lt;xs:element name="Src"&gt;
      &lt;xs:element ref="jxta:RA"/&gt;
    &lt;/xs:element&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
              </div>
            </div><br class="figure-break">

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Dst&gt;</code></span></dt>

                <dd>The peer id of the peer who's route is desired.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Src&gt;</code></span></dt>

                <dd>Route advertiement of the peer requesting route information. This route
                information is needed to ensure there is a return route for responses.</dd>
              </dl>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-erp-rrm" id=
                  "proto-erp-rrm"></a>3.2.4.&nbsp;Route Response Message</h3>
                </div>
              </div>
            </div>

            <p>This message is sent by peers in response to Route Query Messages. The Route
            Response Message contains a route advertisement for the destination peer. Route
            Response Messages are transmitted as responses within <a href="#proto-prp-rrm" title=
            "3.1.3.&nbsp;Resolver Response Message">Resolver Response Message</a>.</p>

            <div class="figure">
              <a name="feprrm" id="feprrm"></a>

              <p class="title"><b>Figure&nbsp;3.8.&nbsp;Endpoint Router Response Message</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;xs:element name="<code class="classname">ERR</code>" type="jxta:ERR"/&gt;

&lt;xs:complexType name ="jxta:ERR"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element name="Dst"&gt;
      &lt;xs:element ref="jxta:RA"/&gt;
    &lt;/xs:element&gt;
    &lt;xs:element name="Src"&gt;
      &lt;xs:element ref="jxta:RA"/&gt;
    &lt;/xs:element&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
              </div>
            </div><br class="figure-break">

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Dst&gt;</code></span></dt>

                <dd>The Route Advertisement for the peer which was requested in the Endpoint Router
                Query.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Src&gt;</code></span></dt>

                <dd>Route Advertiement for the destination peer.</dd>
              </dl>
            </div>
          </div>
        </div>
      </div>

      <div class="chapter" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a name="core-trans" id="core-trans"></a>Chapter&nbsp;4.&nbsp;Core
              JXTA Message Transport Bindings</h2>
            </div>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="trans-endpt" id=
                "trans-endpt"></a>4.1.&nbsp;Endpoint Service</h2>
              </div>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="trans-endpt-desc" id=
                  "trans-endpt-desc"></a>4.1.1.&nbsp;Description</h3>
                </div>
              </div>
            </div>

            <p>The Endpoint Service is responsible for performing end-to-end messaging between two
            JXTA peers, using one of the underlying JXTA transport protocols, such as the JXTA TCP
            or HTTP bindings.</p>

            <p>The Endpoint Service is primarily used by other services or applications that need
            to have an understanding of the network topology, such as the Resolver Service or the
            Propagation Service.</p>

            <p>The Endpoint Service is not responsible for routing messages for peers that are not
            directly connected to each other. This task is performed by the <a href="#trans-router"
            title="4.2.&nbsp;Endpoint Router Transport Protocol">Endpoint Router Transport
            Protocol</a>which provides the illusion that the source and destination peers are
            directly connected.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="trans-endpt-protocol" id=
                  "trans-endpt-protocol"></a>4.1.2.&nbsp;Protocol</h3>
                </div>
              </div>
            </div>

            <p>When the Endpoint Service transmits a message it <span class="rfc2119">may</span>
            add a single element to the message: the source peer ID.</p>

            <p>The element name is: <code class="constant">jxta:EndpointHeaderSrcPeer</code>and its
            value is a textual UTF-8 representation of the peer ID at the point of emission of the
            message. This information is optional and is used by the emitter endpoint service
            itself to detect and eliminate progagated messages that loop back to the emitter.</p>

            <p>If this element is not present the message is assumed to not be looping back.</p>

            <p>The endpoint service expects incoming and outgoing messages to have a source address
            and a destination address. The encapsulation of that information is specified by the
            message wire format being used.</p>

            <p>Two additional common elements are optionally used by Message Transports in
            conjunction with the Endpoint Service. Message Transports <span class=
            "rfc2119">may</span> typically provide received messages to the Endpoint Service
            containing these elements and the Endpoint service will dispatch the messages based
            upon their content. Message Transports <span class="rfc2119">may</span> use alternate
            mechanisms for determining message source and destination addresses and need not use
            these elements.</p>

            <p>The <code class="constant">jxta:EndpointSourceAddress</code> contains an Endpoint
            Address for the source of this message. The source address has a variety of meanings
            based upon the usage of the underlying Message Transport. For low level transports such
            as <acronym class="acronym">TCP</acronym> or <acronym class="acronym">HTTP</acronym>
            the source address is the return address of the peer from which the message was
            received, ie. the hop address. For higher level Message Transports such as the Endpoint
            Router Transport or the <acronym class="acronym">TLS</acronym> transport the source
            addresss is the virtual Endpoint Address of the peer which originated the message
            regardless of any intervening hops the message may have made.</p>

            <p>The <code class="constant">jxta:EndpointDestinationAddress</code> contains an
            Endpoint Address which will be used by the Endpoint Service to dispatch a received
            message to the recipient specified by the service name and service parameter. The
            protocol address is also provided to the recipient service and can be used in some
            protocols for determining how the message was received. For example a service may wish
            to handle messages which were sent directly differently than messages which were sent
            via propagation.</p>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="trans-router" id=
                "trans-router"></a>4.2.&nbsp;Endpoint Router Transport Protocol</h2>
              </div>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="trans-router-descr" id=
                  "trans-router-descr"></a>4.2.1.&nbsp;Description</h3>
                </div>
              </div>
            </div>

            <p>The Endpoint Router is a logical JXTA Transport Protocol that sits below the
            Endpoint Service and beside the other Transport Protocols such as the JXTA TCP and HTTP
            Transport Protocols.</p>

            <p>The Endpoint Router is responsible for exchanging messages between peers that do not
            have a direct connection between each other. The Endpoint Router provides a virtual
            direct connection to the peer's Endpoint Service.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="trans-router-proto" id=
                  "trans-router-proto"></a>4.2.2.&nbsp;Protocol</h3>
                </div>
              </div>
            </div>

            <p>The Endpoint Router protocol defines a set of queries and responses used to
            communicate with instances of the Endpoint Router on other peers.</p>

            <div class="itemizedlist">
              <ul type="disc">
                <li>Route Query: when the Endpoint Router is requested to send a message to a peer
                for which it does not have yet a route for, it sends a Route Query request to other
                peers. Peers that have an route for the given peer answers with Route
                Response.</li>

                <li>Route Response: a peer that desires inform another peer about a give route
                sends a Route Response to the peer. A Route Response is replied following up a
                Route Query.</li>
              </ul>
            </div>

            <p>In addition, the Endpoint Router defines an informational message that requires no
            reply.</p>

            <div class="itemizedlist">
              <ul type="disc">
                <li>NACK: a NACK is sent by any peer that detects that a route used by another peer
                is not valid. Typically, this happens by a router peer that are requested to route
                a message to peer for which it does not have a route itself. NACK messages are
                optional: routers are not required to send them, and while a NACK is typically sent
                to the source peer of the message, peers can send NACK to other peers of their
                choice.</li>
              </ul>
            </div>

            <p>These messages are sent and received by the EndpointRouter using the JXTA Resolver
            Service.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="trans_router_msg" id=
                  "trans_router_msg"></a>4.2.3.&nbsp;EndpointRouter Message Element</h3>
                </div>
              </div>
            </div>

            <p>The Endpoint Router Transport Protocol appends its own message element to each
            message it transports. The name of the message element is <code class=
            "constant">JxtaEndpointRouter</code>and contains an XML document containing the
            following:</p>

            <div class="figure">
              <a name="feprme" id="feprme"></a>

              <p class="title"><b>Figure&nbsp;4.1.&nbsp;Endpoint Router Message Element</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;xs:element name="ERM" type="jxta:ERM"/&gt;

&lt;xs:complexType name="ERM"&gt;
    &lt;xs:sequence&gt;
        &lt;xs:element name="Src" type="jxta:JXTAID" /&gt;
        &lt;xs:element name="Dest" type="xs:anyURI" /&gt;
        &lt;xs:element name="LastHop" minOccurs="0" type="jxta:JXTAID" /&gt;
        &lt;xs:element name="Fwd"&gt;
            &lt;xs:complexType&gt;
                &lt;xs:sequence&gt;
                    &lt;xs:element ref="jxta:APA" maxOccurs="unbounded" /&gt;
                &lt;/xs:sequence&gt;
            &lt;/xs:complexType&gt;
        &lt;/xs:element&gt;
        &lt;xs:element name="Rvs" minOccurs="0"&gt;
            &lt;xs:complexType&gt;
                &lt;xs:sequence&gt;
                    &lt;xs:element ref="jxta:APA" maxOccurs="unbounded" /&gt;
                &lt;/xs:sequence&gt;
            &lt;/xs:complexType&gt;
        &lt;/xs:element&gt;
    &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
              </div>
            </div><br class="figure-break">

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Src&gt;</code></span></dt>

                <dd>The peer id of the originator of this message.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Dest&gt;</code></span></dt>

                <dd>The Endpoint Address of the intended final destination of this message.
                Includes final routing information of the service name and service parameter.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;LastHop&gt;</code></span></dt>

                <dd>The peer id of the most recent peer to forward this message. When a peer
                forwards a message, it <span class="rfc2119">should</span> update this field with
                its own Endpoint Address.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Fwd&gt;</code></span></dt>

                <dd>A loosely ordered list of Access Point Advertisements which describe a probable
                route for this message. Loosely ordered because it may describe alternative routes.
                In order to route the message peers should scan the list for the <span class=
                "emphasis"><em>last</em></span> peer for which they recognize and route message via
                that peer.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Rvs&gt;</code></span></dt>

                <dd>An ordered array of Access Point Advertisements which describe the known
                reverse route for this message. This is the path which the message has traveled
                thus far. Due to unidirectional links this route <span class="rfc2119">may</span>
                not be suitable for sending response messages.</dd>
              </dl>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="trans-router-addr" id=
                    "trans-router-addr"></a>4.2.3.1.&nbsp;EndpointRouter Endpoint Address
                    format</h4>
                  </div>
                </div>
              </div>

              <p>Since the EndpointRouter is a transport protocol, it has its own Endpoint Address
              format, which is:</p>

              <div class="figure">
                <a name="fjera" id="fjera"></a>

                <p class="title"><b>Figure&nbsp;4.2.&nbsp;JXTA Endpoint Router Address
                Format</b></p>

                <div class="figure-contents">
                  <pre class="programlisting">
jxta://<span class="emphasis"><em>[PeerID unique value]</em></span>
</pre>
                </div>
              </div><br class="figure-break">
            </div>
          </div>
        </div>
      </div>

      <div class="chapter" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a name="msgs" id="msgs"></a>Chapter&nbsp;5.&nbsp;Messages</h2>
            </div>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="id280185" id=
                "id280185"></a>5.1.&nbsp;Introduction</h2>
              </div>
            </div>
          </div>

          <p>Messages are the basic unit of data exchange between peers. Pipes send and receive
          messages to and from services; any protocol implemented by a service will send and
          receive messages. Messages are encoded using &ldquo;<span class=
          "quote">wire</span>&rdquo; representations for transmission. Each JXTA transport will use
          the message representations most appropriate for its characteristics and the peers'
          preferences. See <a href="#msgs-fmts" title=
          "Chapter&nbsp;3.&nbsp;JXTA Message Wire Representations">JXTA Message Wire
          Representations</a> for information about representations.</p>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="id280538" id=
                "id280538"></a>5.2.&nbsp;Message</h2>
              </div>
            </div>
          </div>

          <p>A message is a set of named and typed contents called elements. Thus a message is
          essentially a set of name/value pairs. The content can be an arbitrary type. Many core
          services send XML advertisements as message element contents.</p>

          <p>As a message passes down the JXTA protocol stack (applications, services, endpoint and
          transports), each level may add one or more named elements to the message. As a message
          is passed back up the stack on the receiving peer, the protocol handlers <span class=
          "rfc2119">should</span> remove those elements.</p>

          <p>A message is an ordered sequence of message elements. The most recently added element
          appears at the end of the message.</p>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="id280567" id=
                "id280567"></a>5.3.&nbsp;Element</h2>
              </div>
            </div>
          </div>

          <p>A message element contains a namespace, an optional name, an optional type, an
          optional signature or digest and content.</p>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="msgs-namespace" id=
                  "msgs-namespace"></a>5.3.1.&nbsp;Namespace</h3>
                </div>
              </div>
            </div>

            <p>Every element is assigned to a namespace. Namespaces are used to organize elements
            used by different message users and transports within the same message.</p>

            <p>Two namespaces names are considered equivalent if their representation in canonical
            UTF8 (NFC) (see <em class="citetitle">Unicode Standard Annex #15 : Unicode
            Normalization Forms</em> <a href="#bib-USA15" title=
            "Unicode Standard Annex #15: Unicode Normalization Forms">USA15</a>) is byte-for-byte
            identical.</p>

            <p>Two message element namespaces are pre-defined, <code class="constant">""</code>
            (empty string) and <code class="constant">jxta</code>. The <code class=
            "constant">""</code> namespace is reserved for user applications and services--none of
            the JXTA protocols or services will use or modify elements in this namespace.</p>

            <p>The <code class="constant">jxta</code> namespace is reserved for internal use by the
            JXTA protocols and services. Applications <span class="rfc2119">should not</span>
            create, manipulate or assume the interpretation of any of the content of elements in
            the <code class="constant">jxta</code> namespace. In some bindings, applications
            <span class="rfc2119">may</span> be forbidden from accessing or creating elements in
            the <code class="constant">jxta</code> namespace.</p>

            <p>Use of namespaces by services and applications other than the "" namespace is
            <span class="rfc2119">optional</span>. Namespaces require no formal registration as the
            protocols used need only be agreed upon by the participants.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="msgs-name" id="msgs-name"></a>5.3.2.&nbsp;Name</h3>
                </div>
              </div>
            </div>

            <p>Elements may have an optional name. Elements in the same message <span class=
            "rfc2119">may</span> have the same name.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="msgs-type" id="msgs-type"></a>5.3.3.&nbsp;Type</h3>
                </div>
              </div>
            </div>

            <p>A type is specified as a MIME type. See <a href="#bib-RFC2046" title=
            "Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">RFC2046</a>. The
            MIME type is encoded in canonical UTF8 (NFC) using the presentation and encoding of
            <em class="citetitle">Multipurpose Internet Mail Extensions (MIME) Part Two: Media
            Types</em> <a href="#bib-RFC2046" title=
            "Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">RFC2046</a>, ie.
            any encoding specified by RFC 2046 is performed before the string is encoded into UTF8
            from its native representation.</p>

            <p>The type is used by the applications and services that process the element. There is
            no restriction on the set of MIME types that can be used by applications and services.
            In addition to the applications and services which use the particular element, the type
            of the element may also be examined by the JXTA message transport to determine how to
            format the message element to ensure the most effcient transfer.</p>

            <p>If the type is not specified for an element "application/octet-stream" is
            assumed.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="id280729" id="id280729"></a>5.3.4.&nbsp;Content</h3>
                </div>
              </div>
            </div>

            <p>The contents of the Element data are opaque to except to the applications and
            services which use these elements.</p>
          </div>
        </div>
      </div>
    </div>

    <div class="part" lang="en">
      <div class="titlepage">
        <div>
          <div>
            <h1 class="title"><a name="stdsvc" id="stdsvc"></a>Part&nbsp;2.&nbsp;JXTA Standard
            Services</h1>
          </div>
        </div>
      </div>

      <div class="partintro" lang="en">
        <div>
          <div>
            <div>
              <h1 class="title"><a name="stdsvc-i" id="stdsvc-i"></a>Introduction</h1>
            </div>
          </div>
        </div>

        <p>The <a href="#core" title="Part&nbsp;1.&nbsp;JXTA Core Specification">JXTA Core
        Specification</a> defines the required components and behaviours for all JXTA
        implementations. In order to create a complete JXTA implementation there are some
        additional components which all implementation <span class="rfc2119">should</span>
        provide.</p>

        <p>The <a href="#gloss-jss"><em class="firstterm">JXTA Standard Services</em></a> are
        <span class="rfc2119">optional</span> JXTA components and behaviours. Implementations are
        not required to provide these services, but are strongly <span class=
        "rfc2119">recommended</span> to do so. Implementing these services will provide greater
        interoperability with other implementations and broader functionality.</p>

        <div class="toc">
          <p><b>Table of Contents</b></p>

          <dl>
            <dt><span class="chapter"><a href="#stdsvc-proto">1. Standard Protocols</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#proto-pdp">1.1. Peer Discovery
                Protocol</a></span></dt>

                <dt><span class="section"><a href="#proto-rvp">1.2. Rendezvous
                Protocol</a></span></dt>

                <dt><span class="section"><a href="#proto-pip">1.3. Peer Information
                Protocol</a></span></dt>

                <dt><span class="section"><a href="#proto-pbp">1.4. Pipe Binding
                Protocol</a></span></dt>
              </dl>
            </dd>

            <dt><span class="chapter"><a href="#stdsvc-trans">2. Standard JXTA Message
            Transports</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#trans-tcpipt">2.1. TCP/IP Message
                Transport</a></span></dt>

                <dt><span class="section"><a href="#trans-httpt">2.2. HTTP Message
                Transport</a></span></dt>

                <dt><span class="section"><a href="#trans-tlst">2.3. TLS Transport
                Binding</a></span></dt>
              </dl>
            </dd>

            <dt><span class="chapter"><a href="#msgs-fmts">3. JXTA Message Wire
            Representations</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#id295118">3.1. General
                Requirements</a></span></dt>

                <dt><span class="section"><a href="#msgs-fmts-jbm">3.2. Binary Message
                Format</a></span></dt>

                <dt><span class="section"><a href="#id295545">3.3. XML Message
                Format</a></span></dt>
              </dl>
            </dd>
          </dl>
        </div>
      </div>

      <div class="chapter" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a name="stdsvc-proto" id=
              "stdsvc-proto"></a>Chapter&nbsp;1.&nbsp;Standard Protocols</h2>
            </div>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="proto-pdp" id=
                "proto-pdp"></a>1.1.&nbsp;Peer Discovery Protocol</h2>
              </div>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-pdp-intro" id=
                  "proto-pdp-intro"></a>1.1.1.&nbsp;Introduction</h3>
                </div>
              </div>
            </div>

            <p>The Peer Discovery Protocol is used to discover any published peer resource.
            Resources are represented as advertisements. A resource can be a peer, a peergroup, a
            pipe, a module, or any resource that has an advertisement. Each resource <span class=
            "rfc2119">must</span> be represented by an advertisement.</p>

            <p>The Peer Discovery Protocol (PDP) enables a peer to find advertisements in its
            group. The PDP protocol is the discovery protocol of the world peergroup. Custom
            discovery services <span class="rfc2119">may</span> choose to leverage PDP. If a peer
            group does not need to define its own discovery protocol, it may use the world
            peergroup PDP.</p>

            <p>The intent is for PDP to provide the essential discovery infrastructure for building
            and bootstrapping high-level discovery services. In many situation, discovery
            information is better known by a high-level service, because the service may have a
            better knowledge of the group topology.</p>

            <p>The PDP protocol provides a basic mechanism to discover advertisements while
            providing hooks so high-level services and applications can participate in the
            discovery process. Services <span class="rfc2119">should</span> be able to give hints
            to improve discovery (i.e. decide which advertisements are the most valuable to
            cache).</p>

            <p>The PDP protocol utilizes the resolver protocol to route queries and responses.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-pdp-dqm" id=
                  "proto-pdp-dqm"></a>1.1.2.&nbsp;Discovery Query Message</h3>
                </div>
              </div>
            </div>

            <p>The discovery query message is used by peers to send discovery requests when
            searching for advertisements.</p>

            <div class="figure">
              <a name="fdqs" id="fdqs"></a>

              <p class="title"><b>Figure&nbsp;1.1.&nbsp;Discovery Query Schema</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;xs:element name="<code class="classname">DiscoveryQuery</code>" type="jxta:DiscoveryQuery"/&gt;

&lt;xsd:simpleType name="DiscoveryQueryType"&gt;
  &lt;xsd:restriction base="xsd:string"&gt;
    &lt;!-- peer --&gt;
    &lt;xsd:enumeration value="0"/&gt;
    &lt;!-- group --&gt;
    &lt;xsd:enumeration value="1"/&gt;
    &lt;!-- adv --&gt;
    &lt;xsd:enumeration value="2"/&gt;
  &lt;/xsd:restriction&gt;
&lt;/xsd:simpleType&gt;

&lt;xs:complexType name="DiscoveryQuery"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element name="Type" type="jxta:DiscoveryQueryType"/&gt;
    &lt;xs:element name="Threshold" type="xs:unsignedInt" minOccurs="0"/&gt;
    &lt;xs:element name="Attr" type="xs:string" minOccurs="0"/&gt;
    &lt;xs:element name="Value" type="xs:string" minOccurs="0"/&gt;
    &lt;!-- The following should refer to a peer adv, but is instead a whole doc for historical reasons --&gt;
    &lt;xs:element name="PeerAdv" type="xs:string" minOccurs="0"/&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
              </div>
            </div><br class="figure-break">

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Type&gt;</code></span></dt>

                <dd>
                  <p>Only advertisements of requested type will be matched. Possible values
                  are:</p>

                  <div class="variablelist">
                    <dl>
                      <dt><span class="term"><code class="sgmltag-element">0</code></span></dt>

                      <dd>Peer Advertisements</dd>

                      <dt><span class="term"><code class="sgmltag-element">1</code></span></dt>

                      <dd>Peergroup Advertisements</dd>

                      <dt><span class="term"><code class="sgmltag-element">2</code></span></dt>

                      <dd>Any Advertisements</dd>
                    </dl>
                  </div>
                </dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Threshold&gt;</code></span></dt>

                <dd>specifies the maximum number of advertisements that each responding peer
                <span class="rfc2119">should</span> provide. The total number of results received
                depends on the number of peers that respond and the advertisements they have. If
                <code class="sgmltag-starttag">&lt;Type&gt;</code> is <code class=
                "sgmltag-element">0</code> (Peer Advertisements) and <code class=
                "sgmltag-starttag">&lt;Threshold&gt;</code> is <code class=
                "sgmltag-element">0</code>, then the query has a special meaning: its objective is
                to collect Peer Advertisements of respondents. Therefore any peer <span class=
                "rfc2119">should</span> respond to such a query, e ven though no results are to be
                included.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;PeerAdv&gt;</code></span></dt>

                <dd>If present, the advertisement of the requestor.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Attribute&gt;</code>,</span> <span class="term"><code class=
                "sgmltag-starttag">&lt;Value&gt;</code></span></dt>

                <dd>
                  <p>Must either be both present or absent. If absent, then each respondent should
                  supply a random set of advertisements of the appropriate type up to <code class=
                  "sgmltag-starttag">&lt;Threshold&gt;</code> count.</p>

                  <p>Only advertisements containing an element who's name matches <code class=
                  "sgmltag-starttag">&lt;Attribute&gt;</code> and that also contains a value
                  matching <code class="sgmltag-starttag">&lt;Value&gt;</code> are eligible to be
                  found. <code class="sgmltag-starttag">&lt;Value&gt;</code> may begin or end with
                  "*", or both. In that case <code class="sgmltag-starttag">&lt;Value&gt;</code>
                  will match all values that end with or beginning with, or contain the rest of the
                  string. If <code class="sgmltag-starttag">&lt;Value&gt;</code> contains only "*"
                  the result is unspecified. Some implementations may choose not match any
                  advertisement for <code class="sgmltag-starttag">&lt;Value&gt;</code> "*".</p>
                </dd>
              </dl>
            </div>

            <div class="example">
              <a name="fdqe" id="fdqe"></a>

              <p class="title"><b>Example&nbsp;1.1.&nbsp;Discovery Query</b></p>

              <div class="example-contents">
                <pre class="programlisting">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
    
&lt;jxta:DiscoveryQuery&gt;
    &lt;Type&gt;2&lt;/Type&gt;
    &lt;Threshold&gt;1&lt;/Threshold&gt; 
    &lt;Attr&gt;Name&lt;/Attr&gt;
    &lt;Value&gt;*sidus*&lt;/Value&gt;
    &lt;PeerAdv&gt;
        &amp;lt;?xml version="1.0"?&gt;

        &amp;lt;!DOCTYPE jxta:PA&gt;

        &amp;lt;jxta:PA xmlns:jxta="http://jxta.org"&gt;
            &amp;lt;PID&gt;
                urn:jxta:uuid-59616261646162614A7874615032503304BD268FA4764960AB93A53D7F15044503
            &amp;lt;/PID&gt;
            <span class="emphasis"><em>... remainder omitted for brevity ...</em></span>
        &amp;lt;/jxta:PA&gt;
    &lt;/PeerAdv&gt;
&lt;/jxta:DiscoveryQuery&gt;
</pre>
              </div>
            </div><br class="example-break">
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-pdp-drm" id=
                  "proto-pdp-drm"></a>1.1.3.&nbsp;Discovery Response Message</h3>
                </div>
              </div>
            </div>

            <p>A Discovery response message is used by a peer to respond to a discovery query
            message.</p>

            <div class="figure">
              <a name="fdrs" id="fdrs"></a>

              <p class="title"><b>Figure&nbsp;1.2.&nbsp;Discovery Response Schema</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;xs:element name="<code class=
"classname">DiscoveryResponse</code>" type="jxta:DiscoveryResponse"/&gt;

&lt;xs:complexType name="DiscoveryResponse"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element name="Type" type="jxta:DiscoveryQueryType"/&gt;
    &lt;xs:element name="Count" type="xs:unsignedInt" minOccurs="0"/&gt;
    &lt;xs:element name="Attr" type="xs:string" minOccurs="0"/&gt;
    &lt;xs:element name="Value" type="xs:string" minOccurs="0"/&gt;
    &lt;!-- The following should refer to a peer adv, but is instead a whole doc for historical reasons --&gt;
    &lt;xs:element name="PeerAdv" minOccurs="0"&gt;
      &lt;xs:complexType&gt;
        &lt;xs:simpleContent&gt;
      &lt;xs:extension base="xs:string"&gt;
         &lt;xs:attribute name="Expiration" type="xs:unsignedLong"/&gt;
      &lt;/xs:extension&gt;
      &lt;/xs:simpleContent&gt;
      &lt;/xs:complexType&gt;     
    &lt;/xs:entry&gt;
    &lt;xs:element name="Response" maxOccurs="unbounded"&gt;
      &lt;xs:complexType&gt;
        &lt;xs:simpleContent&gt;
          &lt;xs:extension base="xs:string"&gt;
            &lt;xs:attribute name="Expiration" type="xs:unsignedLong"/&gt;
          &lt;/xs:extension&gt;
        &lt;/xs:simpleContent&gt;
      &lt;/xs:complexType&gt;     
    &lt;/xs:entry&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
              </div>
            </div><br class="figure-break">

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Type&gt;</code></span></dt>

                <dd>The type of all the advertisements returned in the <code class=
                "sgmltag-starttag">&lt;Response&gt;</code> element(s).</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Count&gt;</code></span></dt>

                <dd>If present, the number of <code class=
                "sgmltag-starttag">&lt;Response&gt;</code> element(s) included in this
                response.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;PeerAdv&gt;</code></span></dt>

                <dd>If present, the advertisement of the respondent. The <code class=
                "sgmltag-attribute">Expiration</code> attribute is the associated relative
                expiration time in milliseconds.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Attribute&gt;</code>,</span> <span class="term"><code class=
                "sgmltag-starttag">&lt;Value&gt;</code></span></dt>

                <dd>If present, reflects that of the <code class="classname">DiscoveryQuery</code>
                to which this is the response.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Response&gt;</code></span></dt>

                <dd>An advertisement.The <code class="sgmltag-attribute">Expiration</code>
                attribute is the associated relative expiration time in milliseconds.</dd>
              </dl>
            </div>

            <div class="example">
              <a name="fdre" id="fdre"></a>

              <p class="title"><b>Example&nbsp;1.2.&nbsp;Discovery Response</b></p>

              <div class="example-contents">
                <pre class="programlisting">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
    
&lt;jxta:DiscoveryResponse&gt;
    &lt;Type&gt;2&lt;/Type&gt;
    &lt;Count&gt;1&lt;/Count&gt; 
    &lt;Attr&gt;Name&lt;/Attr&gt;
    &lt;Value&gt;*sidus*&lt;/Value&gt;
    &lt;PeerAdv&gt;
        &amp;lt;?xml version="1.0"?&gt;

        &amp;lt;!DOCTYPE jxta:PA&gt;

        &amp;lt;jxta:PA xmlns:jxta="http://jxta.org"&gt;
            &amp;lt;PID&gt;
                urn:jxta:uuid-59616261646162614A7874615032503304BD268FA4764960AB93A53D7F15044503
            &amp;lt;/PID&gt;
            <span class="emphasis"><em>... omitted ...</em></span>
        &amp;lt;/jxta:PA&gt;
    &lt;/PeerAdv&gt;
    &lt;Response Expiration="36000000"&gt;
        &amp;lt;?xml version="1.0"?&gt;

        &amp;lt;!DOCTYPE jxta:PipeAdvertisement&gt;

        &amp;lt;jxta:PipeAdvertisement xmlns:jxta="http://jxta.org"&gt;
            &amp;lt;Id&gt;
                urn:jxta:uuid-094AB61B99C14AB694D5BFD56C66E512FF7980EA1E6F4C238A26BB362B34D1F104
            &amp;lt;/Id&gt;
            &amp;lt;Type&gt;
                JxtaUnicastSecure
            &amp;lt;/Type&gt;
            &amp;lt;Name&gt;
                JxtaTalkUserName.sidus
            &amp;lt;/Name&gt;
        &amp;lt;/jxta:PipeAdvertisement&gt;
    &lt;/Response&gt;
&lt;/jxta:DiscoveryResponse&gt;
</pre>
              </div>
            </div><br class="example-break">
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-pdp-behav" id=
                  "proto-pdp-behav"></a>1.1.4.&nbsp;Behaviour</h3>
                </div>
              </div>
            </div>

            <p>The <acronym class="acronym">PDP</acronym> does not guarantee peers that receive a
            query will respond to the query, nor does it mandate that the number of advertisements
            requested will be honored. Only a best effort is made at matching the query to results
            in the respondant's cache.</p>

            <p>There is no guarantee that a response to a discovery query request will be made. It
            is important to point out that responding to a DiscoveryQuery request is <span class=
            "rfc2119">optional</span>. A peer is not required to respond to a DiscoveryQuery
            request.</p>

            <p>A reliable transport is <span class="rfc2119">optional</span> with the
            <acronym class="acronym">PDP</acronym>. Multiple Discovery query messages may be sent.
            None, one, multiple or redundant responses may be received.</p>

            <p>A peer may receive a DiscoveryResponse that is not a response to any DiscoveryQuery
            initiated by the peer, this mechanism provides the ability to remote publish a
            resource.</p>

            <p>The <acronym class="acronym">PDP</acronym> provides a mechanism for services to
            query the network for JXTA resources, and receive responses. As a service, the
            reference implementation helps other services by taking care of all messaging aspects,
            caching, and expiring advertisements.</p>

            <p>The actual task of propagating, and re-propagating a query to the next set of peers
            is delegated to the Resolver Service.</p>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="proto-rvp" id=
                "proto-rvp"></a>1.2.&nbsp;Rendezvous Protocol</h2>
              </div>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="id285937" id=
                  "id285937"></a>1.2.1.&nbsp;Introduction</h3>
                </div>
              </div>
            </div>

            <p>The Rendezvous Protocol (<acronym class="acronym">RVP</acronym>) is used for
            propagation of messages within a peer group. The Rendezvous Protocol provides
            mechanisms which enable propagation of messages to be performed in a controlled way. To
            most efficiently propagate messages some peers <span class="rfc2119">may</span> agree
            to do extra work. Each <em class="glossterm"><a href="#gloss-rdv" title=
            "Rendezvous Peer">Rendezvous Peer</a></em> cooperates with other Rendezvous Peers and
            with client peers to propagate messages amongst the peers of a peer group. The
            Rendezvous Peers work together to form a PeerView. The PeerView is a list of the peers
            which are currently acting as Rendezvous Peers. The PeerView is structured such that
            Rendezvous Peers are able to direct messages within the peer group in a consistent way
            without the need for centralized coordination.</p>

            <p>The Rendezvous Protocol is divided into three parts; a management protocol
            (PeerView), a connection registration protocol and the protocol used for transmiting
            propagated messages.</p>

            <p>The PeerView protocol is an <span class="rfc2119">optional</span> protocol used by
            Rendezvous Peers to organize themselves. The PeerView protocol is used to form and
            verify the integrity of the PeerView. Each Rendezvous Peer maintains its own local list
            of active PeerView members. Rendezvous Peers exchange PeerView messages with the other
            PeerView members to maintain their local PeerView.</p>

            <p>The Rendezvous Lease Protocol is an <span class="rfc2119">optional</span> protocol
            which enables non-Rendezvous Peers to subscribe to receive propagated messages.
            Rendezvous Peers offer leases to subscribing peers based upon the Rendezvous Peer's
            ability to distribute propagated messages. During the term of the offered lease the
            Rendezvous Peer will accept messages from the subscribing peer for propagation to the
            peer group and will distribute any appropriate propagation messages to the subscriber.
            Both the Rendezvous Peer and the subscriber peer may terminate the lease at any
            time.</p>

            <p>The Rendezvous Propagation Protocol is the only <span class=
            "rfc2119">required</span> protocol for peers which use the Rendezvous Service. The
            Rendezvous Propagation Protocol enables peers to manage the propagation of individual
            messages within a peer group. The Rendezvous Propagation Protocol enables peers to
            determine the source of a propagated message, the peers the message has already
            traversed, the listener name to which the message is addressed and the remaining
            distance which the message may travel before expiring.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="advert-rdv" id="advert-rdv"></a>1.2.2.&nbsp;Rendezvous
                  Advertisement</h3>
                </div>
              </div>
            </div>

            <p>A Rendezvous advertisement describes a peer that acts as a Rendezvous Peer for a
            given PeerGroup. Those advertisements can be published and retrieved, so peers that are
            looking for rendezvous peers can find them.</p>

            <div class="figure">
              <a name="fras" id="fras"></a>

              <p class="title"><b>Figure&nbsp;1.3.&nbsp;Rendezvous Advertisement Schema</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;xs:element name="RdvAdvertisement" type="jxta:RdvAdvertisement"/&gt;

&lt;xs:complexType name="RdvAdvertisement"&gt;
    &lt;xs:sequence&gt;
        &lt;xs:element name="RdvGroupId" type="jxta:JXTAID" /&gt;
        &lt;xs:element name="RdvPeerId" type="jxta:JXTAID" /&gt;
        &lt;xs:element name="RdvServiceName" type="xs:string" /&gt;
        &lt;xs:element name="Name" type="xs:string" /&gt;
        &lt;xs:element name="RdvRoute" type="jxta:RA" minOccurs="0" /&gt;
    &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
              </div>
            </div><br class="figure-break">

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;RdvGroupId&gt;</code></span></dt>

                <dd>This is a <span class="rfc2119">required</span> element that contains the ID of
                the PeerGroup for which the peer is a rendezvous.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;RdvPeerId&gt;</code></span></dt>

                <dd>This is a <span class="rfc2119">required</span> element that contains the ID of
                the peer which is a rendezvous.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;RdvServiceName&gt;</code></span></dt>

                <dd>This is a <span class="rfc2119">required</span> element that identifies the
                PeerView to which the Rendezvous Peer belongs.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Name&gt;</code></span></dt>

                <dd>This is an <span class="rfc2119">optional</span> name associated with the
                rendezvous peer. Often the same as the peer name.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;RdvRoute&gt;</code></span></dt>

                <dd>An <span class="rfc2119">optional</span> route to the Rendezvous Peer. A
                <a href="#feprra" title="Figure&nbsp;3.6.&nbsp;Route Advertisement">Route
                Advertisement</a> is included as a child of the <code class=
                "sgmltag-starttag">&lt;RdvRoute&gt;</code> element.</dd>
              </dl>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="id286184" id="id286184"></a>1.2.3.&nbsp;PeerView
                  Protocol</h3>
                </div>
              </div>
            </div>

            <p>The PeerView Protocol is used by Rendezvous Peers to organize orderly interactions
            amongst themselves. The PeerView is a collection of the participant peers. The
            collection of all RendezVous Peers within a peer group is the Rendezvous PeerView. The
            state of the peer group's PeerView is not maintained on a specific peer. Instead, each
            Rendezvous Peer maintains a local version of its view of the global PeerView. Each
            local version is loosely consistent with all other local versions. The goal of the
            PeerView Protocol is to create and maintain a consistent Peerview state.</p>

            <p>The PeerView participants exchange messages with other PeerView participants. Each
            PeerView message contains a <a href="#advert-rdv" title=
            "1.2.2.&nbsp;Rendezvous Advertisement">Rendezvous Advertisement</a> and is either a
            probe or response message. Probe messages contain the Rendezvous Advertisement for the
            peer which initiates the probe. PeerView response messages <span class=
            "rfc2119">may</span> contain the Rendezvous Advertisement of the responding peer or
            Rendezvous Advertisement of another peer. Responses containing advertisements for other
            than the responding peer is how Rendezvous Peers learn of other PeerView members.</p>

            <div class="figure">
              <a name="fpvm" id="fpvm"></a>

              <p class="title"><b>Figure&nbsp;1.4.&nbsp;PeerView Message</b></p>

              <div class="figure-contents">
                <div class="informaltable">
                  <table border="1" width="100%">
                    <colgroup>
                      <col>
                      <col>
                    </colgroup>

                    <thead>
                      <tr>
                        <th colspan="2" align="left">Edge Peer Flag Element (optional)</th>
                      </tr>
                    </thead>

                    <tbody>
                      <tr>
                        <td>Message Element Namespace</td>

                        <td><code class="literal">jxta</code></td>
                      </tr>

                      <tr>
                        <td>Message Element Name</td>

                        <td><code class="literal">PeerView.EdgePeer</code></td>
                      </tr>

                      <tr>
                        <td>Mime Media Type</td>

                        <td><code class="literal">text/plain; charset=UTF-8</code></td>
                      </tr>

                      <tr>
                        <td>Element Content</td>

                        <td><code class="literal">true</code></td>
                      </tr>
                    </tbody>
                  </table>

                  <table border="1" width="100%">
                    <colgroup>
                      <col>
                      <col>
                    </colgroup>

                    <thead>
                      <tr>
                        <th colspan="2" align="left">Cached Flag Element (optional)</th>
                      </tr>
                    </thead>

                    <tbody>
                      <tr>
                        <td>Message Element Namespace</td>

                        <td><code class="literal">jxta</code></td>
                      </tr>

                      <tr>
                        <td>Message Element Name</td>

                        <td><code class="literal">PeerView.Cached</code></td>
                      </tr>

                      <tr>
                        <td>Mime Media Type</td>

                        <td><code class="literal">text/plain; charset=UTF-8</code></td>
                      </tr>

                      <tr>
                        <td>Element Content</td>

                        <td><code class="literal">true</code></td>
                      </tr>
                    </tbody>
                  </table>

                  <table border="1" width="100%">
                    <colgroup>
                      <col>
                      <col>
                    </colgroup>

                    <thead>
                      <tr>
                        <th colspan="2" align="left">Failure Notification Flag Element
                        (optional)</th>
                      </tr>
                    </thead>

                    <tbody>
                      <tr>
                        <td>Message Element Namespace</td>

                        <td><code class="literal">jxta</code></td>
                      </tr>

                      <tr>
                        <td>Message Element Name</td>

                        <td><code class="literal">PeerView.Failure</code></td>
                      </tr>

                      <tr>
                        <td>Mime Media Type</td>

                        <td><code class="literal">text/plain; charset=UTF-8</code></td>
                      </tr>

                      <tr>
                        <td>Element Content</td>

                        <td><code class="literal">true</code></td>
                      </tr>
                    </tbody>
                  </table>

                  <table border="1" width="100%">
                    <colgroup>
                      <col>
                      <col>
                    </colgroup>

                    <thead>
                      <tr>
                        <th colspan="2" align="left">Probe Element (optional)</th>
                      </tr>
                    </thead>

                    <tbody>
                      <tr>
                        <td>Message Element Namespace</td>

                        <td><code class="literal">jxta</code></td>
                      </tr>

                      <tr>
                        <td>Message Element Name</td>

                        <td><code class="literal">PeerView.PeerAdv</code></td>
                      </tr>

                      <tr>
                        <td>Mime Media Type</td>

                        <td><code class="literal">text/xml; charset=UTF-8</code></td>
                      </tr>

                      <tr>
                        <td>Element Content</td>

                        <td>RdvAdvertisement of the Probing Peer.</td>
                      </tr>
                    </tbody>
                  </table>

                  <table border="1" width="100%">
                    <colgroup>
                      <col>
                      <col>
                    </colgroup>

                    <thead>
                      <tr>
                        <th colspan="2" align="left">Response Element (optional)</th>
                      </tr>
                    </thead>

                    <tbody>
                      <tr>
                        <td>Message Element Namespace</td>

                        <td><code class="literal">jxta</code></td>
                      </tr>

                      <tr>
                        <td>Message Element Name</td>

                        <td><code class="literal">PeerView.PeerAdv.Response</code></td>
                      </tr>

                      <tr>
                        <td>Mime Media Type</td>

                        <td><code class="literal">text/xml; charset=UTF-8</code></td>
                      </tr>

                      <tr>
                        <td>Element Content</td>

                        <td>RdvAdvertisement of the Responding Peer.</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div><br class="figure-break">

            <p>The same basic PeerView Message is used for all PeerView interations. The core of
            the PeerView Message is either the probe or response element. Probe messages normally
            result in a response message from the receiving peer. Response messages normally
            receive no response. The PeerView Message elements other than the probe or response
            serve as annotations upon the basic message.</p>

            <div class="figure">
              <a name="fpvms" id="fpvms"></a>

              <p class="title"><b>Figure&nbsp;1.5.&nbsp;PeerView Message Scenarios</b></p>

              <div class="figure-contents">
                <div class="informaltable">
                  <table border="1" width="100%">
                    <colgroup>
                      <col>
                      <col>
                    </colgroup>

                    <thead>
                      <tr>
                        <th colspan="2" align="left">Edge Probe</th>
                      </tr>
                    </thead>

                    <tbody>
                      <tr>
                        <td>Purpose</td>

                        <td>A probe message by a peer which is not a participant in the PeerView to
                        learn of PeerView participants. The Rendezvous Advertisement included is
                        provided to enable the receiver to respond. It is not actually an
                        advertisement for a Rendezvous Peer. The response <span class=
                        "rfc2119">should</span> be a PeerView Message containing the Rendezvous
                        Advertisement of random PeerView participant.</td>
                      </tr>

                      <tr>
                        <td>Elements</td>

                        <td>EDGE, PROBE</td>
                      </tr>

                      <tr>
                        <td>Sent via</td>

                        <td>Pipe</td>
                      </tr>
                    </tbody>
                  </table>

                  <table border="1" width="100%">
                    <colgroup>
                      <col>
                      <col>
                    </colgroup>

                    <thead>
                      <tr>
                        <th colspan="2" align="left">Participant Probe</th>
                      </tr>
                    </thead>

                    <tbody>
                      <tr>
                        <td>Purpose</td>

                        <td>A probe message by a participant peer to another PeerView participant.
                        Response <span class="rfc2119">should</span> be a PeerView Message
                        containing the Rendezvous Advertisement of the responding peer.
                        Additionally, a second response containing the Rendezvous Advertisement of
                        a random PeerView participant <span class="rfc2119">may</span> also be sent
                        to the probing peer.</td>
                      </tr>

                      <tr>
                        <td>Elements</td>

                        <td>PROBE</td>
                      </tr>

                      <tr>
                        <td>Sent via</td>

                        <td>Endpoint Listener</td>
                      </tr>
                    </tbody>
                  </table>

                  <table border="1" width="100%">
                    <colgroup>
                      <col>
                      <col>
                    </colgroup>

                    <thead>
                      <tr>
                        <th colspan="2" align="left">Participant Response</th>
                      </tr>
                    </thead>

                    <tbody>
                      <tr>
                        <td>Purpose</td>

                        <td>A response message by a participant peer to another PeerView
                        participant. The response Rendezvous Advertisement <span class=
                        "rfc2119">must</span> be that of the responding peer.</td>
                      </tr>

                      <tr>
                        <td>Elements</td>

                        <td>RESPONSE</td>
                      </tr>
                    </tbody>
                  </table>

                  <table border="1" width="100%">
                    <colgroup>
                      <col>
                      <col>
                    </colgroup>

                    <thead>
                      <tr>
                        <th colspan="2" align="left">Participant Referral Response</th>
                      </tr>
                    </thead>

                    <tbody>
                      <tr>
                        <td>Purpose</td>

                        <td>A response message by one PeerView participant peer to another
                        participant peer providing a refferal to another different participant
                        peer. The response Rendezvous Advertisement <span class=
                        "rfc2119">must</span> be that a participant peer which is neither the
                        responding peer nor the intended recipient peer.</td>
                      </tr>

                      <tr>
                        <td>Elements</td>

                        <td>CACHED, RESPONSE</td>
                      </tr>

                      <tr>
                        <td>Sent via</td>

                        <td>Endpoint Listener</td>
                      </tr>
                    </tbody>
                  </table>

                  <table border="1" width="100%">
                    <colgroup>
                      <col>
                      <col>
                    </colgroup>

                    <thead>
                      <tr>
                        <th colspan="2" align="left">Shutdown Notification</th>
                      </tr>
                    </thead>

                    <tbody>
                      <tr>
                        <td>Purpose</td>

                        <td>A response message by a participant peer providing notification that
                        the responding peer is shutting down and will no longer be available. This
                        is a courtesy message which enables the other participant peers to more
                        quickly update their local views.</td>
                      </tr>

                      <tr>
                        <td>Elements</td>

                        <td>FAILURE, RESPONSE</td>
                      </tr>

                      <tr>
                        <td>Sent via</td>

                        <td>Pipe</td>
                      </tr>
                    </tbody>
                  </table>

                  <table border="1" width="100%">
                    <colgroup>
                      <col>
                      <col>
                    </colgroup>

                    <thead>
                      <tr>
                        <th colspan="2" align="left">Failure Notification</th>
                      </tr>
                    </thead>

                    <tbody>
                      <tr>
                        <td>Purpose</td>

                        <td>A response message by a participant peer providing notification that
                        the identified peer has failed and is no longer be available. This is a
                        courtesy message which enables the other participant peers to more quickly
                        update their local views.</td>
                      </tr>

                      <tr>
                        <td>Elements</td>

                        <td>CACHED, FAILURE, RESPONSE</td>
                      </tr>

                      <tr>
                        <td>Sent via</td>

                        <td>Pipe</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div><br class="figure-break">
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="id287088" id="id287088"></a>1.2.4.&nbsp;Rendezvous
                  Lease Protocol</h3>
                </div>
              </div>
            </div>

            <p>The Rendezous Lease Protocol is an <span class="rfc2119">optional</span> that allows
            non-Rendezvous Peers to subscribe to receive propagated messages. The subscriber peers
            requests a lease of a Rendezvous Peer and <span class="rfc2119">may</span> receive a
            lease in response. Leases are of fixed duration. During the term of the lease the
            Rendezvous Peer will accept messages from the subscriber peer for propagation to the
            peer group and will send to the subscriber peer propgated messages received from the
            peer group.</p>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id287111" id="id287111"></a>1.2.4.1.&nbsp;Lease
                    Request Message</h4>
                  </div>
                </div>
              </div>

              <p>When a peer wants to connect to a Rendezvous Peer, it sends a message with the a
              message element named jxta:Connect which contains its Peer advertisement.</p>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id287122" id="id287122"></a>1.2.4.2.&nbsp;Lease
                    Granted Message</h4>
                  </div>
                </div>
              </div>

              <p>When a rendezvous peer grants a lease (upon a lease request), it sends a message
              to the source of the lease request, containing the following message elements:</p>

              <div class="variablelist">
                <dl>
                  <dt><span class="term">jxta:ConnectedLease</span></dt>

                  <dd>This message element contains (in a String representation) the time in
                  milliseconds the lease is granted for. This message element is mandatory.</dd>

                  <dt><span class="term">jxta:ConnectedPeer</span></dt>

                  <dd>This message element contains the PeerID of the rendezvous peer that has
                  granted the lease. This message element is mandatory.</dd>

                  <dt><span class="term">jxta:RdvAdvReply</span></dt>

                  <dd>This message element contains the Peer Advertisement of the rendezvous peer
                  that grants the lease. This message element is optional.</dd>
                </dl>
              </div>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id287172" id="id287172"></a>1.2.4.3.&nbsp;Lease
                    Cancel Message</h4>
                  </div>
                </div>
              </div>

              <p>When a peer wants to cancel a lease, it sends a message with the following message
              element:</p>

              <div class="itemizedlist">
                <ul type="disc">
                  <li>"jxta:Disconnect": This message element contains the Peer Advertisement of
                  the peer which is requesting to cancel the lease. This message element is
                  mandatory.</li>
                </ul>
              </div>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="id287191" id="id287191"></a>1.2.5.&nbsp;Message
                  Propagation Protocol</h3>
                </div>
              </div>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="id287199" id="id287199"></a>1.2.6.&nbsp;Behaviour</h3>
                </div>
              </div>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id287204" id="id287204"></a>1.2.6.1.&nbsp;Peer
                    connection</h4>
                  </div>
                </div>
              </div>

              <p>Rendezvous peers which re-propagate messages they have received. A peer can
              dynamically become a rendezvous peer or <span class="rfc2119">may</span> connect to a
              rendezvous peer. The connection between a peer and a rendezvous peer is achieved by
              an explicit connection, associated to a lease.</p>

              <p>This connection is performed by sending messages using the JXTA Endpoint Protocol.
              Each peer implementing the Rendezvous protocol <span class="rfc2119">must</span>
              register with the Endpoint Service to receive messages with the following Service
              Name and Service Param:</p>

              <div class="itemizedlist">
                <ul type="disc">
                  <li>service name: JxtaPropagate</li>

                  <li>service param: PeerGroup ID</li>
                </ul>
              </div>

              <p>A set of queries and responses are defined by the Rendezvous Protocol in order to
              establish connections:</p>

              <div class="itemizedlist">
                <ul type="disc">
                  <li><span class="emphasis"><em>LeaseRequest</em></span> This request is sent by a
                  peer that desires to connect to a given rendezvous. A lease <span class=
                  "rfc2119">may</span> always be canceled by either party at anytime if necessary.
                  A rendezvous that grants a lease returns LeaseGranted.</li>

                  <li><span class="emphasis"><em>LeaseGranted</em></span> This message is sent by a
                  rendezvous to grant a lease to a given client. The amount of time the lease is
                  granted for is included in the message.</li>
                </ul>
              </div>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id287276" id=
                    "id287276"></a>1.2.6.2.&nbsp;Propagation Control</h4>
                  </div>
                </div>
              </div>

              <p>The Rendezvous Protocol implementation is responsible for controlling the
              propagation of messages. A Rendezvous Service <span class="rfc2119">should</span>
              propagate a message unless of the following conditions is detected:</p>

              <div class="itemizedlist">
                <ul type="disc">
                  <li>Loop: if a propagated messages has already been processed on a peer, it is
                  discarded.</li>

                  <li>TTL: propagated messages are associated with a Time To Live (TTL). Each time
                  a propagated message is received on a peer, its TTL is decreased by one. When the
                  TTL of a message drops to zero, the message is discarded.</li>

                  <li>Duplicate: each propagated message is associated with a unique identifier.
                  When a propagated message has been duplicated, and has already been received on a
                  peer, duplicates are discarded.</li>
                </ul>
              </div>

              <p>This control is performed by embedding a Message Element within each propagated
              message that is defined as:</p>

              <div class="figure">
                <a name="frpms" id="frpms"></a>

                <p class="title"><b>Figure&nbsp;1.6.&nbsp;RendezVous Propagate Message
                Schema</b></p>

                <div class="figure-contents">
                  <pre class="programlisting">
&lt;xs:element name="RendezVousPropagateMessage" type="jxta:RendezVousPropagateMessage"/&gt;
&lt;xs:complexType name="RendezVousPropagateMessage"&gt;
        &lt;xs:sequence&gt;
            &lt;xs:element name="MessageId" type="xs:string" /&gt;
            &lt;!-- This should be a constrained subtype --&gt;
            &lt;xs:element name="DestSName" type="xs:string" /&gt;
            &lt;xs:element name="DestSParam" type="xs:string" /&gt;
            &lt;xs:element name="TTL" type="xs:unsignedInt" /&gt;
            &lt;xs:element name="Path" type="jxta:JXTAID" maxOccurs="unbounded" /&gt;
        &lt;/xs:sequence&gt;
    &lt;/xs:complexType&gt;
</pre>
                </div>
              </div><br class="figure-break">
            </div>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="proto-pip" id=
                "proto-pip"></a>1.3.&nbsp;Peer Information Protocol</h2>
              </div>
            </div>
          </div>

          <p>Once a peer is located, its capabilities and status may be queried. PIP provides a set
          of messages to obtain a peer status information. PIP is an <span class=
          "rfc2119">optional</span> JXTA protocol. Peers are not required to respond to PIP
          requests.</p>

          <p>A reliable transport is <span class="rfc2119">optional</span> for PIP. Multiple peer
          information messages may be sent. None, one or multiple responses <span class=
          "rfc2119">may</span> be received in response to any query.</p>

          <p>The PIP is layered upon the <a href="#proto-prp" title=
          "3.1.&nbsp;Peer Resolver Protocol">Peer Resolver Protocol</a>. The <code class=
          "sgmltag-starttag">&lt;QueryID&gt;</code> element is used to match PIP queries containing
          <code class="sgmltag-starttag">&lt;request&gt;</code> elements to the PIP Response
          Messages containing the matching responses.</p>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-pip-mops" id=
                  "proto-pip-mops"></a>1.3.1.&nbsp;Obtaining PIP Responses</h3>
                </div>
              </div>
            </div>

            <p>The PIP Query Message provides a <span class="emphasis"><em>request</em></span>
            field that <span class="rfc2119">may</span> be used to encode a specific request. PIP
            does not dictate the format of the <span class="emphasis"><em>request</em></span> field
            and it is left up to the consumer to do so. Higher-level services <span class=
            "rfc2119">may</span> utilize the request field to offer expanded capabilities.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-pip-query" id=
                  "proto-pip-query"></a>1.3.2.&nbsp;PIP Query Message</h3>
                </div>
              </div>
            </div>

            <p>The query message is sent to a peer to query the current state of the peer, and
            obtain other relevant information about the peer. A query without a defined request
            field returns a default set of information about a peer (i.e. uptime, message count,
            etc.).</p>

            <div class="figure">
              <a name="fpipqs" id="fpipqs"></a>

              <p class="title"><b>Figure&nbsp;1.7.&nbsp;PIP Query Message</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;xs:element name="PeerInfoQueryMessage" type="jxta:PeerInfoQueryMessage"/&gt;

&lt;xs:complexType name="PeerInfoQueryMessage"&gt;
    &lt;xs:sequence&gt;
        &lt;xs:element name="sourcePid" type="jxta:JXTAID" /&gt;
        &lt;xs:element name="targetPid" type="jxta:JXTAID" /&gt;
        &lt;!-- if not present then the response is the general peerinfo --&gt;
        &lt;xs:element name="request" type="xs:anyType" minOccurs="0" /&gt;
    &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
              </div>
            </div><br class="figure-break">

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;sourcePid&gt;</code></span></dt>

                <dd>The peer id of the requesting peer.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;targetPid&gt;</code></span></dt>

                <dd>The peer id of the peer being queried.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;request&gt;</code></span></dt>

                <dd>An optional Request structure.</dd>
              </dl>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-pip-response" id=
                  "proto-pip-response"></a>1.3.3.&nbsp;PIP Response Message</h3>
                </div>
              </div>
            </div>

            <p>The Peer Information Protocol Response Message provides specific information about
            the current state of a peer, such as uptime, inbound and outbound message count, time
            last message received, and time last message sent.</p>

            <div class="figure">
              <a name="fpiprs" id="fpiprs"></a>

              <p class="title"><b>Figure&nbsp;1.8.&nbsp;PIP Response Message</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;xs:element name="PeerInfoResponseMessage" type="jxta:PeerInfoResponseMessage"/&gt;

&lt;xs:complexType name="PeerInfoResponseMessage"&gt;
    &lt;xs:sequence&gt;
        &lt;xs:element name="sourcePid" type="jxta:JXTAID" /&gt;
        &lt;xs:element name="targetPid" type="jxta:JXTAID" /&gt;
        &lt;xs:element name="uptime" type="xs:unsignedLong" minOccurs="0" /&gt;
        &lt;xs:element name="timestamp" type="xs:unsignedLong" minOccurs="0" /&gt;
        &lt;xs:element name="response" type="xs:anyType" minOccurs="0" /&gt;
        &lt;xs:element name="traffic" type="jxta:piptraffic" minOccurs="0" /&gt;
    &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;

&lt;xs:complexType name="piptraffic"&gt;
    &lt;xs:sequence&gt;
        &lt;xs:element name="lastIncomingMessageAt" type="xs:unsignedLong" minOccurs="0" /&gt;
        &lt;xs:element name="lastOutgoingMessageAt" type="xs:unsignedLong" minOccurs="0" /&gt;
        &lt;xs:element name="in" type="jxta:piptrafficinfo" minOccurs="0" /&gt;
        &lt;xs:element name="out" type="jxta:piptrafficinfo" minOccurs="0" /&gt;
    &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;

&lt;xs:complexType name="piptrafficinfo"&gt;
    &lt;xs:sequence&gt;
        &lt;xs:element name="transport" maxOccurs="unbounded"&gt;
            &lt;xs:complexType&gt;
                &lt;xs:simpleContent&gt;
                    &lt;xs:extension base="xs:unsignedLong"&gt;
                        &lt;xs:attribute name="Expiration" type="xs:anyURI" /&gt;
                    &lt;/xs:extension&gt;
                &lt;/xs:simpleContent&gt;
            &lt;/xs:complexType&gt;
        &lt;/xs:element&gt;
    &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
              </div>
            </div><br class="figure-break">

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;sourcePid&gt;</code></span></dt>

                <dd>The peer id of the requesting peer.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;targetPid&gt;</code></span></dt>

                <dd>The peer id of the peer being queried.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;uptime&gt;</code></span></dt>

                <dd>The relative time in milliseconds since the responding Peer Information Service
                began execution. Peers <span class="rfc2119">should</span> provide this tag in all
                responses, but <span class="rfc2119">may</span> chose to not implement it if the
                information is unavailable or would represent a security breach.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;timestamp&gt;</code></span></dt>

                <dd>The absolute time at which this response was generated. Measured in
                milliseconds since "the epoch", namely <span>January 1, 1970, 00:00:00 GMT</span>.
                Peers <span class="rfc2119">should</span> provide this tag in all responses, but
                <span class="rfc2119">may</span> chose to not implement it if the information is
                unavailable or would represent a security breach.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;response&gt;</code></span></dt>

                <dd>Potentially contains a response to a previous request from a PIP Query. To
                match queries to responses the <span class="emphasis"><em>QueryId</em></span>
                element of the <a href="#proto-prp" title="3.1.&nbsp;Peer Resolver Protocol">Peer
                Resolver Protocol</a> <span class="rfc2119">must</span> match. This field can
                contain any desired content.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;traffic&gt;</code></span></dt>

                <dd>
                  <p>Contains information about the network traffic performed by the target peer.
                  This element is <span class="rfc2119">optional</span>.</p>

                  <div class="variablelist">
                    <dl>
                      <dt><span class="term"><code class=
                      "sgmltag-starttag">&lt;lastIncomingMessageAt&gt;</code></span></dt>

                      <dd>The absolute time at which this peer last received a valid JXTA message
                      on one of its transports. Measured in milliseconds since "the epoch", namely
                      <span>January 1, 1970, 00:00:00 GMT</span>. Peers <span class=
                      "rfc2119">should</span> provide this tag in all responses, but <span class=
                      "rfc2119">may</span> chose to not implement it if the information is
                      unavailable or would represent a security breach.</dd>

                      <dt><span class="term"><code class=
                      "sgmltag-starttag">&lt;lastOutgoingMessageAt&gt;</code></span></dt>

                      <dd>The absolute time at which this peer last sent a valid JXTA message on
                      one of its transports. Measured in milliseconds since "the epoch", namely
                      <span>January 1, 1970, 00:00:00 GMT</span>. Peers <span class=
                      "rfc2119">should</span> provide this tag in all responses, but <span class=
                      "rfc2119">may</span> chose to not implement it if the information is
                      unavailable or would represent a security breach.</dd>

                      <dt><span class="term"><code class=
                      "sgmltag-starttag">&lt;in&gt;</code></span></dt>

                      <dd>
                        <p>If present, contains elements which describe incoming traffic from
                        various endpoint addresses.</p>

                        <div class="variablelist">
                          <dl>
                            <dt><span class="term"><code class=
                            "sgmltag-starttag">&lt;transport&gt;</code></span></dt>

                            <dd>Provides the number of bytes received by the named endpoint
                            address.</dd>
                          </dl>
                        </div>
                      </dd>

                      <dt><span class="term"><code class=
                      "sgmltag-starttag">&lt;out&gt;</code></span></dt>

                      <dd>
                        <p>If present, contains elements which describe outgoing traffic from
                        various endpoint addresses.</p>

                        <div class="variablelist">
                          <dl>
                            <dt><span class="term"><code class=
                            "sgmltag-starttag">&lt;transport&gt;</code></span></dt>

                            <dd>Provides the number of bytes transmitted by the named endpoint
                            address.</dd>
                          </dl>
                        </div>
                      </dd>
                    </dl>
                  </div>
                </dd>
              </dl>
            </div>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="proto-pbp" id=
                "proto-pbp"></a>1.4.&nbsp;Pipe Binding Protocol</h2>
              </div>
            </div>
          </div>

          <p>The Pipe Binding Protocol (<acronym class="acronym">PBP</acronym>) is used by
          applications and services in order to communicate with other peers. A pipe is a virtual
          channel between two endpoints described in a Pipe Advertisement. There are two ends of a
          Pipe: the Input Pipe (receiving end) and the Output Pipe (sending end).</p>

          <p>The Pipe Binding Protocol is layered upon the Endpoint Protocol, and will use a
          variety of Message Transports such as the JXTA HTTP Transport, the JXTA TCP/IP Transport,
          or the secure JXTA TLS Transport for the sending of messages.</p>

          <p>A pipe can be viewed as an abstract named message queue, supporting create,
          open/resolve (bind), close (unbind), delete, send, and receive operations. Actual pipe
          implementations may differ, but all compliant implementations use the PBP to bind the
          pipe to an endpoint.</p>

          <p>A reliable message transport is <span class="rfc2119">optional</span>. Multiple
          binding query messages may be sent. None, one or multiple responses may be received.</p>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="advert-pia" id="advert-pia"></a>1.4.1.&nbsp;Pipe
                  Advertisement</h3>
                </div>
              </div>
            </div>

            <p>A Pipe Advertisement describes a pipe. The pipe advertisement is used by the pipe
            service to create associated local input and output pipe endpoints.</p>

            <p>Each pipe advertisement includes a Pipe ID which is the canonical name for the
            pipe.</p>

            <p>Each pipe advertisement <span class="rfc2119">must</span> include a pipe type.There
            are currently three different types of pipes:</p>

            <div class="itemizedlist">
              <ul type="disc">
                <li><code class="constant">JxtaUnicast</code> Unicast, unsecure and unreliable.
                This type of pipe is used to send one-to-one messages.</li>

                <li><code class="constant">JxtaUnicastSecure</code> Unicast, secure (using TLS). An
                extension of the <code class="constant">JxtaUnicast</code>, except that the data is
                protected using a virtual TLS connection between the endpoints.</li>

                <li><code class="constant">JxtaPropagate</code> Diffusion pipes. This pipe type is
                used to send one-to-many messages. Any peer that has enabled an Input Pipe on a
                propagate type pipe receives messages that are sent onto it.</li>
              </ul>
            </div>

            <p>A pipe advertisement <span class="rfc2119">may</span> include an optional symbolic
            name.</p>

            <div class="figure">
              <a name="fpipeas" id="fpipeas"></a>

              <p class="title"><b>Figure&nbsp;1.9.&nbsp;Pipe Advertisement Schema</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;xs:element name="PipeAdvertisment" type="jxta:PipeAdvertisment"/&gt;

&lt;xs:complexType name="PipeAdvertisement"&gt;
    &lt;xs:sequence&gt;
        &lt;xs:element name="Id" type="jxta:JXTAID" /&gt;
        &lt;xs:element name="Type" type="xs:string" /&gt;
        &lt;xs:element name="Name" type="xs:string" minOccurs="0" /&gt;
        &lt;xs:element name="Desc" type="xs:anyType" minOccurs="0" /&gt;
    &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
              </div>
            </div><br class="figure-break">

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class="sgmltag-starttag">&lt;Id&gt;</code></span></dt>

                <dd>This is a required element that uniquely identifies the pipe. Each pipe has a
                unique id. See <a href="#ids" title="Chapter&nbsp;1.&nbsp;IDs">IDs</a> for
                description of JXTA Ids.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Type&gt;</code></span></dt>

                <dd>
                  <p>This is an required element that defines the type of the pipe. The following
                  types are currently defined:</p>

                  <div class="variablelist">
                    <dl>
                      <dt><span class="term"><code class=
                      "sgmltag-element">JxtaUnicast</code></span></dt>

                      <dd>may not arrive at the destination, may be delivered more than once to the
                      same destination, may arrive in different order.</dd>

                      <dt><span class="term"><code class=
                      "sgmltag-element">JxtaUnicastSecure</code></span></dt>

                      <dd>may not arrive at the destination, may be delivered more than once to the
                      same destination, may arrive in different order, but is encrypted using
                      TLS.</dd>

                      <dt><span class="term"><code class=
                      "sgmltag-element">JxtaPropagate</code></span></dt>

                      <dd>one to many pipe.</dd>
                    </dl>
                  </div>
                </dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Name&gt;</code></span></dt>

                <dd>This is an optional name that can be associated with a pipe. The name is not
                required to be unique unless the name is obtained from a centralized naming service
                that guarantee name uniqueness.</dd>
              </dl>
            </div>

            <div class="example">
              <a name="fpipeae" id="fpipeae"></a>

              <p class="title"><b>Example&nbsp;1.3.&nbsp;Pipe Advertisement</b></p>

              <div class="example-contents">
                <pre class="programlisting">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;!DOCTYPE jxta:PipeAdvertisement&gt;

&lt;jxta:PipeAdvertisement xmlns:jxta="http://jxta.org"&gt;
  &lt;Id&gt;urn:jxta:uuid-094AB61B99C14AB694D5BFD56C66E512FF7980EA1E6F4C238A26BB362B34D1F104&lt;/Id&gt; 
  &lt;Type&gt;JxtaUnicast&lt;/Type&gt; 
  &lt;Name&gt;Talk to Me!&lt;/Name&gt;
&lt;/jxta:PipeAdvertisement&gt;
</pre>
              </div>
            </div><br class="example-break">
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-pbp-prm" id="proto-pbp-prm"></a>1.4.2.&nbsp;Pipe
                  Resolver Message</h3>
                </div>
              </div>
            </div>

            <p>For some pipe types, notably <code class="constant">JxtaUnicast</code> and
            <code class="constant">JxtaUnicastSecure</code> it is necessary to locate a peer which
            is listening on the pipe in order to create an Output Pipe. For these pipe types the
            Pipe Service uses the "Pipe Resolver Message". The same message schema is used for both
            the resolve query and for the response.</p>

            <div class="figure">
              <a name="fprms" id="fprms"></a>

              <p class="title"><b>Figure&nbsp;1.10.&nbsp;Pipe Resolver Message Schema</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;xs:element name="<code class="classname">PipeResolver</code>" type="<span class=
"type">jxta:PipeResolver</span>"/&gt;

&lt;xs:simpleType name="<span class="type">PipeResolverMsgType</span>"&gt;
  &lt;xs:restriction base="xs:string"&gt;
    &lt;!-- QUERY --&gt;
    &lt;xs:enumeration value="Query"/&gt;
    &lt;!-- ANSWER --&gt;
    &lt;xs:enumeration value="Answer"/&gt;
  &lt;/xs:restriction&gt;
&lt;/xs:simpleType&gt;

&lt;xs:complexType name="<span class="type">PipeResolver</span>"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element name="MsgType" type="jxta:PipeResolverMsgType"/&gt;
    &lt;xs:element name="PipeId" type="jxta:JXTAID"/&gt;
    &lt;xs:element name="Type" type="xs:string"/&gt;

    &lt;!-- used in the query --&gt;
    &lt;xs:element name="Cached" minOccurs="0" default="true" type="xs:boolean"/&gt;
    &lt;xs:element name="Peer" minOccurs="0" maxOccurs="unbounded" type="jxta:JXTAID" /&gt;

    &lt;!-- used in the answer --&gt;
    &lt;xs:element name="Found" minOccurs="0" type="xs:boolean"/&gt;
    &lt;!-- This should refer to a peer adv, but is instead a whole doc --&gt;
    &lt;xs:element name="PeerAdv" minOccurs="0" type="xs:string"/&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;         
</pre>
              </div>
            </div><br class="figure-break">

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;MsgType&gt;</code></span></dt>

                <dd>
                  <p>Used to indicate if it is the Query or the Answer. May be one of:</p>

                  <div class="variablelist">
                    <dl>
                      <dt><span class="term"><code class="sgmltag-element">Query</code></span></dt>

                      <dd>This is a query.</dd>

                      <dt><span class="term"><code class=
                      "sgmltag-element">Answer</code></span></dt>

                      <dd>This is a response.</dd>
                    </dl>
                  </div>
                </dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;PipeId&gt;</code></span></dt>

                <dd>The Pipe ID which is being resolved.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Type&gt;</code></span></dt>

                <dd>The type of pipe resolution being requested. This value <span class=
                "rfc2119">must</span> match the value of <code class=
                "sgmltag-starttag">&lt;Type&gt;</code> from the Pipe Advertisement.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Cached&gt;</code></span></dt>

                <dd>If <code class="constant">false</code>, peers which do not have the pipe bound
                locally as an Input Pipe <span class="rfc2119">must not</span> respond to the
                query. They <span class="rfc2119">may</span> forward the query to peers which they
                believe to have the pipe bound as an Input Pipe. This feature is deprecated and
                implementations <span class="rfc2119">should</span> treat the tag as always being
                <code class="constant">false</code>.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Peer&gt;</code></span></dt>

                <dd>
                  <p>A peer id. In Queries, if present, it specifies the Peer ID of the only peer
                  from which responses will be expected. Responses from all other peers
                  <span class="rfc2119">may</span> be ignored. This does not guarantee a response
                  to the pipe binding request will be made by the peer. Response to pipe binding
                  requests is always <span class="rfc2119">optional</span>.</p>

                  <p>In Answer messages, all of the peers on which the Input Pipe is known to be
                  bound.</p>
                </dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;Found&gt;</code></span></dt>

                <dd>Used to indicate if the Input Pipe was found on the specified peer.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;PeerAdv&gt;</code></span></dt>

                <dd>Peer Advertisement of the peer which resolved the Input Pipe. This peer
                <span class="rfc2119">may</span> appear in the list of peer ids on which the Input
                Pipe is bound, but this should not be assumed.</dd>
              </dl>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="proto-pbp-wh" id=
                  "proto-pbp-wh"></a>1.4.3.&nbsp;Propagate Pipe Message Header</h3>
                </div>
              </div>
            </div>

            <p>Every message sent on a propagate pipe includes a message element which is used to
            manage the propragation of messages. The message element is stored in the <code class=
            "constant">jxta</code> namespace and has the name <code class=
            "constant">JxtaWireHeader</code>.</p>

            <div class="figure">
              <a name="fwhms" id="fwhms"></a>

              <p class="title"><b>Figure&nbsp;1.11.&nbsp;Propagate Pipe Message Header
              Schema</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;xs:element name="<code class="classname">JxtaWire</code>" type="<span class=
"type">jxta:JxtaWire</span>"/&gt;

&lt;xs:complexType name="<span class="type">jxta:JxtaWire</span>"&gt;
  &lt;xs:sequence&gt;
    &lt;xs:element name="SrcPeer" minOccurs="0" type="jxta:JXTAID" /&gt;
    &lt;xs:element name="PipeId" type="jxta:JXTAID" /&gt;
    &lt;xs:element name="MsgId" type="xs:string" /&gt;
    &lt;xs:element name="TTL" type="xs:unsignedInt" /&gt;
    &lt;xs:element name="VisitedPeer" type="jxta:JXTAID"  maxOccurs="unbounded" /&gt;
  &lt;/xs:sequence&gt;
&lt;/xs:complexType&gt;
</pre>
              </div>
            </div><br class="figure-break">

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;SrcPeer&gt;</code></span></dt>

                <dd>The peer which originated this message.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;PipeId&gt;</code></span></dt>

                <dd>The ID of the pipe on which the message is being sent.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;MsgId&gt;</code></span></dt>

                <dd>Each message has an associated token which is used for duplicate tracking. This
                token is normally generated using a pseudo random source or partially pseudo
                randomly in order to reduce the chance of collisions.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;TTL&gt;</code></span></dt>

                <dd>Each peer attempting to forward this message should first decrement the TTL
                value. If the value reaches zero then the message <span class="rfc2119">should
                not</span> be forwarded to any additional peers.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;VisitedPeer&gt;</code></span></dt>

                <dd>The set of peers which are known to have seen this message. Peers which forward
                propagate pipe messages <span class="rfc2119">should</span> add themselves to this
                list before forwarding the message. They <span class="rfc2119">should</span> also
                avoid forwarding the message to any of the peers listed.</dd>
              </dl>
            </div>
          </div>
        </div>
      </div>

      <div class="chapter" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a name="stdsvc-trans" id=
              "stdsvc-trans"></a>Chapter&nbsp;2.&nbsp;Standard JXTA Message Transports</h2>
            </div>
          </div>
        </div>

        <p>JXTA defines several Message Transport Bindings for implementing JXTA messaging on top
        of existing networks.</p>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="trans-tcpipt" id=
                "trans-tcpipt"></a>2.1.&nbsp;TCP/IP Message Transport</h2>
              </div>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="trans-ipt-tcpipinto" id=
                  "trans-ipt-tcpipinto"></a>2.1.1.&nbsp;Introduction</h3>
                </div>
              </div>
            </div>

            <p>This section describes the TCP/IP Message Transport, the most commonly used Message
            Transport by JXTA. It is named the TCP/IP binding because it uses no other underlying
            protocols whereas other Message Transports build upon, for example, the HTTP <a href=
            "#bib-RFC2616" title="Hypertext Transfer Protocol -- HTTP/1.1">RFC2616</a>, TLS
            <a href="#bib-RFC2246" title="The TLS Protocol : Version 1.0">RFC2246</a>, BEEP
            <a href="#bib-RFC3080" title="The Blocks Extensible Exchange Protocol Core">RFC3080</a>
            <a href="#bib-RFC3081" title="The Blocks Extensible Exchange Protocol Core">RFC3081</a>
            and SMTP <a href="#bib-RFC821" title="Simple Mail Transfer Protocol (SMTP)">RFC821</a>
            protocols. The TCP/IP transport is designed to be the simplest and quickest to
            implement of the JXTA Message Transport bindings. Unfortunately, the TCP/IP Message
            Transport can be adversely affected by the partitioning of the Internet Address Space
            caused by Network Address Translation (NAT), Firewalls, and conflicting use of Private
            IP Address ranges. For these circumstances one of the other Message Transports may be
            more effcient.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="trans-ipt-tcpipchoreo" id=
                  "trans-ipt-tcpipchoreo"></a>2.1.2.&nbsp;Choreography</h3>
                </div>
              </div>
            </div>

            <p>This section describes the protocol exchange implemented by the JXTA TCP/IP Message
            Transport. The two participants operate symmetrically, the message sequence is the same
            for both sides.</p>

            <div class="itemizedlist">
              <ul type="disc">
                <li>Connection Opens</li>

                <li>Welcome Message</li>

                <li>Message(s)</li>

                <li>Connection Closes</li>
              </ul>
            </div>

            <p>The connection <span class="rfc2119">may</span> be closed by either peer following
            the transmission of any number of messages. If a peer discover an error in the
            transmission ( unexpected input, unsupported message content, framing problems, etc. )
            it <span class="rfc2119">must</span> close the connection.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="trans-ipt-tcpipwm" id=
                  "trans-ipt-tcpipwm"></a>2.1.3.&nbsp;Welcome Message</h3>
                </div>
              </div>
            </div>

            <p>The Welcome Message is sent by both peers of a JXTA TCP/IP Communication. It's
            primary purpose is to identify the endpoint address that each peer has associated with
            TCP/IP connections on that interface/port. Additionally, the welcome message provides a
            reasonable &ldquo;<span class="quote">ping</span>&rdquo; response if the only goal of
            the connection is to determine connectivity.</p>

            <p>A peer <span class="rfc2119">should</span> send its Welcome Message as soon as the
            connection is open, but <span class="rfc2119">must not</span> send any Message Bodies
            until it has received a Welcome Message from the remote peer. A peer <span class=
            "rfc2119">must</span> send its peer id as the connection endpoint address. The welcome
            message can be no longer than 4096 octets in length, though in practice it will almost
            always be much shorter.</p>

            <div class="figure">
              <a name="id292218" id="id292218"></a>

              <p class="title"><b>Figure&nbsp;2.1.&nbsp;Welcome Message ABNF</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;WELCOME&gt;      ::= &lt;GREETING&gt; &lt;SPACE&gt; &lt;WELCOMEDEST&gt; &lt;SPACE&gt; 
                   &lt;WELCOMESRC&gt; &lt;SPACE&gt; &lt;WELCOMEPEER&gt; &lt;SPACE&gt;
                   &lt;NOPROP&gt; &lt;SPACE&gt; &lt;VERSION&gt; &lt;CRLF&gt;

&lt;GREETING&gt;     ::= "JXTAHELLO"

&lt;SPACE&gt;        ::=  octect #x20

&lt;WELCOMEDEST&gt;  ::=  &lt;ENDPOINTADDRESS&gt; 

&lt;WELCOMEADDR&gt;  ::= &lt;ENDPOINTADDRESS&gt;

&lt;WELCOMEPEER&gt;  ::=  &lt;JXTAID&gt; 

&lt;NOPROP&gt;       ::=  "0" | "1"

&lt;VERSION&gt;      ::=  "1.1"

&lt;CRLF&gt;         ::=  octet #x0D octet #x0A
</pre>
              </div>
            </div><br class="figure-break">

            <p>This message is designed to be human readable. This primarily for the purpose of
            debugging. This message also allows a peer to be &ldquo;<span class=
            "quote">pinged</span>&rdquo; using Telnet or a web browser.</p>

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;WELCOMEDEST&gt;</code></span></dt>

                <dd>The assumed destination of messages which will be sent on this connection. If a
                received message has no destination address then this is the address that should be
                used.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;WELCOMEADDR&gt;</code></span></dt>

                <dd>The public address of the JXTA Message Transport instance which is handling
                this connection.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;WELCOMEPEER&gt;</code></span></dt>

                <dd>Provides the peer id of the peer you have reached with this connection.</dd>

                <dt><span class="term"><code class=
                "sgmltag-starttag">&lt;NOPROP&gt;</code></span></dt>

                <dd>If <code class="constant">1</code> then the remote peer does not wish to
                receive propagate/broadcast messages on this connection.</dd>
              </dl>
            </div>

            <div class="example">
              <a name="id292318" id="id292318"></a>

              <p class="title"><b>Example&nbsp;2.1.&nbsp;Welcome Message</b></p>

              <div class="example-contents">
                <pre class="programlisting">
JXTAHELLO tcp://69.3.88.186:34368 tcp://209.25.154.236:9701 urn:jxta:uuid-59616261646162614A7874615032503345A8391EC0914B24B264AF31F297A6FD03 1 1.1
</pre>
              </div>
            </div><br class="example-break">
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="trans-ipt-tcpipmt" id=
                  "trans-ipt-tcpipmt"></a>2.1.4.&nbsp;Message Transmission</h3>
                </div>
              </div>
            </div>

            <p>Following the <a href="#trans-ipt-tcpipwm" title=
            "2.1.3.&nbsp;Welcome Message">Welcome Message</a>, the connection is used to send JXTA
            Messages. Each message is preceeded by a small amount of header information. The header
            information is similar to HTTP headers, but is binary encoded to provide for
            lighter-weight parsing.</p>

            <div class="figure">
              <a name="id292350" id="id292350"></a>

              <p class="title"><b>Figure&nbsp;2.2.&nbsp;JXTA Message Package ABNF</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;PACKAGE&gt;     ::= &lt;HEADERBLOCK&gt; &lt;BODY&gt;
                                
&lt;HEADERBLOCK&gt; ::= (&lt;HEADER&gt;)* &lt;EMPTYHEADER&gt;

&lt;HEADER&gt;      ::= &lt;HEADERNAME&gt; &lt;HEADERBODY&gt;

&lt;HEADERNAME&gt;  ::= octet [length] (octets)[length]

&lt;HEADERBODY&gt;  ::= octet [length msb] octet [length lsb] (octets) [length] 

&lt;EMPTYHEADER&gt; ::= octet #x00

&lt;BODY&gt;        ::= octets
</pre>
              </div>
            </div><br class="figure-break">

            <p>The header block will contain both <span class="rfc2119">required</span> headers and
            may contain additional <span class="rfc2119">optional</span> headers. The headers are
            loosely ordered. Headers of a particular type are considered by ordered only with
            respect to other headers of the same type, they have no order relationship to headers
            of other types. In general, headers may appear in any order. The header names are
            case-insensitive canonical UTF8 (NFC) (see <em class="citetitle">Unicode Standard Annex
            #15 : Unicode Normalization Forms</em> <a href="#bib-USA15" title=
            "Unicode Standard Annex #15: Unicode Normalization Forms">USA15</a>) strings.</p>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id292389" id="id292389"></a>2.1.4.1.&nbsp;JXTA
                    Message Package - Required Headers</h4>
                  </div>
                </div>
              </div>

              <p>These headers <span class="rfc2119">must</span> appear in every message
              transmission and have no default values.</p>

              <div class="variablelist">
                <dl>
                  <dt><span class="term"><code class="constant">content-length</code></span></dt>

                  <dd>
                    <p>the length of the <code class="varname">&lt;BODY&gt;</code> portion. If
                    <code class="constant">content-coding</code> headers are included, this length
                    is still the transfer length, not the logical length of the body. The header
                    body is an eight octet &ldquo;<span class="quote">network byte
                    order</span>&rdquo; length.</p>
                  </dd>

                  <dt><span class="term"><code class="constant">content-type</code></span></dt>

                  <dd>
                    <p>The logical type of the message body expressed as a MIME-type. The header
                    body consists of a MIME type encoded in canonical UTF8 (NFC) using the
                    presentation and encoding of <em class="citetitle">Multipurpose Internet Mail
                    Extensions (MIME) Part Two: Media Types</em> <a href="#bib-RFC2046" title=
                    "Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">RFC2046</a>,
                    ie. any encoding specified by RFC 2046 is performed before the string is
                    encoded into UTF8 from the implementation native string representation.</p>

                    <p>Peers <span class="rfc2119">must</span> treat unrecognized <code class=
                    "constant">content-type</code> specifications as an error and close the
                    connection.</p>
                  </dd>
                </dl>
              </div>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id292475" id="id292475"></a>2.1.4.2.&nbsp;JXTA
                    Message Package - Optional Headers</h4>
                  </div>
                </div>
              </div>

              <p>These headers <span class="rfc2119">may</span> appear in any message transmission
              and have no default values.</p>

              <div class="variablelist">
                <dl>
                  <dt><span class="term"><code class="constant">content-coding</code></span></dt>

                  <dd>
                    <p>Specifies a coding which has been applied to the logical message body prior
                    to transmission. The header body contains an eight octet &ldquo;<span class=
                    "quote">network byte order</span>&rdquo; value which was the length of the
                    message body before encoding. This is followed by the Mime-type of the content
                    coding.</p>

                    <p><code class="constant">content-coding</code> headers are listed in the order
                    in which they were applied, ie. The first <code class=
                    "constant">content-coding</code> header was the first coding applied and will
                    be the last to be removed.</p>
                  </dd>
                </dl>
              </div>

              <p>All other possible headers are also <span class="rfc2119">optional</span>.
              Unrecognized optional headers <span class="rfc2119">should</span> be ignored.</p>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="trans-ipt-tcpipmc" id=
                  "trans-ipt-tcpipmc"></a>2.1.5.&nbsp;IP Multicast Usage</h3>
                </div>
              </div>
            </div>

            <p>The TCP Transport may be configured to accept broadcast messages through IP
            Multicast. Messages received are not part of an ongoing connection between peers. Each
            broadcast message is idempotent. The datagram is formed similarily to that used for
            unicasts connections. It consists of :</p>

            <div class="itemizedlist">
              <ul type="disc">
                <li>
                  <p>A Welcome Header</p>
                </li>

                <li>
                  <p>A Message Package Header</p>
                </li>

                <li>
                  <p>A single message</p>
                </li>
              </ul>
            </div>

            <p>Additionally, in order to fully specify the source of the message, the Message
            Package Header <span class="rfc2119">must</span> contain the following header
            field.</p>

            <div class="variablelist">
              <dl>
                <dt><span class="term"><code class="constant">srcEA</code></span></dt>

                <dd>
                  <p>The public addresss of the transport which is sending this broadcast
                  message.</p>
                </dd>
              </dl>
            </div>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="trans-httpt" id=
                "trans-httpt"></a>2.2.&nbsp;HTTP Message Transport</h2>
              </div>
            </div>
          </div>

          <p>The JXTA HTTP Message Transport is logically divided into two functions: the initiator
          and the receiver. The initiator is able to establish connections, whereas the receiver is
          able accept connections. A peer may provide either function or both.</p>

          <p>The HTTP Message Transport is designed to work effeciently with or without HTTP 1.1
          persistent connections and also impose a minimum of overhead beyond that required by HTTP
          itself.</p>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="trans-httpt-msg-init" id=
                  "trans-httpt-msg-init"></a>2.2.1.&nbsp;The HTTP Initiator</h3>
                </div>
              </div>
            </div>

            <p>The HTTP Initiator begins the connection between two peers. The connection is first
            used to determine the logical identities of the participating peers. In most cases,
            this is simply a verification as the connection address was chosen by the initiator to
            communicate with the desired peer.</p>

            <p>The HTTP Initiator uses two types of HTTP request to communicate with the recevier.
            <code class="constant">GET</code> requests are used for determining the logical
            identity of the HTTP Receiver and for polling the HTTP Receiver for messages.
            <code class="constant">POST</code> requests are used for sending and receiving JXTA
            messages with the receiver.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="trans-httpt-msg-rcvr" id=
                  "trans-httpt-msg-rcvr"></a>2.2.2.&nbsp;The HTTP Receiver</h3>
                </div>
              </div>
            </div>

            <p>The HTTP Receiver accepts incoming connections from HTTP initiators. The HTTP
            Receiver then acts in response to HTTP requests from the initiator.</p>

            <p>The HTTP Receiver accepts two types of HTTP request from the initiator, <code class=
            "constant">GET</code> requests and <code class="constant">POST</code> requests.
            <code class="constant">GET</code> requests can be used for two tasks: determining the
            logical identity of the receiver, polling for messages destined to the initiator.
            <code class="constant">POST</code> requests are used to send messages to the receiver
            and optionally to receive messages from the receiver.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="trans-httpt-msg-msgs" id=
                  "trans-httpt-msg-msgs"></a>2.2.3.&nbsp;HTTP Messages</h3>
                </div>
              </div>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id266580" id=
                    "id266580"></a>2.2.3.1.&nbsp;&ldquo;<span class="quote">Ping</span>&rdquo;
                    Command</h4>
                  </div>
                </div>
              </div>

              <p>The &ldquo;<span class="quote">ping</span>&rdquo; command is used to determine the
              logical identity (peer id) of a receiver. It also has the effect of determining
              connectivity (hence the name).</p>

              <p>The HTTP initiator issues a request as follows:</p>

              <div class="variablelist">
                <dl>
                  <dt><span class="term">Request</span></dt>

                  <dd><code class="constant">GET</code></dd>

                  <dt><span class="term">Resource</span></dt>

                  <dd><code class="constant">/</code></dd>
                </dl>
              </div>

              <p>The HTTP Receiver should respond to well-formed requests as follows:</p>

              <div class="variablelist">
                <dl>
                  <dt><span class="term">Response Code</span></dt>

                  <dd>
                    <p><code class="constant">200</code></p>
                  </dd>

                  <dt><span class="term">Required Headers</span></dt>

                  <dd>
                    <div class="variablelist">
                      <dl>
                        <dt><span class="term"><code class=
                        "constant">Content-Length</code></span></dt>

                        <dd>
                          <p><span class="rfc2119">Must</span> always be present.</p>
                        </dd>

                        <dt><span class="term"><code class=
                        "constant">Content-Type</code></span></dt>

                        <dd>
                          <p><span class="rfc2119">Must</span> be <code class=
                          "constant">text/plain;charset="UTF-8"</code>.</p>
                        </dd>
                      </dl>
                    </div>
                  </dd>

                  <dt><span class="term">Response Body</span></dt>

                  <dd>
                    <p>The peer id of the HTTP receiver expressed as a JXTA Endpoint Address.</p>
                  </dd>
                </dl>
              </div>

              <div class="example">
                <a name="id292618" id="id292618"></a>

                <p class="title"><b>Example&nbsp;2.2.&nbsp;HTTP Ping Example</b></p>

                <div class="example-contents">
                  <pre class="programlisting">
<span class="emphasis"><em>Request:</em></span>

GET / HTTP/1.1

<span class="emphasis"><em>Response:</em></span>

200 
content-length=61
content-type=text/plain;charset="UTF-8"

jxta://urn:jxta:uuid-59616261646162614A7874615032503304BD268FA4764960AB93A53D7F15044503
</pre>
                </div>
              </div><br class="example-break">
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id292636" id=
                    "id292636"></a>2.2.3.2.&nbsp;&ldquo;<span class="quote">Poll</span>&rdquo;
                    Command</h4>
                  </div>
                </div>
              </div>

              <p>The &ldquo;<span class="quote">poll</span>&rdquo; command is used by the HTTP
              intiator to retreive a message from the HTTP receivers.</p>

              <p>The HTTP initiator issues a request as follows:</p>

              <div class="variablelist">
                <dl>
                  <dt><span class="term">Request</span></dt>

                  <dd>
                    <p><code class="constant">GET</code></p>
                  </dd>

                  <dt><span class="term">Resource</span></dt>

                  <dd>
                    <p><code class="constant">/</code>&lt;initiator peerid&gt;<code class=
                    "constant">?</code>&lt;responseWait&gt;,&lt;extraResponseWait&gt;,&lt;destAddr&gt;</p>

                    <div class="variablelist">
                      <dl>
                        <dt><span class="term">initiator peerid</span></dt>

                        <dd>
                          <p>The unique portion of the peerid of the initiator, ie. without the
                          <code class="constant">urn:jxta:</code> prefix.</p>
                        </dd>

                        <dt><span class="term">responseWait</span></dt>

                        <dd>
                          <p>The maximum duration in milliseconds which the HTTP Receiver
                          <span class="rfc2119">should</span> wait in order to send a response.
                          Expressed as a decimal integer. This is the longest duration that the
                          initiator is willing to wait for a response. If unspecified, the HTTP
                          receiver <span class="rfc2119">must</span> assume a value of <code class=
                          "constant">0</code> (zero). A delay value of <code class=
                          "constant">0</code> (zero) implies that the HTTP Receiver <span class=
                          "rfc2119">should</span> wait indefinitely until a response is available.
                          Negative wait values imply that the receiver <span class="rfc2119">must
                          not</span> return any response.</p>
                        </dd>

                        <dt><span class="term">lazyClose</span></dt>

                        <dd>
                          <p>The maximum duration in milliseconds during which the HTTP Receiver
                          <span class="rfc2119">should</span> send additional response messages.
                          Expressed as a decimal integer. If unspecified the receiver <span class=
                          "rfc2119">must</span> assume a value of <code class="constant">0</code>
                          (zero). A delay value of <code class="constant">0</code> (zero) implies
                          that the HTTP receiver <span class="rfc2119">should</span> continue to
                          return message responses until the connection is closed. Negative values
                          imply that the receiver <span class="rfc2119">must not</span> return any
                          additional responses.</p>
                        </dd>

                        <dt><span class="term">destAddr</span></dt>

                        <dd>
                          <p>A URI specifying the complete destination address for this connection.
                          If there is no destination specified, the receiver <span class=
                          "rfc2119">must</span> assume a value of the address of the receiving
                          network interface and receiving port. The destination service and service
                          parameter are both uninitialized.</p>
                        </dd>
                      </dl>
                    </div>
                  </dd>
                </dl>
              </div>

              <p>The HTTP Receiver should respond to well-formed requests as follows:</p>

              <div class="variablelist">
                <dl>
                  <dt><span class="term">Response Code</span></dt>

                  <dd>
                    <p><code class="constant">200</code></p>
                  </dd>

                  <dt><span class="term">Required Headers</span></dt>

                  <dd>
                    <div class="variablelist">
                      <dl>
                        <dt><span class="term"><code class=
                        "constant">Content-Type</code></span></dt>

                        <dd>
                          <p><span class="rfc2119">Must</span> match the content type of the JXTA
                          Message Body which forms the response, if any.</p>
                        </dd>
                      </dl>
                    </div>
                  </dd>

                  <dt><span class="term">Response Body</span></dt>

                  <dd>
                    <p>Well-formed JXTA Message Bodies</p>
                  </dd>
                </dl>
              </div>

              <div class="example">
                <a name="id292903" id="id292903"></a>

                <p class="title"><b>Example&nbsp;2.3.&nbsp;HTTP Poll Example</b></p>

                <div class="example-contents">
                  <pre class="programlisting">
<span class="emphasis"><em>Request:</em></span>

POST /uuid-59616261646162614A7874615032503304BD268FA4764960AB93A53D7F15044503?0,0,http://64.81.53.91:8720/EndpointService:jxta-NetGroup/uuid-DEADBEEFDEAFBABAFEEDBABE0000000F05/connect,29988,keep,true HTTP/1.1

<span class="emphasis"><em>Response:</em></span>

200 
content-length=0
</pre>
                </div>
              </div><br class="example-break">
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id292922" id=
                    "id292922"></a>2.2.3.3.&nbsp;&ldquo;<span class="quote">Send</span>&rdquo;
                    Command</h4>
                  </div>
                </div>
              </div>

              <p>The &ldquo;<span class="quote">send</span>&rdquo; command is used by the HTTP
              intiator to send a message to the HTTP receiver and optional retrieve a response
              message.</p>

              <p>The HTTP initiator issues a request as follows:</p>

              <div class="variablelist">
                <dl>
                  <dt><span class="term">Request</span></dt>

                  <dd>
                    <p><code class="constant">POST</code></p>
                  </dd>

                  <dt><span class="term">Resource</span></dt>

                  <dd>
                    <p><code class="constant">/&lt;initiator peerid&gt;</code></p>

                    <div class="variablelist">
                      <dl>
                        <dt><span class="term">initiator peerid</span></dt>

                        <dd>
                          <p>The unique portion of the peerid of the initiator, ie. without the
                          <code class="constant">urn:jxta:</code> prefix.</p>
                        </dd>
                      </dl>
                    </div>
                  </dd>

                  <dt><span class="term">Required Headers</span></dt>

                  <dd>
                    <div class="variablelist">
                      <dl>
                        <dt><span class="term"><code class=
                        "constant">Content-Length</code></span></dt>

                        <dd>
                          <p><span class="rfc2119">Must</span> always be present.</p>
                        </dd>

                        <dt><span class="term"><code class=
                        "constant">Content-Type</code></span></dt>

                        <dd>
                          <p><span class="rfc2119">Must</span> match the content type of the JXTA
                          Message Body which forms the response.</p>
                        </dd>
                      </dl>
                    </div>
                  </dd>

                  <dt><span class="term">Request Body</span></dt>

                  <dd>
                    <p>A well-formed JXTA Message Body</p>
                  </dd>
                </dl>
              </div>

              <p>The HTTP Receiver should respond to well-formed requests as follows:</p>

              <div class="variablelist">
                <dl>
                  <dt><span class="term">Response Code</span></dt>

                  <dd>
                    <p><code class="constant">200</code></p>
                  </dd>
                </dl>
              </div>

              <div class="example">
                <a name="id293081" id="id293081"></a>

                <p class="title"><b>Example&nbsp;2.4.&nbsp;HTTP Send Example</b></p>

                <div class="example-contents">
                  <pre class="programlisting">
<span class="emphasis"><em>Request:</em></span>

POST /uuid-59616261646162614A7874615032503304BD268FA4764960AB93A53D7F15044503 HTTP/1.1

<span class="emphasis"><em>Response:</em></span>
                                
200 
</pre>
                </div>
              </div><br class="example-break">
            </div>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="trans-tlst" id=
                "trans-tlst"></a>2.3.&nbsp;TLS Transport Binding</h2>
              </div>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="trans-tlst-intro" id=
                  "trans-tlst-intro"></a>2.3.1.&nbsp;Introduction</h3>
                </div>
              </div>
            </div>

            <p>JXTA implements &ldquo;<span class="citetitle">IETF RFC 2246 : Transport Layer
            Security Version 1</span>&rdquo; <a href="#bib-RFC2246" title=
            "The TLS Protocol : Version 1.0">RFC2246</a> on top of the <a href="#trans-router"
            title="4.2.&nbsp;Endpoint Router Transport Protocol">Endpoint Router Transport
            Protocol</a> using JXTA messages. Messages are transmitted across one of the other
            Transport Bindings. This implementation provides for secure message delivery between
            Peer Endpoints even when multiple hops across JXTA peers must be used.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="trans-tlst-msgs" id=
                  "trans-tlst-msgs"></a>2.3.2.&nbsp;TLS Messages</h3>
                </div>
              </div>
            </div>

            <p>The TLS protocol exchange is accomplished between the participant peers using JXTA
            Messages. Three JXTA Message Element types are used to implement the protocol:</p>

            <div class="itemizedlist">
              <ul type="disc">
                <li>
                  <p>TLS Contents</p>
                </li>

                <li>
                  <p>Acknowledgements</p>
                </li>

                <li>
                  <p>Retries</p>
                </li>
              </ul>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="trans-tlst-msgs-msg" id=
                    "trans-tlst-msgs-msg"></a>2.3.2.1.&nbsp;TLS Content Element</h4>
                  </div>
                </div>
              </div>

              <p>Used to transfer TLS content between peers.</p>

              <div class="variablelist">
                <dl>
                  <dt><span class="term">Element Name</span></dt>

                  <dd>
                    <p>UTF-8 String containing the sequence number of this element. Sequence
                    numbers are monotonically increasing positive integers.</p>
                  </dd>

                  <dt><span class="term">Element Type</span></dt>

                  <dd>
                    <p><code class="constant">application/x-jxta-tls-block</code></p>
                  </dd>

                  <dt><span class="term">Element Data</span></dt>

                  <dd>
                    <p>TLS Protocol Data per &ldquo;<span class="citetitle">IETF RFC
                    2246</span>&rdquo; <a href="#bib-RFC2246" title=
                    "The TLS Protocol : Version 1.0">RFC2246</a></p>
                  </dd>
                </dl>
              </div>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="trans-tlst-msgs-ack" id=
                    "trans-tlst-msgs-ack"></a>2.3.2.2.&nbsp;TLS ACK Element</h4>
                  </div>
                </div>
              </div>

              <p>Used to transfer TLS content between peers.</p>

              <div class="variablelist">
                <dl>
                  <dt><span class="term">Element Name</span></dt>

                  <dd>
                    <p><code class="constant">TLSACK</code> as a UTF-8 String.</p>
                  </dd>

                  <dt><span class="term">Element Type</span></dt>

                  <dd>
                    <p><code class="constant">application/x-jxta-tls-ack</code></p>
                  </dd>

                  <dt><span class="term">Element Data</span></dt>

                  <dd>
                    <div class="variablelist">
                      <dl>
                        <dt><span class="term">Sequential ACK</span></dt>

                        <dd>
                          <p>Network Byte Order Unsigned 32 Bit Integer. Indicates that the remote
                          peer has successfully received all of the messages with sequence numbers
                          up to and including this value.</p>
                        </dd>

                        <dt><span class="term">Selective ACKs (optional)</span></dt>

                        <dd>
                          <p>Network Byte Order Unsigned 32 Bit Integer(s). Each entry is the
                          sequence number of a message which has been successfully received by the
                          remote peer. Entries are all greater than the sequential ACK value and in
                          numerically increasing order.</p>
                        </dd>
                      </dl>
                    </div>
                  </dd>
                </dl>
              </div>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="trans-tlst-msgs-retry" id=
                    "trans-tlst-msgs-retry"></a>2.3.2.3.&nbsp;Retry Element</h4>
                  </div>
                </div>
              </div>

              <p>Used to signify that this message is being sent as a retry of an apparently failed
              previous send attempt. If present, this element will accompany a <a href=
              "#trans-tlst-msgs-msg" title="2.3.2.1.&nbsp;TLS Content Element">TLS Content
              Element</a>. The element is mostly informational, but can be used to assist in window
              control.</p>

              <div class="variablelist">
                <dl>
                  <dt><span class="term">Element Name</span></dt>

                  <dd>
                    <p><code class="constant">MARKRetr</code> as a UTF-8 String.</p>
                  </dd>

                  <dt><span class="term">Element Type</span></dt>

                  <dd>
                    <p><code class="constant">text/plain;charset="UTF-8"</code></p>
                  </dd>

                  <dt><span class="term">Element Data</span></dt>

                  <dd>
                    <p><code class="constant">TLSRET</code> as a UTF-8 string.</p>
                  </dd>
                </dl>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="chapter" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a name="msgs-fmts" id="msgs-fmts"></a>Chapter&nbsp;3.&nbsp;JXTA
              Message Wire Representations</h2>
            </div>
          </div>
        </div>

        <p>In order to send JXTA messages between peers JXTA a serialized &ldquo;<span class=
        "quote">wire</span>&rdquo; encoding of the message must be created. The standard JXTA
        <a href="#gloss-messageTransport"><em class="firstterm">Message Transport</em></a>
        implementations use a common set of wire encodings. There are two standard message encoding
        formats for JXTA Messages, XML and binary. Each JXTA Message Transport uses the encoding
        format most appropriate for its' capabilities.</p>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="id295118" id=
                "id295118"></a>3.1.&nbsp;General Requirements</h2>
              </div>
            </div>
          </div>

          <p>Message encoding formats for Message Transports <span class="rfc2119">must</span>
          allow for the faithful transmission of arbitrary messages.</p>

          <p>Message Elements with duplicate names <span class="rfc2119">must</span> be
          supported.</p>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="msgs-fmts-jbm" id=
                "msgs-fmts-jbm"></a>3.2.&nbsp;Binary Message Format</h2>
              </div>
            </div>
          </div>

          <p><acronym class="acronym">XML</acronym> and other textual representations such as
          <acronym class="acronym">MIME</acronym> <a href="#bib-RFC2045" title=
          "Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies">
          RFC2045</a> are inefficient for the transmission of arbitrary application data. The JXTA
          Binary Message Format is designed to facilitate the efficient transmission of data
          between peers.</p>

          <p>Message Transports which are capable of sending and receiving unencoded binary data
          will probably prefer to use the Binary Message Format. This format is designed such that
          all components are of declared size, no parsing is ever required to determine
          lengths.</p>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="id295180" id=
                  "id295180"></a>3.2.1.&nbsp;Conventions</h3>
                </div>
              </div>
            </div>

            <p>Multi-byte lengths are sent with the high order byte first (also known as "Big
            Endian" or "Network Byte Order"). All strings start with a two byte length, followed by
            a UTF string value. The message format is specified using <acronym class=
            "acronym">ABNF</acronym> <a href="#bib-RFC2234" title=
            "Augmented BNF for Syntax Specifications: ABNF">RFC2234</a>. <acronym class=
            "acronym">ABNF</acronym> is normally used for <acronym class="acronym">ASCII</acronym>
            grammars, but here we use it to define a byte sequence for a binary message.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="jbmv1" id="jbmv1"></a>3.2.2.&nbsp;Binary Message
                  Version 1</h3>
                </div>
              </div>
            </div>

            <div class="figure">
              <a name="fjbmabnf" id="fjbmabnf"></a>

              <p class="title"><b>Figure&nbsp;3.1.&nbsp;JXTA Binary Message Version 1 ABNF</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
msg        ::= "jxmg"             ; signature (0x6a 0x78 0x6d 0x67)

               version            ; One byte. "0".

               namespaces

               element_count      ; two bytes (binary)

               1* elm

namespaces ::= namespace_count    ; two bytes (binary)

               0* namespace       ; Each namespace is a string

namespace  ::= string
               
string     ::= len2               ; two bytes (binary)
               
               len2 * UTF8 chars  ; characters

elm        ::= "jxel"             ; signature (0x6a 0x78 0x65 0x6c)

               namespaceid        ; one byte (binary)

               flags              ; Indicates which parts follow (binary)

               name               ; element name

               [type]             ; Present if (flags &amp; HAS_TYPE)

               [encoding]         ; Present if (flags &amp; HAS_ENCODING)

               len4               ; Four byte binary length of content

               content            ; element content
         
               [signature]        ; associated signature element
                                  ; Present if (flags &amp; HAS_SIGNATURE) 

name       ::= string

type       ::= string             ; Mime Media Type <a href="#bib-RFC2046" title=
"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">RFC2046</a>

encoding   ::= string             ; Mime Media Type <a href="#bib-RFC2046" title=
"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">RFC2046</a>

content    ::= len4 * byte        ; the bytes of the content.
                    
signature  ::= elm

flags      ::= byte               ; HAS_TYPE      = 0x01;
                                  ; HAS_ENCODING  = 0x02;
                                  ; HAS_SIGNATURE = 0x04;
</pre>
              </div>
            </div><br class="figure-break">

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id295255" id="id295255"></a>3.2.2.1.&nbsp;Message
                    Header</h4>
                  </div>
                </div>
              </div>

              <p>Each message starts with the four byte signature <code class=
              "constant">jxmg</code>. (<code class="constant">0x6a 0x78 0x6d 0x67</code>) The
              signature is used to aid in sanity checking a transport implementation. This is
              followed by a one byte version number which must <code class="constant">0</code>
              (zero). Next is a list of namespaces used by this message. See the production rule
              for namespaces below. And last is a two byte element count followed by the elements
              themselves.</p>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id295280" id=
                    "id295280"></a>3.2.2.2.&nbsp;Namespaces</h4>
                  </div>
                </div>
              </div>

              <p>Each message element a member of a namespace. The namespaces of all elements are
              placed into an ordered list at the start of the message. Each entry in the list is
              assigned an id. The first entry in the list is assigned an id of <code class=
              "constant">2</code>. The id of each successive namespace is one plus the id of the
              preceding namespace. The ids <code class="constant">0</code>, and <code class=
              "constant">1</code> are preassigned. <code class="constant">0</code> represents the
              empty namespace. <code class="constant">1</code> is the <code class=
              "constant">jxta</code> namespace. See <a href="#msgs-namespace" title=
              "5.3.1.&nbsp;Namespace">Namespace</a> for information regarding use of
              namespaces.</p>

              <p>The namespaces portion of a binary message starts with a two byte namespace count.
              The count is followed by a sequence of namespace names. It is permissible for this
              sequence to be empty.</p>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id295328" id="id295328"></a>3.2.2.3.&nbsp;Message
                    Element Header</h4>
                  </div>
                </div>
              </div>

              <p>Each message elements starts with the four byte signature <code class=
              "constant">jxel</code> (<code class="constant">0x6a 0x78 0x65 0x6c</code>). The
              signature is used to aid in sanity checking a transport implementation. Next is the
              namespace id byte. This byte indicates which name space this element belongs to. The
              next byte is the flags byte. Bits in this flag byte indicate which of the optional
              components of an element are present. <code class="constant">HAS_ENCODING</code> is
              currently unsupported.</p>

              <p>The flags are followed by the element name. The MIME Media Type of the element, if
              present, follows the element name. If the type is not specified for an element then
              the type <code class="constant">application/octet-stream</code> is assumed. The
              element type is optionally followed by the encoding type. Next is the four byte
              length of the content, followed by the content data of the element.</p>
            </div>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="jbmv2" id="jbmv2"></a>3.2.3.&nbsp;Binary Message
                  Version 2</h3>
                </div>
              </div>
            </div>

            <p>In mid-2006 a new version of the JXTA Binary Message was developed. This new version
            currently remains optional for all JXTA implementations. The new version was developed
            in order to reduce the wire overhead of JXTA Binary Messages and to improve support for
            larger messages, non-UTF8 character encodings and content encoding.</p>

            <div class="figure">
              <a name="fjbmabnf2" id="fjbmabnf2"></a>

              <p class="title"><b>Figure&nbsp;3.2.&nbsp;JXTA Binary Message Version 2 ABNF</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
msg         ::= "jxmg"             ; signature (0x6a 0x78 0x6d 0x67)
                version            ; One byte. "1".
                flags              ; UTF-16BE String = 0x01
                                   ; UTF-32BE String = 0x02
                namestable         ; Common names used in element headers
                element_count      ; The number of message elements or zero
                element_count * element

namestable  ::= names_count        ; Number of names defined in the table.
                                   ; Does not include implicit names.
                names_count * string  ; names_count names

names_count ::= 2 * byte           ; 2 byte MSB

string      ::= len2               ; string length
                len2 * chars       ; characters (UTF-8, UTF-16BE, UTF-32BE per flags)               

element     ::= "jxel"             ; signature (0x6a 0x78 0x65 0x6c)
                flags              ; Flags for Message Element
                                   ; Body lengths are UINT64 = 0x01
                                   ; Element Name is literal = 0x02
                                   ; Element has MIME Type = 0x04
                                   ; Element has Signature Element = 0x08
                                   ; Element has Content Encodings = 0x10
                                   ; Signature is of encoded element body = 0x20
                namespaceid        ; name
                (name | string)    ; (see flag 0x02)
                [type]             ; (see flag 0x04)
                [encodings]        ; (see flag 0x10)
                elementLen         ; length of content (see flag 0x01)
                content            ; element content
                [signature]        ; associated signature element
                                   ; (see flag 0x10)
                                  
type        ::= name               ; Mime Media Type <a href="#bib-RFC2046" title=
"Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types">RFC2046</a>

encodings   ::= num_encodings      ; number of encodings
                num_encodings * encoding
               
encoding    ::= elementLen         ; pre-encoded element length
                name               ; encoding mime type.
                
num_encodings ::= len1             ; 1 byte length

elementLen  ::= (len4 | len8)      ; len4 or len8 (see flag 0x01)

content     ::= elementLen * byte  ; the bytes of the content.

signature   ::= element            ; signature message element

len1        ::= 1 * byte           ; 1 byte length

len2        ::= 2 * byte           ; 2 byte length (MSB order)

len4        ::= 4 * byte           ; 4 byte length (MSB order)

len8        ::= 8 * byte           ; 8 byte length (MSB order)

name        ::= (2 * byte | 0xFFFF {string})
</pre>
              </div>
            </div><br class="figure-break">

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id295416" id="id295416"></a>3.2.3.1.&nbsp;Message
                    Header</h4>
                  </div>
                </div>
              </div>

              <p>Each JXTA Binary Message begins with a header that provides basic parametes and
              options for the message. The message header starts with a four byte signature,
              <code class="constant">jxmg</code> (<code class="constant">0x6a 0x78 0x6d
              0x67</code>). The signature is used to aid in sanity checking a transport
              implementation. This is followed by a one byte version number which <span class=
              "rfc2119">must</span> be <code class="constant">1</code>. The version number is
              followed by message flags. These flags apply to all message elements included in the
              message. Following the flags is a list of names used by this message. The Message
              Header ends with a count of the Message Elements which will follow. The element count
              <span class="rfc2119">may</span> also be zero indicating that the message elements
              are uncounted.</p>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id295455" id="id295455"></a>3.2.3.2.&nbsp;Names
                    Table</h4>
                  </div>
                </div>
              </div>

              <p>Every message includes a table of names (strings). The names table provides a
              mechanism for looking up commonly used Message Element header strings. Each entry in
              the list is assigned an ID. The first entry in the list is assigned an id of
              <code class="constant">2</code>. The ID of each successive name is one plus the id of
              the preceding names. The IDs <code class="constant">0</code>, <code class=
              "constant">1</code>, and <code class="constant">0xFFFF</code> are preassigned.
              <code class="constant">0</code> represents the empty namespace. <code class=
              "constant">1</code> is the <code class="constant">jxta</code> namespace. <code class=
              "constant">0xFFFF</code> is used when a literal name must be used within a Message
              Element. Generally this happens when messages are created <span>on-the-fly</span> and
              the name was not known at the time the Message was begun.</p>

              <p>The names table portion of a JXTA Binary Message starts with a two byte names
              count. The count is followed by a sequence of name strings. It is permissible for
              this sequence to be empty.</p>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id295508" id="id295508"></a>3.2.3.3.&nbsp;Message
                    Element Header</h4>
                  </div>
                </div>
              </div>

              <p>Each Message Element header starts with the four byte signature <code class=
              "constant">jxel</code> (<code class="constant">0x6a 0x78 0x65 0x6c</code>). The
              signature is used to aid in sanity checking a transport implementation. The signature
              is followed by the Message Element flags. The flags control Message Element specific
              options. The flags are followed by the namespace ID. Each Message Element is part of
              a specific namespace. The name space ID identifies the name of the namespace. The
              namespace is followed by the name of the Message Element. Depending upon the setting
              of flag #1 this may be either a name ID or a string literal. String literals are
              commonly used for names which only occur once within the context of a message.
              Optionally following the Message Element Name is the Message Element Type. The
              Message Element Type identifies the MIME multimedia type associated with this message
              element's content. If no Message Element Type is included then the MIME type is
              assumed to be <code class="constant">application/octet-stream</code>. Following the
              type is the optional content encoding information. If present the content encoding
              information describes any content transformations which have been applied to the
              Message Element content and must be reversed in order to recover the content.
              Examples of content encoding include compression, chunking and encryption. Following
              the content encoding information is the Message Element content length. The content
              length specifies the size in bytes of the encoded Message Element content. The
              content length is followed by the Message Element content which may need to be
              unencoded as it is processed.</p>
            </div>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="id295545" id=
                "id295545"></a>3.3.&nbsp;XML Message Format</h2>
              </div>
            </div>
          </div>

          <p>The XML message format is used for transports which can transmit text but not raw
          binary data. An effort is made to keep the message elements as readable as possible. See
          the section on encoding.</p>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="id295557" id="id295557"></a>3.3.1.&nbsp;Message</h3>
                </div>
              </div>
            </div>

            <div class="example">
              <a name="msgs-exm" id="msgs-exm"></a>

              <p class="title"><b>Example&nbsp;3.1.&nbsp;XML Message</b></p>

              <div class="example-contents">
                <pre class="programlisting">
&lt;?xml version="1.0"?&gt;

&lt;!DOCTYPE Message&gt;

&lt;Message version="0"&gt;
 &lt;Element name="jxta:SourceAddress" mime_type="text/plain"&gt;
  tcp://123.456.205.212
 &lt;/Element&gt;
 &lt;Element name="stuff" encoding="base64" mime_type="application/octet-stream"&gt;
  AAECAwQFBgcICQoLDA0ODxAREhMUFRYXGBkaGxwdHh8gISIjJCUmJygpKissLS4vMDEyMzQ1Njc4
  OTo7PD0+P0BBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWltcXV5fYGFiY2RlZmdoaWprbG1ub3Bx
  cnN0dXZ3eHl6e3x9fn+AgYKDhIWGh4iJiouMjY6PkJGSk5SVlpeYmZqbnJ2en6ChoqOkpaanqKmq
  q6ytrq+wsbKztLW2t7i5uru8vb6/wMHCw8TFxsc=
 &lt;/Element&gt;
&lt;/Message&gt;
   
</pre>
              </div>
            </div><br class="example-break">

            <p>The top level XML element is the Message element. There is one required attribute,
            version. The value of version must be zero "0". The body of the Message element is a
            sequence of Element elements.</p>
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="id295595" id="id295595"></a>3.3.2.&nbsp;Element</h3>
                </div>
              </div>
            </div>

            <p>Each Element must have a name and mime_type attribute. Optionally an encoding
            attribute may be present.</p>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id295606" id="id295606"></a>3.3.2.1.&nbsp;Name</h4>
                  </div>
                </div>
              </div>

              <p>This a required attribute names the element. The name contains the namespace,
              followed by a colon, followed by the simple name of the element.</p>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id295619" id="id295619"></a>3.3.2.2.&nbsp;MIME
                    type</h4>
                  </div>
                </div>
              </div>

              <p>A required attribute indicating the MIME type of the element. If the MIME type was
              not specified in the message, a type of "application/octet-stream" is used.</p>
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="id295632" id=
                    "id295632"></a>3.3.2.3.&nbsp;Encoding</h4>
                  </div>
                </div>
              </div>

              <p>Encoding is <span class="rfc2119">optional</span> The only supported encoding at
              this time is base64. &ldquo;<span class="citetitle">IETF RFC 1521</span>&rdquo;
              <a href="#bib-RFC1521" title=
              "Multipurpose Internet Mail Extensions (MIME) Part One: Mechanisms for Specifying and Describing the Format of Internet Message Bodies">
              RFC1521</a> If the encoding is not present, the content is just treated as a string.
              While name, type and content are parts of a message which will be found in all
              implementations, the encoding is added by this particular format.</p>

              <p>Note: The reference implementation uses the following technique to select
              encoding. If the MIME major type is "text", the content is treated as a string.
              Therefore, no encoding attribute is present on the element. Otherwise the content is
              base64 encoded. This will result in human readable text where possible. The content
              will successfully be transferred using an XML message even if the user has
              incorrectly specified the MIME type. There is no requirement that an implementation
              follow this rule. Implementations will still interoperate whether or not this rule is
              used.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="part" lang="en">
      <div class="titlepage">
        <div>
          <div>
            <h1 class="title"><a name="refimpls" id="refimpls"></a>Part&nbsp;3.&nbsp;JXTA Reference
            Implementations Information</h1>
          </div>
        </div>
      </div>

      <div class="partintro" lang="en">
        <div>
          <div>
            <div>
              <h1 class="title"><a name="refimpls-i" id="refimpls-i"></a>Introduction</h1>
            </div>
          </div>
        </div>

        <p>In order to deliver complete JXTA implementations, the developers of the various JXTA
        Reference Bindings have produced a number of components which implement parts of the JXTA
        specification, but are either not required by the core specification or not specified. This
        section describes some of these components. These implementations may not be present in all
        JXTA Bindings and Binding developers are not required to support them.</p>

        <div class="toc">
          <p><b>Table of Contents</b></p>

          <dl>
            <dt><span class="chapter"><a href="#refimpl-j2se">1. Java 2 SE Reference
            Implementation</a></span></dt>

            <dd>
              <dl>
                <dt><span class="section"><a href="#refimpl-j2se-ids">1.1. JXTA ID
                Formats</a></span></dt>

                <dt><span class="section"><a href="#trans-router-refimpl">1.2. J2SE JXTA Endpoint
                Router Implementation</a></span></dt>
              </dl>
            </dd>
          </dl>
        </div>
      </div>

      <div class="chapter" lang="en">
        <div class="titlepage">
          <div>
            <div>
              <h2 class="title"><a name="refimpl-j2se" id=
              "refimpl-j2se"></a>Chapter&nbsp;1.&nbsp;Java 2 SE Reference Implementation</h2>
            </div>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="refimpl-j2se-ids" id=
                "refimpl-j2se-ids"></a>1.1.&nbsp;JXTA ID Formats</h2>
              </div>
            </div>
          </div>

          <p>These ID Formats have been defined for JXTA Language Binding Reference
          Implementations.</p>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="refimpls-ids-jiuft" id=
                  "refimpls-ids-jiuft"></a>1.1.1.&nbsp;JXTA ID Formats : &ldquo;<span class=
                  "quote">uuid</span>&rdquo; ID Format</h3>
                </div>
              </div>
            </div>

            <p>The Java 2SE reference implementation of JXTA provides an implementation of JXTA IDs
            based upon UUIDs &ldquo;<span class="citetitle">ISO/IEC 11578:1996</span>&rdquo;
            <a href="#bib-ISO11578" title=
            "Information Technology - Open Systems Interconnection - Remote Procedure Call (RPC)">ISO11578</a>.
            This <span class="rfc2119">optional</span> ID Format is identified as the <code class=
            "constant">uuid</code> format. In this implementation, UUIDs are encoded as hex digits
            as the basis generating unique identifiers. At the end of each UUID ID are two hex
            characters that identify the type of JXTA ID. Currently, six ID Types have been
            defined.</p>

            <div class="figure">
              <a name="ids-fuifa" id="ids-fuifa"></a>

              <p class="title"><b>Figure&nbsp;1.1.&nbsp;JXTA "uuid" ID Format ABNF</b></p>

              <div class="figure-contents">
                <pre class="programlisting">
&lt;JXTAUUIDURN&gt;    ::= "urn:" &lt;JXTANS&gt; ":" &lt;JXTAUUIDFMT&gt; "-"
                     &lt;(1*(&lt;hex&gt; &lt;hex&gt;)) &lt;JXTAUUIDIDTYPE&gt;

&lt;JXTAUUIDFMT&gt;    ::= "uuid"

&lt;JXTAUUIDIDTYPE&gt; ::= &lt;CODATID&gt; | &lt;PEERGROUPID&gt; | &lt;PEERID&gt; |
                     &lt;PIPEID&gt; | &lt;MODULECLASSID&gt; | &lt;MODULESPECID&gt;

&lt;CODATID&gt;        ::= "01"

&lt;PEERGROUPID&gt;    ::= "02"

&lt;PEERID&gt;         ::= "03"

&lt;PIPEID&gt;         ::= "04"

&lt;MODULECLASSID&gt;  ::= "05"

&lt;MODULESPECID&gt;   ::= "06"
</pre>
              </div>
            </div><br class="figure-break">

            <p>The characters preceding the ID Type identifier are the encoded form of the ID. The
            encoding consists of a variable number of characters dependant upon the ID Type being
            encoded. To decode the ID the hex characters are translated in order and placed into
            the elements of a byte array from which the various ID components can be retrieved. All
            of JXTA UUID IDs are currently manipulated as 64 byte arrays although no ID Type
            currently requires all the full 64 bytes to encode their contents. Position 63 always
            contains the UUID ID Type value. The remainder of the ID fields are defined beginning
            at Position 0 and increment towards Position 63.</p>

            <p>To make the text presentation of JXTA UUID IDs as URNs more compact implementations
            must not encode the value of unused Positions within the array. Since they are
            irrelevant to the value of the ID they can be assumed to be zero. Implementations must
            also omit from the encoding the value of any Positions that precede the unused portion
            and contain zero. The reference Java implementation accomplishes this by scanning from
            Position 62 towards Position 0 searching for the first non-zero value. It then encodes
            from position 0 to the discovered location followed by the encoding for Position 63.
            The text encoding of a JXTA ID must be canonical according to the URN specification,
            thus this &ldquo;<span class="quote">zero-saving</span>&rdquo; technique <span class=
            "rfc2119">must</span> be present in every implementation.</p>

            <div class="example">
              <a name="id302279" id="id302279"></a>

              <p class="title"><b>Example&nbsp;1.1.&nbsp;Sample "uuid" Format ID</b></p>

              <div class="example-contents">
                <pre class="programlisting">
urn:jxta:uuid-00030102040501

<span class="emphasis"><em>Decodes to:</em></span>

0:00  1:03  2:01  3:02  4:04  5:05  6-62:00  63:01
</pre>
              </div>
            </div><br class="example-break">
          </div>

          <div class="section" lang="en">
            <div class="titlepage">
              <div>
                <div>
                  <h3 class="title"><a name="refimpls-ids-jufd" id=
                  "refimpls-ids-jufd"></a>1.1.2.&nbsp;JXTA UUID Field Definitions</h3>
                </div>
              </div>
            </div>

            <p>Each of the six JXTA ID Types has a specific definition for how its fields are
            represented within the common 64-byte array structure. Common between the six ID Types
            is the definition of Position 63. This location is reserved for the ID Type.</p>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="refimpls-ids-jufd-jucif" id=
                    "refimpls-ids-jufd-jucif"></a>1.1.2.1.&nbsp;JXTA UUID Codat ID Fields</h4>
                  </div>
                </div>
              </div>

              <p>Each Codat is assigned a unique codat id that enables canonical references to be
              made to the codat in the context of a specific peer group. A CodatID is formed by the
              conjunction of a PeerGroupID, a randomly chosen value that has a high probability of
              being unique, and an optional SHA1 cryptographic hash of the codat contents.</p>

              <div class="figure">
                <a name="id302325" id="id302325"></a>

                <p class="title"><b>Figure&nbsp;1.2.&nbsp;JXTA UUID Codat ID Fields</b></p>

                <div class="figure-contents">
                  <div class="informaltable">
                    <table border="1" width="100%">
                      <colgroup>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                      </colgroup>

                      <tbody>
                        <tr>
                          <td>0:Group MSB</td>

                          <td colspan="5">0-15:...GROUP UUID...</td>
                        </tr>

                        <tr>
                          <td colspan="5">...GROUP UUID (cont.)...</td>

                          <td>15:Group LSB</td>
                        </tr>

                        <tr>
                          <td>16:ID MSB</td>

                          <td colspan="5">16-31:...CODAT UUID...</td>
                        </tr>

                        <tr>
                          <td colspan="5">...CODAT UUID (cont.)...</td>

                          <td>31:ID LSB</td>
                        </tr>

                        <tr>
                          <td>32:Hash</td>

                          <td colspan="5">32-51:CODAT SHA1 Hash...</td>
                        </tr>

                        <tr>
                          <td colspan="6">...CODAT SHA1 Hash...</td>
                        </tr>

                        <tr>
                          <td colspan="2">...CODAT SHA1 Hash</td>

                          <td>51:Hash</td>

                          <td colspan="3">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="5">&nbsp;</td>

                          <td>63:ID Type</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div><br class="figure-break">
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="refimpls-ids-jufd-jupgif" id=
                    "refimpls-ids-jufd-jupgif"></a>1.1.2.2.&nbsp;JXTA UUID PeerGroup ID Fields</h4>
                  </div>
                </div>
              </div>

              <p>Each peer group is assigned a unique id that enables canonical references to that
              peer group.</p>

              <div class="figure">
                <a name="id302488" id="id302488"></a>

                <p class="title"><b>Figure&nbsp;1.3.&nbsp;JXTA UUID PeerGroup ID Fields</b></p>

                <div class="figure-contents">
                  <div class="informaltable">
                    <table border="1" width="100%">
                      <colgroup>
                        <col>
                        <col>
                        <col>
                        <col>
                      </colgroup>

                      <tbody>
                        <tr>
                          <td>0:MSB</td>

                          <td colspan="3">0-15...GROUP UUID...</td>
                        </tr>

                        <tr>
                          <td colspan="3">...GROUP UUID (cont.)</td>

                          <td>15:LSB</td>
                        </tr>

                        <tr>
                          <td>0:MSB</td>

                          <td colspan="3">0-15...PARENT GROUP UUID...</td>
                        </tr>

                        <tr>
                          <td colspan="3">...PARENT GROUP UUID (cont.)</td>

                          <td>15:LSB</td>
                        </tr>

                        <tr>
                          <td colspan="4">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="4">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="4">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="3">&nbsp;</td>

                          <td>63:IDType</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div><br class="figure-break">
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="refimpls-ids-jufd-jupeif" id=
                    "refimpls-ids-jufd-jupeif"></a>1.1.2.3.&nbsp;JXTA UUID Peer ID Fields</h4>
                  </div>
                </div>
              </div>

              <p>Each peer is assigned a unique peer id that enables canonical references to be
              made to the peer in the context of a specific peer group.</p>

              <div class="figure">
                <a name="id302623" id="id302623"></a>

                <p class="title"><b>Figure&nbsp;1.4.&nbsp;JXTA UUID Peer ID Fields</b></p>

                <div class="figure-contents">
                  <div class="informaltable">
                    <table border="1" width="100%">
                      <colgroup>
                        <col>
                        <col>
                        <col>
                        <col>
                      </colgroup>

                      <tbody>
                        <tr>
                          <td>0:Group MSB</td>

                          <td colspan="3">0-15...GROUP UUID...</td>
                        </tr>

                        <tr>
                          <td colspan="3">...GROUP UUID (cont.)</td>

                          <td>15:Group LSB</td>
                        </tr>

                        <tr>
                          <td>16:ID MSB</td>

                          <td colspan="3">16-31:...PEER UUID...</td>
                        </tr>

                        <tr>
                          <td colspan="3">...PEER UUID (cont.)...</td>

                          <td>31:ID LSB</td>
                        </tr>

                        <tr>
                          <td colspan="4">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="4">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="4">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="3">&nbsp;</td>

                          <td>63:IDType</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div><br class="figure-break">
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="refimpls-ids-jufd-jupiif" id=
                    "refimpls-ids-jufd-jupiif"></a>1.1.2.4.&nbsp;JXTA UUID Pipe ID Fields</h4>
                  </div>
                </div>
              </div>

              <p>Each pipe is assigned a unique pipe id that enables canonical references to be
              made to the pipe in the context of a specific peer group.</p>

              <div class="figure">
                <a name="id302758" id="id302758"></a>

                <p class="title"><b>Figure&nbsp;1.5.&nbsp;JXTA UUID Pipe ID Fields</b></p>

                <div class="figure-contents">
                  <div class="informaltable">
                    <table border="1" width="100%">
                      <colgroup>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                        <col>
                      </colgroup>

                      <thead>
                        <tr>
                          <th>0</th>

                          <th>1</th>

                          <th>2</th>

                          <th>3</th>

                          <th>4</th>

                          <th>5</th>

                          <th>6</th>

                          <th>7</th>
                        </tr>
                      </thead>

                      <tfoot>
                        <tr>
                          <th>0</th>

                          <th>1</th>

                          <th>2</th>

                          <th>3</th>

                          <th>4</th>

                          <th>5</th>

                          <th>6</th>

                          <th>7</th>
                        </tr>
                      </tfoot>

                      <tbody>
                        <tr>
                          <td>0:Group MSB</td>

                          <td colspan="7">0-15...GROUP UUID...</td>
                        </tr>

                        <tr>
                          <td colspan="7">...GROUP UUID (cont.)</td>

                          <td>15:Group LSB</td>
                        </tr>

                        <tr>
                          <td>16:ID MSB</td>

                          <td colspan="7">16-31:...PIPE UUID...</td>
                        </tr>

                        <tr>
                          <td colspan="7">...PIPE UUID (cont.)...</td>

                          <td>31:ID LSB</td>
                        </tr>

                        <tr>
                          <td colspan="8">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="8">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="8">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="7">&nbsp;</td>

                          <td>63:IDType</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div><br class="figure-break">
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="refimpls-ids-jufd-jumcif" id=
                    "refimpls-ids-jufd-jumcif"></a>1.1.2.5.&nbsp;JXTA UUID Module Class ID
                    Fields</h4>
                  </div>
                </div>
              </div>

              <p>Each Module is assigned a Module service id that enables canonical references to
              be made to the service in the context of a specific peer group and optionally within
              the context of a specific peer.</p>

              <div class="figure">
                <a name="id302991" id="id302991"></a>

                <p class="title"><b>Figure&nbsp;1.6.&nbsp;JXTA UUID Module Class ID Fields</b></p>

                <div class="figure-contents">
                  <div class="informaltable">
                    <table border="1" width="100%">
                      <colgroup>
                        <col>
                        <col>
                        <col>
                        <col>
                      </colgroup>

                      <tbody>
                        <tr>
                          <td>0:MSB</td>

                          <td colspan="3">0-15...MODULE UUID...</td>
                        </tr>

                        <tr>
                          <td colspan="3">...MODULE UUID (cont.)</td>

                          <td>15:LSB</td>
                        </tr>

                        <tr>
                          <td colspan="4">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="4">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="4">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="4">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="4">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="3">&nbsp;</td>

                          <td>63:IDType</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div><br class="figure-break">
            </div>

            <div class="section" lang="en">
              <div class="titlepage">
                <div>
                  <div>
                    <h4 class="title"><a name="refimpls-ids-jufd-jumsif" id=
                    "refimpls-ids-jufd-jumsif"></a>1.1.2.6.&nbsp;JXTA UUID Module Spec ID
                    Fields</h4>
                  </div>
                </div>
              </div>

              <p>Each Service is assigned a unique service id that enables canonical references to
              be made to the service in the context of a specific peer group and optionally within
              the context of a specific peer.</p>

              <div class="figure">
                <a name="id303119" id="id303119"></a>

                <p class="title"><b>Figure&nbsp;1.7.&nbsp;JXTA UUID Module Spec ID Fields</b></p>

                <div class="figure-contents">
                  <div class="informaltable">
                    <table border="1" width="100%">
                      <colgroup>
                        <col>
                        <col>
                        <col>
                        <col>
                      </colgroup>

                      <tbody>
                        <tr>
                          <td>0:CLASS MSB</td>

                          <td colspan="3">0-15...MODULE CLASS...</td>
                        </tr>

                        <tr>
                          <td colspan="3">...MODULE CLASS (cont.)</td>

                          <td>15:CLASS LSB</td>
                        </tr>

                        <tr>
                          <td>16:SPEC MSB</td>

                          <td colspan="3">16-31:...SPEC UUID...</td>
                        </tr>

                        <tr>
                          <td colspan="3">...SPEC UUID (cont.)...</td>

                          <td>31:SPEC LSB</td>
                        </tr>

                        <tr>
                          <td colspan="4">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="4">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="4">&nbsp;</td>
                        </tr>

                        <tr>
                          <td colspan="3">&nbsp;</td>

                          <td>63:IDType</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                </div>
              </div><br class="figure-break">
            </div>
          </div>
        </div>

        <div class="section" lang="en">
          <div class="titlepage">
            <div>
              <div>
                <h2 class="title" style="clear: both"><a name="trans-router-refimpl" id=
                "trans-router-refimpl"></a>1.2.&nbsp;J2SE JXTA Endpoint Router Implementation</h2>
              </div>
            </div>
          </div>

          <p>This section describes the implementation of the Endpoint Router in the J2SE
          implementation of JXTA. This is just an example of how the EndpointRouter protocol can be
          implemented, but there is several other manners the Endpoint Router could be implemented.
          Other optimizations or robustness mechanisms could be added or changed in other
          implementations of the Endpoint Router.</p>

          <p>In this section, the term Endpoint Router refers to the J2SE Endpoint Router
          implementation and not to the Endpoint Router protocol as the term has been used in the
          previous sections.</p>

          <p>Also, the current implementation does not yet implement the entire protocol (pending
          tasks). What is not yet implemented is outlined in this document.</p>

          <p>The Endpoint Router manages a cache of routes to destination peers.</p>

          <p>[PENDING TASK] Currently the cache does not associate a life time to a route in the
          cache. This is needed as routes are dynamic and constantly changing in a peer to peer
          network. A life time of 15-20 minutes is probably a good guess.</p>

          <p>When the Endpoint Router is asked to send a message to a peer for which it does not
          yet have a route, it sends out a RouteQuery, using the Resolver Service. When the router
          is asked to route a message, if the message contains the forward route, this route is
          used, even if the router knows another route (the forward route within the message takes
          precedence). If the forward route is not valid (the next hop in the list is not
          reachable), or if the message does not contain a forward route, the local route is then
          used. If there is no local route, then the message is dropped.</p>

          <p>[PENDING TASK] When a router is asked to route a message, and when no route is
          available, it should search for a route (sending a RouteQuery), and/or send a NACK
          message back to the source of the message.</p>

          <p>When the Endpoint Router receives a RouteQuery, if it knows a route, it answer with a
          RouteResponse including the forward route.</p>

          <p>[PENDING TASK] PingQuery and PingResponse are not yet implemented. In particular,
          routes should be checked once in a while.</p>

          <p>[PENDING TASK] NACK is not yet implemented.</p>

          <p>When the Endpoint Router receives an incoming message, and when the incoming message
          contains a reverse route, the reverse route is added into the local cache of routes. Note
          that the Endpoint Router detects loops and other errors both in reverse route and forward
          route.</p>

          <p>The Endpoint Router does not remove its message element, even when routed message is
          eventually delivered locally to the destination application. This allow the application
          to decide to forward the message to another peer, while keeping the routing information,
          especially the reverse route, allowing the final destination to respond to the original
          source of the message without having to issue a RouteQuery.</p>
        </div>
      </div>
    </div>

    <div class="glossary">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="id305291" id="id305291"></a>Glossary</h2>
          </div>
        </div>
      </div>

      <dl>
        <dt><a name="gloss-adv" id="gloss-adv"></a>Advertisement</dt>

        <dd>
          <p>JXTA's language-neutral metadata structures that describe peer resources such as
          peers, peer groups, pipes, and services. Advertisements are represented as XML
          documents.</p>
        </dd>

        <dt><a name="gloss-binding" id="gloss-binding"></a>Binding</dt>

        <dd>
          <p>An implementation of the JXTA protocols for a particular environment (e.g., the Java
          J2SE platform binding).</p>
        </dd>

        <dt><a name="gloss-codat" id="gloss-codat"></a>Codat</dt>

        <dd>
          <p>The combination of a content (commonly a document or file) and a JXTA ID.</p>
        </dd>

        <dt><a name="gloss-credential" id="gloss-credential"></a>Credential</dt>

        <dd>
          <p>A token used to uniquely identify the sender of a message; can be used to provide
          message authorization.</p>
        </dd>

        <dt><a name="gloss-jxta" id="gloss-jxta"></a>JXTA</dt>

        <dd>
          <p>JXTA is not an acronym, and in particular the &ldquo;<span class=
          "quote">J</span>&rdquo;does not refer to Java. JXTA is a made up word coined by the
          project's original sponsor, Bill Joy. JXTA is derived from the word Juxtapose, as in side
          by side. It is a recognition that peer-to-peer is juxtaposed to client server or Web
          based computing -- what is considered today's traditional computing model.</p>

          <div class="variablelist">
            <dl>
              <dt><span class="term"><span class="bold"><strong>jux ta
              pose</strong></span></span></dt>

              <dd><span class="emphasis"><em>tr. v.</em></span>To place side by side, especially
              for comparison or contrast.</dd>
            </dl>
          </div>
        </dd>

        <dt><a name="gloss-jcs" id="gloss-jcs"></a>JXTA Core Specification</dt>

        <dd>
          <p>The JXTA Core Specification consists of the required components and behaviours which
          are present in all conforming JXTA implementations. This includes the Endpoint Routing
          Protocol (<acronym class="acronym">ERP</acronym>) and the Peer Resolver Protocol
          (<acronym class="acronym">PRP</acronym>).</p>
        </dd>

        <dt><a name="gloss-idformat" id="gloss-idformat"></a>JXTA ID Format</dt>

        <dd>
          <p>A JXTA ID Format is a scheme for representing it IDs of JXTA entities. Each ID Format
          is identified by as sub-namespace of the URN namespace "jxta".</p>
        </dd>

        <dt><a name="gloss-idtype" id="gloss-idtype"></a>JXTA ID Type</dt>

        <dd>
          <p>A JXTA ID Type is describes the characteristics of JXTA IDs which refer to a
          particular sort of JXTA entity. Currently this includes peer groups, peers, codats,
          pipes, module classes, module specifications and module impelmentations, but may be
          extended to refer to other types of entities in the future or in specific
          implementations.</p>
        </dd>

        <dt><a name="gloss-jss" id="gloss-jss"></a>JXTA Standard Services</dt>

        <dd>
          <p>The JXTA Standard Services are optional JXTA components and behaviours.
          Implementations are not required to provide these services, but are strongly <span class=
          "rfc2119">recommended</span> to do so. This includes Peer Discovery Protocol
          (<acronym class="acronym">PDP</acronym>), Peer Information Protocol (<acronym class=
          "acronym">PIP</acronym>), Pipe Binding Protocol (<acronym class="acronym">PBP</acronym>)
          and Rendezvous Protocol (<acronym class="acronym">RVP</acronym>).</p>
        </dd>

        <dt><a name="gloss-messageTransport" id="gloss-messageTransport"></a>Message Transport</dt>

        <dd>
          <p>A Message Transport is responsible for sending and/or receiving JXTA messages via an
          external network. A Message Transport may use whatever wire protocol it wishes in order
          to transmit messages between peers. Message Transports <span class="rfc2119">must</span>
          pass the messages between peers unaltered.</p>
        </dd>

        <dt><a name="gloss-module" id="gloss-module"></a>Module</dt>

        <dd>
          <p>An abstraction used to represent any piece of "code" used to implement a behavior in
          the JXTA world. Network services are the mode common example of behavior that can be
          instantiated on a peer.</p>
        </dd>

        <dt><a name="gloss-moduleclass" id="gloss-moduleclass"></a>Module Class</dt>

        <dd>
          <p>Represents an expected behavior and an expected binding to support the module; is used
          primarily to advertise the existence of a behavior.</p>
        </dd>

        <dt><a name="gloss-moduleimpl" id="gloss-moduleimpl"></a>Module Implementation</dt>

        <dd>
          <p>The implementation of a given module specification; there may be multiple module
          implementations for a given module specification.</p>
        </dd>

        <dt><a name="gloss-modulespec" id="gloss-modulespec"></a>Module Specification</dt>

        <dd>
          <p>Describes a specification of a given module class; it is one approach to providing the
          functionality that a module class implies. There can be multiple module specifications
          for a given module class. The module specification is primarily used to access a
          module.</p>
        </dd>

        <dt><a name="gloss-p2p" id="gloss-p2p"></a>Peer-to-Peer (P2P)</dt>

        <dd>
          <p>A decentralized networking paradigm in which distributed nodes, or peers, communicate
          and work collaboratively to provide services.</p>
        </dd>

        <dt><a name="gloss-peer" id="gloss-peer"></a>Peer</dt>

        <dd>
          <p>A peer is any uniquely identifiable networked device which is capable of interacting
          with other network devices using standardized protocols.</p>
        </dd>

        <dt><a name="gloss-peergroup" id="gloss-peergroup"></a>Peer Group</dt>

        <dd>
          <p>A collection of peers that have a common set of interests and have agreed upon a
          common set of services.</p>
        </dd>

        <dt><a name="gloss-prp" id="gloss-prp"></a>Peer Resolver Protocol</dt>

        <dd>
          <p>The Peer Resolver Protocol provides a generic query/response interface applications
          and services can use for building resolution services.</p>
        </dd>

        <dt><a name="gloss-rdv" id="gloss-rdv"></a>Rendezvous Peer</dt>

        <dd>
          <p>A peer which assumes additional responsibilities for the propagation of messages
          within a peer group.</p>
        </dd>

        <dt><a name="gloss-resolverservice" id="gloss-resolverservice"></a>Resolver Service</dt>

        <dd>
          <p>Resolver Services are responsible for the routing and processing queries and responses
          within peer groups. Resolver Services use the Peer Resolver Protocol (<acronym class=
          "acronym">PRP</acronym>) for transmission of queries between peers.</p>
        </dd>

        <dt><a name="gloss-xml" id="gloss-xml"></a><acronym class="acronym">XML</acronym></dt>

        <dd>
          <p>(From &ldquo;<span class="citetitle">Extensible Markup Language (XML)
          1.0</span>&rdquo; <a href="#bib-XML10" title=
          "Extensible Markup Language (XML) 1.0 (Second Edition)">XML10</a> ) : Extensible Markup
          Language, abbreviated <acronym class="acronym">XML</acronym>, describes a class of data
          objects called <acronym class="acronym">XML</acronym> documents and partially describes
          the behavior ofcomputer programs which process them.</p>
        </dd>
      </dl>
    </div>

    <div class="bibliography">
      <div class="titlepage">
        <div>
          <div>
            <h2 class="title"><a name="id306259" id="id306259"></a>Bibliography</h2>
          </div>
        </div>
      </div>

      <div class="biblioentry">
        <a name="bib-ISO11578" id="bib-ISO11578"></a>

        <p>[<abbr class="abbrev">ISO11578</abbr>] <span class="title"><i>Information Technology -
        Open Systems Interconnection - Remote Procedure Call (RPC)</i> .</span> <span class=
        "date">1996.</span> <span class="biblioset"><i>ISO/IEC</i>. <span class=
        "volumenum">11578:1996.</span></span> <span class="publisher"><span class=
        "publishername">ISO (International Organization for Standardization).</span></span></p>
      </div>

      <div class="biblioentry">
        <a name="bib-RFC821" id="bib-RFC821"></a>

        <p>[<abbr class="abbrev">RFC821</abbr>] <span class="title"><i><a href=
        "http://ietf.org/rfc/rfc821.txt" target="_top">Simple Mail Transfer Protocol (SMTP)</a></i>
        .</span> <span class="authorgroup"><span class="firstname">Jonathan</span> <span class=
        "othername">B.</span> <span class="surname">Postel</span>.</span> <span class="date">August
        1982.</span> <span class="biblioset"><i>IETF RFC</i>. <span class=
        "volumenum">821.</span></span> <span class="publisher"><span class="publishername">Internet
        Engineering Task Force.</span></span></p>
      </div>

      <div class="biblioentry">
        <a name="bib-RFC1521" id="bib-RFC1521"></a>

        <p>[<abbr class="abbrev">RFC1521</abbr>] <span class="title"><i><a href=
        "http://ietf.org/rfc/rfc821.txt" target="_top">Multipurpose Internet Mail Extensions (MIME)
        Part One: Mechanisms for Specifying and Describing the Format of Internet Message
        Bodies</a></i> .</span> <span class="authorgroup"><span class="firstname">N.</span>
        <span class="surname">Borenstein</span> and <span class="firstname">N.</span> <span class=
        "surname">Freed</span>.</span> <span class="date">September 1993.</span> <span class=
        "biblioset"><i>IETF RFC</i>. <span class="volumenum">1521.</span></span> <span class=
        "publisher"><span class="publishername">Internet Engineering Task Force.</span></span></p>
      </div>

      <div class="biblioentry">
        <a name="bib-RFC2045" id="bib-RFC2045"></a>

        <p>[<abbr class="abbrev">RFC2045</abbr>] <span class="title"><i><a href=
        "http://ietf.org/rfc/rfc2046.txt" target="_top">Multipurpose Internet Mail Extensions
        (MIME) Part One: Format of Internet Message Bodies</a></i> .</span> <span class=
        "authorgroup"><span class="firstname">N.</span> <span class="surname">Freed</span> and
        <span class="firstname">N.</span> <span class="surname">Borenstein</span>.</span>
        <span class="date">November 1996.</span> <span class="biblioset"><i>IETF RFC</i>.
        <span class="volumenum">2045.</span></span> <span class="publisher"><span class=
        "publishername">Internet Engineering Task Force.</span></span></p>
      </div>

      <div class="biblioentry">
        <a name="bib-RFC2046" id="bib-RFC2046"></a>

        <p>[<abbr class="abbrev">RFC2046</abbr>] <span class="title"><i><a href=
        "http://ietf.org/rfc/rfc2046.txt" target="_top">Multipurpose Internet Mail Extensions
        (MIME) Part Two: Media Types</a></i> .</span> <span class="authorgroup"><span class=
        "firstname">N.</span> <span class="surname">Freed</span> and <span class=
        "firstname">N.</span> <span class="surname">Borenstein</span>.</span> <span class=
        "date">November 1996.</span> <span class="biblioset"><i>IETF RFC</i>. <span class=
        "volumenum">2046.</span></span> <span class="publisher"><span class=
        "publishername">Internet Engineering Task Force.</span></span></p>
      </div>

      <div class="biblioentry">
        <a name="bib-RFC2119" id="bib-RFC2119"></a>

        <p>[<abbr class="abbrev">RFC2119</abbr>] <span class="title"><i><a href=
        "http://ietf.org/rfc/rfc2119.txt" target="_top">Key words for use in RFCs to Indicate
        Requirement Levels</a></i> .</span> <span class="authorgroup"><span class=
        "firstname">S.</span> <span class="surname">Bradner</span>.</span> <span class="date">March
        1997.</span> <span class="biblioset"><i>IETF RFC</i>. <span class=
        "volumenum">2119.</span></span> <span class="publisher"><span class=
        "publishername">Internet Engineering Task Force.</span></span></p>
      </div>

      <div class="biblioentry">
        <a name="bib-RFC2141" id="bib-RFC2141"></a>

        <p>[<abbr class="abbrev">RFC2141</abbr>] <span class="title"><i><a href=
        "http://ietf.org/rfc/rfc2141.txt" target="_top">URN Syntax</a></i> .</span> <span class=
        "authorgroup"><span class="firstname">R.</span> <span class="surname">Moats</span>.</span>
        <span class="date">May 1997.</span> <span class="biblioset"><i>IETF RFC</i>. <span class=
        "volumenum">2141.</span></span> <span class="publisher"><span class=
        "publishername">Internet Engineering Task Force.</span></span></p>
      </div>

      <div class="biblioentry">
        <a name="bib-RFC2234" id="bib-RFC2234"></a>

        <p>[<abbr class="abbrev">RFC2234</abbr>] <span class="title"><i><a href=
        "http://ietf.org/rfc/rfc2234.txt" target="_top">Augmented BNF for Syntax Specifications:
        ABNF</a></i> .</span> <span class="authorgroup"><span class="firstname">P.</span>
        <span class="surname">Overell</span> and <span class="firstname">D.</span> <span class=
        "surname">Crocker</span>.</span> <span class="date">November 1997.</span> <span class=
        "biblioset"><i>IETF RFC</i>. <span class="volumenum">2234.</span></span> <span class=
        "publisher"><span class="publishername">Internet Engineering Task Force.</span></span></p>
      </div>

      <div class="biblioentry">
        <a name="bib-RFC2246" id="bib-RFC2246"></a>

        <p>[<abbr class="abbrev">RFC2246</abbr>] <span class="title"><i><a href=
        "http://ietf.org/rfc/rfc2246.txt" target="_top">The TLS Protocol : Version 1.0</a></i>
        .</span> <span class="authorgroup"><span class="firstname">Tim</span> <span class=
        "surname">Dierks</span> and <span class="firstname">Christopher</span> <span class=
        "surname">Allen</span>.</span> <span class="date">January 1999.</span> <span class=
        "biblioset"><i>IETF RFC</i>. <span class="volumenum">2246.</span></span> <span class=
        "publisher"><span class="publishername">Internet Engineering Task Force.</span></span></p>
      </div>

      <div class="biblioentry">
        <a name="bib-RFC2616" id="bib-RFC2616"></a>

        <p>[<abbr class="abbrev">RFC2616</abbr>] <span class="title"><i><a href=
        "http://ietf.org/rfc/rfc2616.txt" target="_top">Hypertext Transfer Protocol --
        HTTP/1.1</a></i> .</span> <span class="authorgroup"><span class="firstname">Roy</span>
        <span class="othername">T.</span> <span class="surname">Fielding</span>, <span class=
        "firstname">James</span> <span class="surname">Gettys</span>, <span class=
        "firstname">Jeffrey</span> <span class="othername">C.</span> <span class=
        "surname">Mogul</span>, <span class="firstname">Henrik</span> <span class=
        "othername">Frystyk</span> <span class="surname">Nielsen</span>, and <span class=
        "firstname">Larry</span> <span class="surname">Masinter</span>.</span> <span class=
        "date">June 1999.</span> <span class="biblioset"><i>IETF RFC</i>. <span class=
        "volumenum">2616.</span></span> <span class="publisher"><span class=
        "publishername">Internet Engineering Task Force.</span></span></p>
      </div>

      <div class="biblioentry">
        <a name="bib-RFC3080" id="bib-RFC3080"></a>

        <p>[<abbr class="abbrev">RFC3080</abbr>] <span class="title"><i><a href=
        "http://ietf.org/rfc/rfc3080.txt" target="_top">The Blocks Extensible Exchange Protocol
        Core</a></i> .</span> <span class="authorgroup"><span class="firstname">Marshall</span>
        <span class="othername">T.</span> <span class="surname">Rose</span>.</span> <span class=
        "date">March 2001.</span> <span class="biblioset"><i>IETF RFC</i>. <span class=
        "volumenum">3080.</span></span> <span class="publisher"><span class=
        "publishername">Internet Engineering Task Force.</span></span></p>
      </div>

      <div class="biblioentry">
        <a name="bib-RFC3081" id="bib-RFC3081"></a>

        <p>[<abbr class="abbrev">RFC3081</abbr>] <span class="title"><i><a href=
        "http://ietf.org/rfc/rfc3081.txt" target="_top">The Blocks Extensible Exchange Protocol
        Core</a></i> .</span> <span class="authorgroup"><span class="firstname">Marshall</span>
        <span class="othername">T.</span> <span class="surname">Rose</span>.</span> <span class=
        "date">March 2001.</span> <span class="biblioset"><i>IETF RFC</i>. <span class=
        "volumenum">3081.</span></span> <span class="publisher"><span class=
        "publishername">Internet Engineering Task Force.</span></span></p>
      </div>

      <div class="biblioentry">
        <a name="bib-USA15" id="bib-USA15"></a>

        <p>[<abbr class="abbrev">USA15</abbr>] <span class="title"><i><a href=
        "http://www.unicode.org/unicode/reports/tr15/" target="_top">Unicode Standard Annex #15:
        Unicode Normalization Forms</a></i> .</span> <span class="authorgroup"><span class=
        "firstname">Mark</span> <span class="surname">Davis</span> and <span class=
        "firstname">Martin</span> <span class="surname">D&uuml;rst</span>.</span> <span class=
        "date">26 March 2002.</span> <span class="biblioset"><i>Unicode Standard Annex</i>.
        <span class="volumenum">15.</span></span> <span class="publisher"><span class=
        "publishername">The Unicode Consortium.</span></span></p>
      </div>

      <div class="biblioentry">
        <a name="bib-USA28" id="bib-USA28"></a>

        <p>[<abbr class="abbrev">USA28</abbr>] <span class="title"><i><a href=
        "http://www.unicode.org/unicode/reports/tr28/tr28-3.html" target="_top">Unicode Standard
        Annex #28: Unicode 3.2</a></i> .</span> <span class="authorgroup"><span class=
        "corpauthor">The Unicode Consortium</span>.</span> <span class="date">27 March 2002.</span>
        <span class="biblioset"><i>Unicode Standard Annex</i>. <span class=
        "volumenum">28.</span></span> <span class="publisher"><span class="publishername">The
        Unicode Consortium.</span></span></p>
      </div>

      <div class="biblioentry">
        <a name="bib-XML10" id="bib-XML10"></a>

        <p>[<abbr class="abbrev">XML10</abbr>] <span class="title"><i><a href=
        "http://www.w3.org/TR/REC-xml" target="_top">Extensible Markup Language (XML) 1.0 (Second
        Edition)</a></i> .</span> <span class="authorgroup"><span class="corpauthor">World Wide Web
        Consortium</span>.</span> <span class="date">6 October 2000.</span> <span class=
        "biblioset"><i>W3C Recommendation</i>. <span class="volumenum">2e.</span></span>
        <span class="publisher"><span class="publishername">World Wide Web
        Consortium.</span></span></p>
      </div>

      <div class="biblioentry">
        <a name="bib-XSD2001-1" id="bib-XSD2001-1"></a>

        <p>[<abbr class="abbrev">XSD2001-1</abbr>] <span class="title"><i><a href=
        "http://www.w3.org/TR/xmlschema-1/" target="_top">XML Schema Part 1: Structures</a></i>
        .</span> <span class="authorgroup"><span class="firstname">Henry</span> <span class=
        "othername">S.</span> <span class="surname">Thompson</span>, <span class=
        "firstname">David</span> <span class="surname">Beech</span>, <span class=
        "firstname">Murray</span> <span class="surname">Maloney</span>, and <span class=
        "firstname">Noah</span> <span class="surname">Mendelsohn</span>.</span> <span class=
        "date">2 May 2001.</span> <span class="publisher"><span class=
        "publishername">W3C.</span></span></p>
      </div>

      <div class="biblioentry">
        <a name="bib-XSD2001-2" id="bib-XSD2001-2"></a>

        <p>[<abbr class="abbrev">XSD2001-2</abbr>] <span class="title"><i><a href=
        "http://www.w3.org/TR/xmlschema-2/" target="_top">XML Schema Part 2: Datatypes</a></i>
        .</span> <span class="authorgroup"><span class="firstname">Paul</span> <span class=
        "othername">V.</span> <span class="surname">Biron</span> and <span class=
        "firstname">Ashok</span> <span class="surname">Malhotra</span>.</span> <span class="date">2
        May 2001.</span> <span class="publisher"><span class="publishername">W3C.</span></span></p>
      </div>
    </div>
  </div>
</body>
</html>
